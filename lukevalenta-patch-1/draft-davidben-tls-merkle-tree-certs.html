<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Merkle Tree Certificates</title>
<meta content="David Benjamin" name="author">
<meta content="Devon O'Brien" name="author">
<meta content="Bas Westerbaan" name="author">
<meta content="Luke Valenta" name="author">
<meta content="Filippo Valsorda" name="author">
<meta content="
       This document describes Merkle Tree certificates, a new form of X.509 certificates which integrate public logging of the certificate, in the style of Certificate Transparency. The integrated design reduces logging overhead in the face of both shorter-lived certificates and large post-quantum signature algorithms, while still achieving comparable security properties to traditional X.509 and Certificate Transparency. Merkle Tree certificates additionally admit an optional signatureless optimization, which decreases the message size by avoiding signatures altogether, at the cost of only applying to up-to-date relying parties and older certificates. 
    " name="description">
<meta content="xml2rfc 3.30.1" name="generator">
<meta content="draft-davidben-tls-merkle-tree-certs-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.30.1
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.4.0
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.5
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-davidben-tls-merkle-tree-certs.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Merkle Tree Certificates</td>
<td class="right">September 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Benjamin, et al.</td>
<td class="center">Expires 21 March 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-davidben-tls-merkle-tree-certs-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-09-17" class="published">17 September 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-03-21">21 March 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Benjamin</div>
<div class="org">Google LLC</div>
</div>
<div class="author">
      <div class="author-name">D. O'Brien</div>
</div>
<div class="author">
      <div class="author-name">B. E. Westerbaan</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">L. Valenta</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">F. Valsorda</div>
<div class="org">Geomys</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Merkle Tree Certificates</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes Merkle Tree certificates, a new form of X.509 certificates which integrate public logging of the certificate, in the style of Certificate Transparency. The integrated design reduces logging overhead in the face of both shorter-lived certificates and large post-quantum signature algorithms, while still achieving comparable security properties to traditional X.509 and Certificate Transparency. Merkle Tree certificates additionally admit an optional signatureless optimization, which decreases the message size by avoiding signatures altogether, at the cost of only applying to up-to-date relying parties and older certificates.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://davidben.github.io/merkle-tree-certs/draft-davidben-tls-merkle-tree-certs.html">https://davidben.github.io/merkle-tree-certs/draft-davidben-tls-merkle-tree-certs.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-davidben-tls-merkle-tree-certs/">https://datatracker.ietf.org/doc/draft-davidben-tls-merkle-tree-certs/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/davidben/merkle-tree-certs">https://github.com/davidben/merkle-tree-certs</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 March 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-terminology-and-roles" class="internal xref">Terminology and Roles</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-subtrees" class="internal xref">Subtrees</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-definition-of-a-subtree" class="internal xref">Definition of a Subtree</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-subtree-inclusion-proofs" class="internal xref">Subtree Inclusion Proofs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-evaluating-a-subtree-inclus" class="internal xref">Evaluating a Subtree Inclusion Proof</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-verifying-a-subtree-inclusi" class="internal xref">Verifying a Subtree Inclusion Proof</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-subtree-consistency-proofs" class="internal xref">Subtree Consistency Proofs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-generating-a-subtree-consis" class="internal xref">Generating a Subtree Consistency Proof</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-verifying-a-subtree-consist" class="internal xref">Verifying a Subtree Consistency Proof</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-arbitrary-intervals" class="internal xref">Arbitrary Intervals</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-issuance-logs" class="internal xref">Issuance Logs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-log-parameters" class="internal xref">Log Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-log-ids" class="internal xref">Log IDs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-log-entries" class="internal xref">Log Entries</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-cosigners" class="internal xref">Cosigners</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="auto internal xref">5.4.1</a>.  <a href="#name-signature-format" class="internal xref">Signature Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.2">
                    <p id="section-toc.1-1.5.2.4.2.2.1"><a href="#section-5.4.2" class="auto internal xref">5.4.2</a>.  <a href="#name-signature-algorithms" class="internal xref">Signature Algorithms</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-certification-authority-cos" class="internal xref">Certification Authority Cosigners</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="auto internal xref">5.6</a>.  <a href="#name-publishing-logs" class="internal xref">Publishing Logs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.1">
                    <p id="section-toc.1-1.5.2.6.2.1.1"><a href="#section-5.6.1" class="auto internal xref">5.6.1</a>.  <a href="#name-log-pruning" class="internal xref">Log Pruning</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-certificates" class="internal xref">Certificates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-certificate-format" class="internal xref">Certificate Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-full-certificates" class="internal xref">Full Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-signatureless-certificates" class="internal xref">Signatureless Certificates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="auto internal xref">6.3.1</a>.  <a href="#name-landmarks" class="internal xref">Landmarks</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="auto internal xref">6.3.2</a>.  <a href="#name-allocating-landmarks" class="internal xref">Allocating Landmarks</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3.2.3">
                    <p id="section-toc.1-1.6.2.3.2.3.1"><a href="#section-6.3.3" class="auto internal xref">6.3.3</a>.  <a href="#name-constructing-signatureless-" class="internal xref">Constructing Signatureless Certificates</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-size-estimates" class="internal xref">Size Estimates</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-relying-parties" class="internal xref">Relying Parties</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-trust-anchors" class="internal xref">Trust Anchors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-verifying-certificate-signa" class="internal xref">Verifying Certificate Signatures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-trusted-cosigners" class="internal xref">Trusted Cosigners</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-trusted-subtrees" class="internal xref">Trusted Subtrees</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-revocation-by-index" class="internal xref">Revocation by Index</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-use-in-tls" class="internal xref">Use in TLS</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-acme-extensions" class="internal xref">ACME Extensions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-deployment-considerations" class="internal xref">Deployment Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-operational-costs" class="internal xref">Operational Costs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.1">
                    <p id="section-toc.1-1.10.2.1.2.1.1"><a href="#section-10.1.1" class="auto internal xref">10.1.1</a>.  <a href="#name-certification-authority-cost" class="internal xref">Certification Authority Costs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.2">
                    <p id="section-toc.1-1.10.2.1.2.2.1"><a href="#section-10.1.2" class="auto internal xref">10.1.2</a>.  <a href="#name-cosigner-costs" class="internal xref">Cosigner Costs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.3">
                    <p id="section-toc.1-1.10.2.1.2.3.1"><a href="#section-10.1.3" class="auto internal xref">10.1.3</a>.  <a href="#name-monitor-costs" class="internal xref">Monitor Costs</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-choosing-cosigners" class="internal xref">Choosing Cosigners</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-log-availability" class="internal xref">Log Availability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-certificate-renewal" class="internal xref">Certificate Renewal</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="auto internal xref">10.5</a>.  <a href="#name-multiple-ca-keys" class="internal xref">Multiple CA Keys</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-authenticity" class="internal xref">Authenticity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-transparency" class="internal xref">Transparency</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-public-key-hashes" class="internal xref">Public Key Hashes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#section-12.4" class="auto internal xref">12.4</a>.  <a href="#name-non-repudiation" class="internal xref">Non-Repudiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#section-12.5" class="auto internal xref">12.5</a>.  <a href="#name-new-log-entry-types" class="internal xref">New Log Entry Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#section-12.6" class="auto internal xref">12.6</a>.  <a href="#name-certificate-malleability" class="internal xref">Certificate Malleability</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-module-identifier" class="internal xref">Module Identifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-algorithm" class="internal xref">Algorithm</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="auto internal xref">13.3</a>.  <a href="#name-relative-distinguished-name" class="internal xref">Relative Distinguished Name Attribute</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="auto internal xref">14.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-asn1-module" class="internal xref">ASN.1 Module</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-extensions-to-tiled-transpa" class="internal xref">Extensions to Tiled Transparency Logs (To Be Removed)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-subtree-signed-note-format" class="internal xref">Subtree Signed Note Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-requesting-subtree-signatur" class="internal xref">Requesting Subtree Signatures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-change-log" class="internal xref">Change log</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#appendix-D.1" class="auto internal xref"></a><a href="#name-since-draft-davidben-tls-me" class="internal xref">Since draft-davidben-tls-merkle-tree-certs-00</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#appendix-D.2" class="auto internal xref"></a><a href="#name-since-draft-davidben-tls-mer" class="internal xref">Since draft-davidben-tls-merkle-tree-certs-01</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3">
                <p id="section-toc.1-1.18.2.3.1"><a href="#appendix-D.3" class="auto internal xref"></a><a href="#name-since-draft-davidben-tls-merk" class="internal xref">Since draft-davidben-tls-merkle-tree-certs-02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.4">
                <p id="section-toc.1-1.18.2.4.1"><a href="#appendix-D.4" class="auto internal xref"></a><a href="#name-since-draft-davidben-tls-merkl" class="internal xref">Since draft-davidben-tls-merkle-tree-certs-03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.5">
                <p id="section-toc.1-1.18.2.5.1"><a href="#appendix-D.5" class="auto internal xref"></a><a href="#name-since-draft-davidben-tls-merkle" class="internal xref">Since draft-davidben-tls-merkle-tree-certs-04</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.6">
                <p id="section-toc.1-1.18.2.6.1"><a href="#appendix-D.6" class="auto internal xref"></a><a href="#name-since-draft-davidben-tls-merkle-" class="internal xref">Since draft-davidben-tls-merkle-tree-certs-05</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.7">
                <p id="section-toc.1-1.18.2.7.1"><a href="#appendix-D.7" class="auto internal xref"></a><a href="#name-since-draft-davidben-tls-merkle-t" class="internal xref">Since draft-davidben-tls-merkle-tree-certs-06</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.8">
                <p id="section-toc.1-1.18.2.8.1"><a href="#appendix-D.8" class="auto internal xref"></a><a href="#name-since-draft-davidben-tls-merkle-tr" class="internal xref">Since draft-davidben-tls-merkle-tree-certs-07</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Authors' Note: This is an early draft of a proposal with many parts. We expect most details will change as the proposal evolves. This document has a concrete specification of these details, but this is only intended as a starting point, and to help convey the overall idea. The name of the draft says "tls" to keep continuity with earlier iterations of this work, but the protocol itself is not TLS-specific.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">In Public Key Infrastructures (PKIs) that use Certificate Transparency (CT) <span>[<a href="#RFC6962" class="cite xref">RFC6962</a>]</span> for a public logging requirement, an authenticating party must present Signed Certificate Timestamps (SCTs) alongside certificates. CT policies often require two or more SCTs per certificate <span>[<a href="#APPLE-CT" class="cite xref">APPLE-CT</a>]</span> <span>[<a href="#CHROME-CT" class="cite xref">CHROME-CT</a>]</span>, each of which carries a signature. These signatures are in addition to those in the certificate chain itself.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Current signature schemes can use as few as 32 bytes per key and 64 bytes per signature <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>, but post-quantum replacements are much larger. For example, ML-DSA-44 <span>[<a href="#FIPS204" class="cite xref">FIPS204</a>]</span> uses 1,312 bytes per public key and 2,420 bytes per signature. ML-DSA-65 uses 1,952 bytes per public key and 3,309 bytes per signature. Even with a directly-trusted intermediate (<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-trust-anchor-ids-02#section-7.5" class="relref">Section 7.5</a> of [<a href="#I-D.ietf-tls-trust-anchor-ids" class="cite xref">I-D.ietf-tls-trust-anchor-ids</a>]</span>), two SCTs and a leaf certificate signature adds 7,260 bytes of authentication overhead with ML-DSA-44 and 9,927 bytes with ML-DSA-65.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This increased overhead additionally impacts CT logs themselves. Most of a log's costs scale with the total storage size of the log. Each log entry contains both a public key, and a signature from the CA. With larger public keys and signatures, the size of each log entry will grow.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Additionally, as PKIs transition to shorter-lived certificates <span>[<a href="#CABF-153" class="cite xref">CABF-153</a>]</span> <span>[<a href="#CABF-SC081" class="cite xref">CABF-SC081</a>]</span>, the number of entries in the log will grow.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">This document introduces Merkle Tree certificates, a new form of X.509 certificate that integrates logging with certificate issuance. Each CA maintains a log of everything it issues, signing views of the log to assert it has issued the contents. The CA signature is combined with cosignatures from other parties who verify correct operation and optionally mirror the log. These signatures, together with an inclusion proof for an individual entry, constitute a certificate.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This achieves the following:<a href="#section-1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-8.1">
          <p id="section-1-8.1.1">Log entries do not scale with public key and signature sizes. Entries replace public keys with hashes and do not contain signatures, while preserving non-repudiability (<a href="#non-repudiation" class="auto internal xref">Section 12.4</a>).<a href="#section-1-8.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-8.2">
          <p id="section-1-8.2.1">To bound growth, long-expired entries can be pruned from logs and mirrors without interrupting existing clients. This allows log sizes to scale by retention policies, not the lifetime of the log, even as certificate lifetimes decrease.<a href="#section-1-8.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-8.3">
          <p id="section-1-8.3.1">After a processing delay, authenticating parties can obtain a second "signatureless" certificate for the same log entry. This second certificate is an optional size optimization that avoids the need for any signatures, assuming an up-to-date client that has some predistributed log information.<a href="#section-1-8.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-9"><a href="#overview" class="auto internal xref">Section 3</a> gives an overview of the system. <a href="#subtrees" class="auto internal xref">Section 4</a> describes a Merkle Tree primitive used by this system. <a href="#issuance-logs" class="auto internal xref">Section 5</a> describes the log structure. Finally, <a href="#certificates" class="auto internal xref">Section 6</a> and <a href="#relying-parties" class="auto internal xref">Section 7</a> describe how to construct and consume a Merkle Tree certificate.<a href="#section-1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document additionally uses the TLS presentation language defined in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-3" class="relref">Section 3</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3"><code>U+</code> followed by four hexadecimal characters denotes a Unicode codepoint, to be encoded in UTF-8 <span>[<a href="#RFC3629" class="cite xref">RFC3629</a>]</span>. <code>0x</code> followed by two hexadecimal characters denotes a byte value in the 0-255 range.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4"><code>[start, end)</code>, where <code>start &lt;= end</code>, denotes the half-open interval containing integers <code>x</code> such that <code>start &lt;= x &lt; end</code>.<a href="#section-2-4" class="pilcrow">¶</a></p>
<div id="terminology-and-roles">
<section id="section-2.1">
        <h3 id="name-terminology-and-roles">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-terminology-and-roles" class="section-name selfRef">Terminology and Roles</a>
        </h3>
<p id="section-2.1-1">This document discusses the following roles:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-2">
          <dt id="section-2.1-2.1">Authenticating party:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">The party that authenticates itself in the protocol. In TLS, this is the side sending the Certificate and CertificateVerify message.<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.3">Certification authority (CA):</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.4">
            <p id="section-2.1-2.4.1">The service that issues certificates to the authenticating party, after performing some validation process on the certificate contents.<a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.5">Relying party:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.6">
            <p id="section-2.1-2.6.1">The party to whom the authenticating party presents its identity. In TLS, this is the side receiving the Certificate and CertificateVerify message.<a href="#section-2.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.7">Monitor:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.8">
            <p id="section-2.1-2.8.1">Parties who watch logs for certificates of interest, analogous to the role in <span><a href="https://rfc-editor.org/rfc/rfc9162#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>.<a href="#section-2.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.9">Issuance log:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.10">
            <p id="section-2.1-2.10.1">A log, maintained by the CA, of everything issued by that CA.<a href="#section-2.1-2.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.11">Cosigner:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.12">
            <p id="section-2.1-2.12.1">A service that signs views of an issuance log, to assert correct operation and other properties about the entries.<a href="#section-2.1-2.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.1-3">Additionally, there are several terms used throughout this document to describe this proposal. This section provides an overview. They will be further defined and discussed in detail throughout the document.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-4">
          <dt id="section-2.1-4.1">Checkpoint:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.2">
            <p id="section-2.1-4.2.1">A description of the complete state of the log at some time.<a href="#section-2.1-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.3">Entry:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.4">
            <p id="section-2.1-4.4.1">An individual element of the log, describing information which the CA has validated and certified.<a href="#section-2.1-4.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.5">Subtree:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.6">
            <p id="section-2.1-4.6.1">A smaller Merkle Tree over a portion of the log, defined by an interior node of some snapshot of the log. Subtrees can be efficiently shown to be consistent with the whole log.<a href="#section-2.1-4.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.7">Inclusion proof:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.8">
            <p id="section-2.1-4.8.1">A sequence of hashes that efficiently proves some entry is contained in some checkpoint or subtree.<a href="#section-2.1-4.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.9">Consistency proof:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.10">
            <p id="section-2.1-4.10.1">A sequence of hashes that efficiently proves a checkpoint or subtree is contained within another checkpoint.<a href="#section-2.1-4.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.11">Cosignature:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.12">
            <p id="section-2.1-4.12.1">A signature from either the CA or other cosigner, over some checkpoint or subtree.<a href="#section-2.1-4.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.13">Landmark:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.14">
            <p id="section-2.1-4.14.1">One of an infrequent subset of tree sizes that can be used to predistribute trusted subtrees to relying parties for signatureless certificates.<a href="#section-2.1-4.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.15">Landmark subtree:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.16">
            <p id="section-2.1-4.16.1">A subtree determined by a landmark. Landmark subtrees are common points of reference between relying parties and signatureless certificates.<a href="#section-2.1-4.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.17">Full certificate:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.18">
            <p id="section-2.1-4.18.1">A certificate containing an inclusion proof to some subtree, and several cosignatures over that subtree.<a href="#section-2.1-4.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-4.19">Signatureless certificate:</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-4.20">
            <p id="section-2.1-4.20.1">An optimized certificate containing an inclusion proof to a landmark subtree, and no signatures.<a href="#section-2.1-4.20.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-3">
      <h2 id="name-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-3-1">In Certificate Transparency, a CA first certifies information by signing it, then submits the resulting certificate (or precertificate) to logs for logging. Merkle Tree Certificates inverts this process: the CA certifies information by logging it, then submits the log to cosigners to verify log operation. A certificate is assembled from the result and proves the information is in the CA's log.<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-a-diagram-of-the-issuance-a"></span><div id="fig-issuance-overview">
<figure id="figure-1">
        <div id="section-3-2.1">
          <div class="alignLeft art-svg artwork" id="section-3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="528" width="544" viewBox="0 0 544 528" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,272" fill="none" stroke="black"></path>
              <path d="M 8,352 L 8,480" fill="none" stroke="black"></path>
              <path d="M 24,480 L 24,512" fill="none" stroke="black"></path>
              <path d="M 72,80 L 72,112" fill="none" stroke="black"></path>
              <path d="M 128,280 L 128,320" fill="none" stroke="black"></path>
              <path d="M 256,32 L 256,272" fill="none" stroke="black"></path>
              <path d="M 256,352 L 256,480" fill="none" stroke="black"></path>
              <path d="M 272,384 L 272,512" fill="none" stroke="black"></path>
              <path d="M 296,32 L 296,272" fill="none" stroke="black"></path>
              <path d="M 296,352 L 296,464" fill="none" stroke="black"></path>
              <path d="M 536,32 L 536,272" fill="none" stroke="black"></path>
              <path d="M 536,352 L 536,464" fill="none" stroke="black"></path>
              <path d="M 8,32 L 24,32" fill="none" stroke="black"></path>
              <path d="M 216,32 L 256,32" fill="none" stroke="black"></path>
              <path d="M 296,32 L 312,32" fill="none" stroke="black"></path>
              <path d="M 504,32 L 536,32" fill="none" stroke="black"></path>
              <path d="M 224,64 L 312,64" fill="none" stroke="black"></path>
              <path d="M 72,160 L 96,160" fill="none" stroke="black"></path>
              <path d="M 224,176 L 312,176" fill="none" stroke="black"></path>
              <path d="M 40,224 L 104,224" fill="none" stroke="black"></path>
              <path d="M 8,272 L 256,272" fill="none" stroke="black"></path>
              <path d="M 296,272 L 536,272" fill="none" stroke="black"></path>
              <path d="M 8,352 L 24,352" fill="none" stroke="black"></path>
              <path d="M 240,352 L 256,352" fill="none" stroke="black"></path>
              <path d="M 296,352 L 312,352" fill="none" stroke="black"></path>
              <path d="M 400,352 L 536,352" fill="none" stroke="black"></path>
              <path d="M 72,384 L 96,384" fill="none" stroke="black"></path>
              <path d="M 256,384 L 272,384" fill="none" stroke="black"></path>
              <path d="M 240,432 L 312,432" fill="none" stroke="black"></path>
              <path d="M 40,448 L 104,448" fill="none" stroke="black"></path>
              <path d="M 296,464 L 536,464" fill="none" stroke="black"></path>
              <path d="M 8,480 L 256,480" fill="none" stroke="black"></path>
              <path d="M 24,512 L 272,512" fill="none" stroke="black"></path>
              <path d="M 72,384 L 104,448" fill="none" stroke="black"></path>
              <path d="M 72,160 L 104,224" fill="none" stroke="black"></path>
              <path d="M 156,280 L 176,320" fill="none" stroke="black"></path>
              <path d="M 40,224 L 72,160" fill="none" stroke="black"></path>
              <path d="M 80,320 L 100,280" fill="none" stroke="black"></path>
              <path d="M 40,448 L 72,384" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="320,176 308,170.4 308,181.6" fill="black" transform="rotate(0,312,176)"></polygon>
              <polygon class="arrowhead" points="248,432 236,426.4 236,437.6" fill="black" transform="rotate(180,240,432)"></polygon>
              <polygon class="arrowhead" points="232,64 220,58.4 220,69.6" fill="black" transform="rotate(180,224,64)"></polygon>
              <polygon class="arrowhead" points="184,320 172,314.4 172,325.6" fill="black" transform="rotate(63.43494882292201,176,320)"></polygon>
              <polygon class="arrowhead" points="136,320 124,314.4 124,325.6" fill="black" transform="rotate(90,128,320)"></polygon>
              <polygon class="arrowhead" points="88,320 76,314.4 76,325.6" fill="black" transform="rotate(116.56505117707799,80,320)"></polygon>
              <polygon class="arrowhead" points="80,112 68,106.4 68,117.6" fill="black" transform="rotate(90,72,112)"></polygon>
              <circle cx="48" cy="240" r="6" class="closeddot" fill="black"></circle>
              <circle cx="48" cy="464" r="6" class="closeddot" fill="black"></circle>
              <circle cx="64" cy="240" r="6" class="closeddot" fill="black"></circle>
              <circle cx="64" cy="464" r="6" class="closeddot" fill="black"></circle>
              <circle cx="80" cy="240" r="6" class="closeddot" fill="black"></circle>
              <circle cx="80" cy="464" r="6" class="closeddot" fill="black"></circle>
              <circle cx="96" cy="240" r="6" class="closeddot" fill="black"></circle>
              <circle cx="96" cy="464" r="6" class="closeddot" fill="black"></circle>
              <circle cx="384" cy="208" r="6" class="closeddot" fill="black"></circle>
              <g class="text">
                <text x="80" y="36">Certificate</text>
                <text x="168" y="36">Authority</text>
                <text x="388" y="36">Authenticating</text>
                <text x="472" y="36">Party</text>
                <text x="36" y="68">2.</text>
                <text x="84" y="68">Validate</text>
                <text x="152" y="68">request</text>
                <text x="340" y="68">1.</text>
                <text x="384" y="68">Request</text>
                <text x="464" y="68">certificate</text>
                <text x="36" y="148">3.</text>
                <text x="64" y="148">Add</text>
                <text x="92" y="148">to</text>
                <text x="140" y="148">issuance</text>
                <text x="192" y="148">log</text>
                <text x="104" y="164">[</text>
                <text x="124" y="164">CA</text>
                <text x="164" y="164">cosign</text>
                <text x="200" y="164">]</text>
                <text x="340" y="180">5.</text>
                <text x="388" y="180">Download</text>
                <text x="476" y="180">certificates</text>
                <text x="432" y="212">tbscert</text>
                <text x="352" y="228">=</text>
                <text x="368" y="228">=</text>
                <text x="384" y="228">=</text>
                <text x="440" y="228">inclusion</text>
                <text x="504" y="228">proof</text>
                <text x="144" y="244">tbscert</text>
                <text x="208" y="244">entries</text>
                <text x="344" y="244">[</text>
                <text x="364" y="244">CA</text>
                <text x="384" y="244">]</text>
                <text x="452" y="244">cosignatures</text>
                <text x="312" y="260">[</text>
                <text x="348" y="260">mirror</text>
                <text x="384" y="260">]</text>
                <text x="212" y="308">4.</text>
                <text x="252" y="308">Submit</text>
                <text x="296" y="308">log</text>
                <text x="324" y="308">to</text>
                <text x="376" y="308">cosigners</text>
                <text x="240" y="324">for</text>
                <text x="308" y="324">cosignatures</text>
                <text x="68" y="356">Mirrors,</text>
                <text x="128" y="356">other</text>
                <text x="192" y="356">cosigners</text>
                <text x="356" y="356">Monitors</text>
                <text x="104" y="388">[</text>
                <text x="124" y="388">CA</text>
                <text x="164" y="388">cosign</text>
                <text x="200" y="388">]</text>
                <text x="104" y="404">[</text>
                <text x="140" y="404">mirror</text>
                <text x="196" y="404">cosign</text>
                <text x="232" y="404">]</text>
                <text x="340" y="436">6.</text>
                <text x="384" y="436">Monitor</text>
                <text x="428" y="436">CA</text>
                <text x="480" y="436">operation</text>
                <text x="80" y="500">...quorum</text>
                <text x="132" y="500">of</text>
                <text x="196" y="500">cosigners...</text>
              </g>
            </svg><a href="#section-3-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-a-diagram-of-the-issuance-a" class="selfRef">A diagram of the issuance architecture, detailed below</a>
        </figcaption></figure>
</div>
<p id="section-3-3">Merkle Tree Certificates are issued as follows. <a href="#fig-issuance-overview" class="auto internal xref">Figure 1</a> depicts this process.<a href="#section-3-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3-4">
<li id="section-3-4.1">
          <p id="section-3-4.1.1">The authenticating party requests a certificate, e.g. over ACME <span>[<a href="#RFC8555" class="cite xref">RFC8555</a>]</span><a href="#section-3-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-4.2">
          <p id="section-3-4.2.1">The CA validates each incoming issuance request, e.g. with ACME challenges. From there, the process differs.<a href="#section-3-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-4.3">
          <p id="section-3-4.3.1">The CA operates an append-only <em>issuance log</em> (<a href="#issuance-logs" class="auto internal xref">Section 5</a>). Unlike a CT log, this log only contains entries added by the CA:<a href="#section-3-4.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3-4.3.2">
<li id="section-3-4.3.2.1">
              <p id="section-3-4.3.2.1.1">The CA adds a TBSCertificateLogEntry (<a href="#log-entries" class="auto internal xref">Section 5.3</a>) to its log, describing the information it is certifying.<a href="#section-3-4.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3-4.3.2.2">
              <p id="section-3-4.3.2.2.1">The CA signs a <em>checkpoint</em>, which describes the current state of the log. A signed checkpoint certifies that the CA issued <em>every</em> entry in the Merkle Tree (<a href="#certification-authority-cosigners" class="auto internal xref">Section 5.5</a>).<a href="#section-3-4.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3-4.3.2.3">
              <p id="section-3-4.3.2.3.1">The CA additionally signs <em>subtrees</em> (<a href="#subtrees" class="auto internal xref">Section 4</a>) that together contain certificates added since the last checkpoint (<a href="#arbitrary-intervals" class="auto internal xref">Section 4.4</a>). This is an optimization to reduce inclusion proof sizes. A signed subtree certifies that the CA has issued <em>every</em> entry in the subtree.<a href="#section-3-4.3.2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</li>
        <li id="section-3-4.4">
          <p id="section-3-4.4.1">The CA submits the new log state to <em>cosigners</em>. Cosigners validate the log is append-only and optionally provide additional services, such as mirroring its contents. They cosign the CA's checkpoints and subtrees.<a href="#section-3-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-4.5">
          <p id="section-3-4.5.1">The CA now has enough information to construct a certificate and give it to the authenticating party. A certificate contains:<a href="#section-3-4.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-4.5.2.1">
              <p id="section-3-4.5.2.1.1">The TBSCertificate being certified<a href="#section-3-4.5.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-4.5.2.2">
              <p id="section-3-4.5.2.2.1">An inclusion proof from the TBSCertificate to some subtree<a href="#section-3-4.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-4.5.2.3">
              <p id="section-3-4.5.2.3.1">Cosignatures from the CA and cosigners on the subtree<a href="#section-3-4.5.2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li id="section-3-4.6">
          <p id="section-3-4.6.1">As in Certificate Transparency, monitors observe the issuance log to ensure the CA is operated correctly.<a href="#section-3-4.6.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-3-5">A certificate with cosignatures is known as a <em>full certificate</em>. Analogous to X.509 trust anchors and trusted CT logs, relying parties are configured with trusted cosigners (<a href="#trusted-cosigners" class="auto internal xref">Section 7.3</a>) that allow them to accept Merkle Tree certificates. The inclusion proof proves the TBSCertificate is part of some subtree, and cosignatures from trusted cosigners prove the subtree was certified by the CA and available to monitors. Where CT logs entire certificates, the issuance log's entries are smaller TBSCertificateLogEntry (<a href="#log-entries" class="auto internal xref">Section 5.3</a>) structures, which do not scale with public key or signature size.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">This same issuance process also produces a <em>signatureless certificate</em>. This is an optional, optimized certificate that avoids all cosignatures, including the CA signature. Signatureless certificates are available after a short period of time and usable with up-to-date relying parties.<a href="#section-3-6" class="pilcrow">¶</a></p>
<span id="name-a-diagram-of-signatureless-"></span><div id="fig-signatureless-overview">
<figure id="figure-2">
        <div id="section-3-7.1">
          <div class="alignLeft art-svg artwork" id="section-3-7.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="416" width="488" viewBox="0 0 488 416" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,112" fill="none" stroke="black"></path>
              <path d="M 8,192 L 8,384" fill="none" stroke="black"></path>
              <path d="M 224,96 L 224,184" fill="none" stroke="black"></path>
              <path d="M 272,32 L 272,112" fill="none" stroke="black"></path>
              <path d="M 272,192 L 272,384" fill="none" stroke="black"></path>
              <path d="M 296,48 L 296,112" fill="none" stroke="black"></path>
              <path d="M 296,240 L 296,288" fill="none" stroke="black"></path>
              <path d="M 296,320 L 296,368" fill="none" stroke="black"></path>
              <path d="M 432,80 L 432,224" fill="none" stroke="black"></path>
              <path d="M 464,48 L 464,112" fill="none" stroke="black"></path>
              <path d="M 480,240 L 480,288" fill="none" stroke="black"></path>
              <path d="M 480,320 L 480,368" fill="none" stroke="black"></path>
              <path d="M 8,32 L 24,32" fill="none" stroke="black"></path>
              <path d="M 216,32 L 272,32" fill="none" stroke="black"></path>
              <path d="M 296,48 L 312,48" fill="none" stroke="black"></path>
              <path d="M 448,48 L 464,48" fill="none" stroke="black"></path>
              <path d="M 264,80 L 432,80" fill="none" stroke="black"></path>
              <path d="M 32,96 L 72,96" fill="none" stroke="black"></path>
              <path d="M 8,112 L 272,112" fill="none" stroke="black"></path>
              <path d="M 296,112 L 464,112" fill="none" stroke="black"></path>
              <path d="M 8,192 L 24,192" fill="none" stroke="black"></path>
              <path d="M 208,192 L 272,192" fill="none" stroke="black"></path>
              <path d="M 296,240 L 312,240" fill="none" stroke="black"></path>
              <path d="M 440,240 L 480,240" fill="none" stroke="black"></path>
              <path d="M 264,256 L 288,256" fill="none" stroke="black"></path>
              <path d="M 296,288 L 480,288" fill="none" stroke="black"></path>
              <path d="M 296,320 L 312,320" fill="none" stroke="black"></path>
              <path d="M 432,320 L 480,320" fill="none" stroke="black"></path>
              <path d="M 176,352 L 288,352" fill="none" stroke="black"></path>
              <path d="M 296,368 L 480,368" fill="none" stroke="black"></path>
              <path d="M 8,384 L 272,384" fill="none" stroke="black"></path>
              <path d="M 52,56 L 72,96" fill="none" stroke="black"></path>
              <path d="M 32,96 L 52,56" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="440,224 428,218.4 428,229.6" fill="black" transform="rotate(90,432,224)"></polygon>
              <polygon class="arrowhead" points="296,352 284,346.4 284,357.6" fill="black" transform="rotate(0,288,352)"></polygon>
              <polygon class="arrowhead" points="296,256 284,250.4 284,261.6" fill="black" transform="rotate(0,288,256)"></polygon>
              <polygon class="arrowhead" points="232,184 220,178.4 220,189.6" fill="black" transform="rotate(90,224,184)"></polygon>
              <g class="text">
                <text x="80" y="36">Certificate</text>
                <text x="168" y="36">Authority</text>
                <text x="348" y="52">Update</text>
                <text x="408" y="52">Channel</text>
                <text x="92" y="84">1.</text>
                <text x="140" y="84">Allocate</text>
                <text x="216" y="84">landmarks</text>
                <text x="44" y="148">2.</text>
                <text x="76" y="148">Make</text>
                <text x="152" y="148">signatureless</text>
                <text x="316" y="148">3.</text>
                <text x="372" y="148">Distribute</text>
                <text x="76" y="164">cert</text>
                <text x="116" y="164">from</text>
                <text x="172" y="164">landmark</text>
                <text x="376" y="164">landmarks</text>
                <text x="92" y="196">Authenticating</text>
                <text x="176" y="196">Party</text>
                <text x="72" y="228">signatureless</text>
                <text x="148" y="228">cert</text>
                <text x="64" y="244">tbscert</text>
                <text x="364" y="244">Up-to-date</text>
                <text x="420" y="244">RP</text>
                <text x="72" y="260">inclusion</text>
                <text x="136" y="260">proof</text>
                <text x="172" y="260">to</text>
                <text x="220" y="260">landmark</text>
                <text x="340" y="260">landmark</text>
                <text x="404" y="260">hashes</text>
                <text x="336" y="276">trusted</text>
                <text x="408" y="276">cosigners</text>
                <text x="36" y="308">full</text>
                <text x="76" y="308">cert</text>
                <text x="64" y="324">tbscert</text>
                <text x="360" y="324">Unupdated</text>
                <text x="412" y="324">RP</text>
                <text x="72" y="340">inclusion</text>
                <text x="136" y="340">proof</text>
                <text x="332" y="340">(stale</text>
                <text x="372" y="340">or</text>
                <text x="396" y="340">no</text>
                <text x="440" y="340">hashes)</text>
                <text x="84" y="356">cosignatures</text>
                <text x="336" y="356">trusted</text>
                <text x="408" y="356">cosigners</text>
                <text x="180" y="404">4.</text>
                <text x="220" y="404">Select</text>
                <text x="296" y="404">certificate</text>
                <text x="356" y="404">by</text>
                <text x="380" y="404">RP</text>
              </g>
            </svg><a href="#section-3-7.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-a-diagram-of-signatureless-" class="selfRef">A diagram of signatureless certificate construction and usage, detailed below</a>
        </figcaption></figure>
</div>
<p id="section-3-8">Signatureless certificates are constructed and used as follows. <a href="#fig-signatureless-overview" class="auto internal xref">Figure 2</a> depicts this process.<a href="#section-3-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3-9">
<li id="section-3-9.1">
          <p id="section-3-9.1.1">Periodically, the tree size of the CA's most recent checkpoint is designated as a <em>landmark</em>. This determines <em>landmark subtrees</em>, which are common points of reference between relying parties and signatureless certificates.<a href="#section-3-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-9.2">
          <p id="section-3-9.2.1">Once some landmark includes the TBSCertificate, the signatureless certificate is constructed with:<a href="#section-3-9.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-9.2.2.1">
              <p id="section-3-9.2.2.1.1">The TBSCertificate being certified<a href="#section-3-9.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-9.2.2.2">
              <p id="section-3-9.2.2.2.1">An inclusion proof from the TBSCertificate to a landmark subtree<a href="#section-3-9.2.2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li id="section-3-9.3">
          <p id="section-3-9.3.1">In the background, landmark subtrees are predistributed to relying parties, with cosignatures checked against relying party requirements. This occurs periodically in the background, separate from the application protocol.<a href="#section-3-9.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-9.4">
          <p id="section-3-9.4.1">During the application protocol, such as TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>, if the relying party already supports the landmark subtree, the authenticating party can present the signatureless certificate. Otherwise, it presents a full certificate. The authenticating party may also select between several signatureless certificates, as described in <a href="#certificate-renewal" class="auto internal xref">Section 10.4</a>.<a href="#section-3-9.4.1" class="pilcrow">¶</a></p>
</li>
      </ol>
</section>
</div>
<div id="subtrees">
<section id="section-4">
      <h2 id="name-subtrees">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-subtrees" class="section-name selfRef">Subtrees</a>
      </h2>
<p id="section-4-1">This section extends the Merkle Tree definition in <span><a href="https://rfc-editor.org/rfc/rfc9162#section-2.1" class="relref">Section 2.1</a> of [<a href="#RFC9162" class="cite xref">RFC9162</a>]</span> by defining a <em>subtree</em> of a Merkle Tree. A subtree is an interior node of a Merkle Tree, which can be efficiently shown consistent with the original Merkle Tree and any Merkle Tree with additional elements appended. This specification uses subtrees to reduce the size of inclusion proofs.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="definition-of-a-subtree">
<section id="section-4.1">
        <h3 id="name-definition-of-a-subtree">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-definition-of-a-subtree" class="section-name selfRef">Definition of a Subtree</a>
        </h3>
<p id="section-4.1-1">Given an ordered list of <code>n</code> inputs, <code>D_n = {d[0], d[1], ..., d[n-1]}</code>, <span><a href="https://rfc-editor.org/rfc/rfc9162#section-2.1.1" class="relref">Section 2.1.1</a> of [<a href="#RFC9162" class="cite xref">RFC9162</a>]</span> defines the Merkle Tree via the Merkle Tree Hash <code>MTH(D_n)</code>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">A <em>subtree</em> of this Merkle Tree is defined by two integers, <code>start</code> and <code>end</code>, such that:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-3.1">
            <p id="section-4.1-3.1.1"><code>0 &lt;= start &lt; end &lt;= n</code><a href="#section-4.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.1-3.2">
            <p id="section-4.1-3.2.1">If <code>s</code> is the smallest power of two that is greater than or equal to <code>end - start</code>, <code>start</code> must be a multiple of <code>s</code><a href="#section-4.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-4">Note that, if <code>start</code> is zero, the second condition is always true.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">A subtree is itself a Merkle Tree, defined by <code>MTH(D[start:end])</code>. In the context of a single Merkle Tree, the subtree defined by <code>start</code> and <code>end</code> is denoted by half-open interval <code>[start, end)</code>. It contains the entries whose indices are in that half-open interval.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">The <em>size</em> of the subtree is <code>end - start</code>. If the subtree's size is a power of two, it is said to be <em>full</em>, otherwise it is said to be <em>partial</em>.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">If a subtree is full, then it is directly contained in the tree of hash operations in <code>MTH(D_n)</code> for <code>n &gt;= end</code>.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">If a subtree is partial, it is directly contained in <code>MTH(D_n)</code> only if <code>n = end</code>.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subtree-inclusion-proofs">
<section id="section-4.2">
        <h3 id="name-subtree-inclusion-proofs">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-subtree-inclusion-proofs" class="section-name selfRef">Subtree Inclusion Proofs</a>
        </h3>
<p id="section-4.2-1">Subtrees are Merkle Trees, so entries can be proven to be contained in the subtree. A subtree inclusion proof for entry <code>index</code> of the subtree <code>[start, end)</code> is a Merkle inclusion proof, as defined in <span><a href="https://rfc-editor.org/rfc/rfc9162#section-2.1.3.1" class="relref">Section 2.1.3.1</a> of [<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>, where <code>m</code> is <code>index - start</code> and the tree inputs are <code>D[start:end]</code>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="evaluating-a-subtree-inclusion-proof">
<section id="section-4.2.1">
          <h4 id="name-evaluating-a-subtree-inclus">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-evaluating-a-subtree-inclus" class="section-name selfRef">Evaluating a Subtree Inclusion Proof</a>
          </h4>
<p id="section-4.2.1-1">Given a subtree inclusion proof, <code>inclusion_proof</code>, for entry <code>index</code>, with hash <code>entry_hash</code>, of a subtree <code>[start, end)</code>, the subtree inclusion proof can be <em>evaluated</em> to compute the expected subtree hash:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.1-2">
<li id="section-4.2.1-2.1">
              <p id="section-4.2.1-2.1.1">Check that <code>[start, end)</code> is a valid subtree (<a href="#definition-of-a-subtree" class="auto internal xref">Section 4.1</a>), and that <code>start &lt;= index &lt; end</code>. If either do not hold, fail proof evaluation.<a href="#section-4.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.1-2.2">
              <p id="section-4.2.1-2.2.1">Set <code>fn</code> to <code>index - start</code> and <code>sn</code> to <code>end - start - 1</code>.<a href="#section-4.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.1-2.3">
              <p id="section-4.2.1-2.3.1">Set <code>r</code> to <code>entry_hash</code>.<a href="#section-4.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.1-2.4">
              <p id="section-4.2.1-2.4.1">For each value <code>p</code> in the <code>inclusion_proof</code> array:<a href="#section-4.2.1-2.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.1-2.4.2">
<li id="section-4.2.1-2.4.2.1">
                  <p id="section-4.2.1-2.4.2.1.1">If <code>sn</code> is 0, then stop the iteration and fail the proof verification.<a href="#section-4.2.1-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-4.2.1-2.4.2.2">
                  <p id="section-4.2.1-2.4.2.2.1">If <code>LSB(fn)</code> is set, or if <code>fn</code> is equal to <code>sn</code>, then:<a href="#section-4.2.1-2.4.2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.1-2.4.2.2.2">
<li id="section-4.2.1-2.4.2.2.2.1">
                      <p id="section-4.2.1-2.4.2.2.2.1.1">Set <code>r</code> to <code>HASH(0x01 || p || r)</code>.<a href="#section-4.2.1-2.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-4.2.1-2.4.2.2.2.2">
                      <p id="section-4.2.1-2.4.2.2.2.2.1">Until <code>LSB(fn)</code> is set, right-shift <code>fn</code> and <code>sn</code> equally.<a href="#section-4.2.1-2.4.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ol>
<p id="section-4.2.1-2.4.2.2.3">
Otherwise:<a href="#section-4.2.1-2.4.2.2.3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.1-2.4.2.2.4">
<li id="section-4.2.1-2.4.2.2.4.1">
                      <p id="section-4.2.1-2.4.2.2.4.1.1">Set <code>r</code> to <code>HASH(0x01 || r || p)</code>.<a href="#section-4.2.1-2.4.2.2.4.1.1" class="pilcrow">¶</a></p>
</li>
                  </ol>
</li>
                <li id="section-4.2.1-2.4.2.3">
                  <p id="section-4.2.1-2.4.2.3.1">Finally, right-shift both <code>fn</code> and <code>sn</code> one time.<a href="#section-4.2.1-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-4.2.1-2.5">
              <p id="section-4.2.1-2.5.1">If <code>sn</code> is not zero, fail proof evaluation.<a href="#section-4.2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.1-2.6">
              <p id="section-4.2.1-2.6.1">Return <code>r</code> as the expected subtree hash.<a href="#section-4.2.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-4.2.1-3">This is the same as the procedure in <span><a href="https://rfc-editor.org/rfc/rfc9162#section-2.1.3.2" class="relref">Section 2.1.3.2</a> of [<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>, where <code>leaf_index</code> is <code>index - start</code>, <code>tree_size</code> is <code>end - start</code>, and <code>r</code> is returned instead of compared with <code>root_hash</code>.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verifying-a-subtree-inclusion-proof">
<section id="section-4.2.2">
          <h4 id="name-verifying-a-subtree-inclusi">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-verifying-a-subtree-inclusi" class="section-name selfRef">Verifying a Subtree Inclusion Proof</a>
          </h4>
<p id="section-4.2.2-1">Given a subtree inclusion proof, <code>inclusion_proof</code>, for entry <code>index</code>, with hash <code>entry_hash</code>, of a subtree <code>[start, end)</code> with hash <code>subtree_hash</code>, the subtree inclusion proof can be <em>verified</em> to verify the described entry is contained in the subtree:<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.2-2">
<li id="section-4.2.2-2.1">
              <p id="section-4.2.2-2.1.1">Let <code>expected_subtree_hash</code> be the result of evaluating the inclusion proof as described <a href="#evaluating-a-subtree-inclusion-proof" class="auto internal xref">Section 4.2.1</a>. If evaluation fails, fail the proof verification.<a href="#section-4.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.2-2.2">
              <p id="section-4.2.2-2.2.1">If <code>subtree_hash</code> is equal to <code>expected_subtree_hash</code>, the entry is contained in the subtree. Otherwise, fail the proof verification.<a href="#section-4.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="subtree-consistency-proofs">
<section id="section-4.3">
        <h3 id="name-subtree-consistency-proofs">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-subtree-consistency-proofs" class="section-name selfRef">Subtree Consistency Proofs</a>
        </h3>
<p id="section-4.3-1">A subtree <code>[start, end)</code> can be efficiently proven to be consistent with the full Merkle Tree. That is, given <code>MTH(D[start:end])</code> and <code>MTH(D_n)</code>, the proof demonstrates that the input <code>D[start:end]</code> to the subtree hash was equal to the corresponding elements of the input <code>D_n</code> to the Merkle Tree hash.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div id="generating-a-subtree-consistency-proof">
<section id="section-4.3.1">
          <h4 id="name-generating-a-subtree-consis">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-generating-a-subtree-consis" class="section-name selfRef">Generating a Subtree Consistency Proof</a>
          </h4>
<p id="section-4.3.1-1">The subtree consistency proof, <code>SUBTREE_PROOF(start, end, D_n)</code> is defined similarly to <span><a href="https://rfc-editor.org/rfc/rfc9162#section-2.1.4.1" class="relref">Section 2.1.4.1</a> of [<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>, in terms of a helper function that tracks whether the subtree hash is known:<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.3.1-2">
<pre>
SUBTREE_PROOF(start, end, D_n) =
    SUBTREE_SUBPROOF(start, end, D_n, true)
</pre><a href="#section-4.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-3">If <code>start = 0</code> and <code>end = n</code>, the subtree is the root:<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.3.1-4">
<pre>
SUBTREE_SUBPROOF(0, n, D_n, true) = {}
SUBTREE_SUBPROOF(0, n, D_n, false) = {MTH(D_n)}
</pre><a href="#section-4.3.1-4" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-5">Otherwise, <code>n &gt; 1</code>. Let <code>k</code> be the largest power of two smaller than <code>n</code>. The consistency proof is defined recursively as:<a href="#section-4.3.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3.1-6.1">
              <p id="section-4.3.1-6.1.1">If <code>end &lt;= k</code>, the subtree is on the left of <code>k</code>. The proof proves consistency with the left child and includes the right child:<a href="#section-4.3.1-6.1.1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.3.1-6.1.2">
<pre>
SUBTREE_SUBPROOF(start, end, D_n, b) =
    SUBTREE_SUBPROOF(start, end, D[0:k], b) : MTH(D[k:n])
</pre><a href="#section-4.3.1-6.1.2" class="pilcrow">¶</a>
</div>
</li>
            <li class="normal" id="section-4.3.1-6.2">
              <p id="section-4.3.1-6.2.1">If <code>k &lt;= start</code>, the subtree is on the right of <code>k</code>. The proof proves consistency with the right child and includes the left child.<a href="#section-4.3.1-6.2.1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.3.1-6.2.2">
<pre>
SUBTREE_SUBPROOF(start, end, D_n, b) =
    SUBTREE_SUBPROOF(start - k, end - k, D[k:n], b) : MTH(D[0:k])
</pre><a href="#section-4.3.1-6.2.2" class="pilcrow">¶</a>
</div>
</li>
            <li class="normal" id="section-4.3.1-6.3">
              <p id="section-4.3.1-6.3.1">Otherwise, <code>start &lt; k &lt; end</code>, which implies <code>start = 0</code>. The proof proves consistency with the right child and includes the left child.<a href="#section-4.3.1-6.3.1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.3.1-6.3.2">
<pre>
SUBTREE_SUBPROOF(0, end, D_n, b) =
    SUBTREE_SUBPROOF(0, end - k, D[k:n], false) : MTH(D[0:k])
</pre><a href="#section-4.3.1-6.3.2" class="pilcrow">¶</a>
</div>
</li>
          </ul>
<p id="section-4.3.1-7">When <code>start</code> is zero, this computes a Merkle consistency proof:<a href="#section-4.3.1-7" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.3.1-8">
<pre>
SUBTREE_PROOF(0, end, D_n) = PROOF(end, D_n)
</pre><a href="#section-4.3.1-8" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-9">When <code>end = start + 1</code>, this computes a Merkle inclusion proof:<a href="#section-4.3.1-9" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-4.3.1-10">
<pre>
SUBTREE_PROOF(start, start + 1, D_n) = PATH(start, D_n)
</pre><a href="#section-4.3.1-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="verifying-a-subtree-consistency-proof">
<section id="section-4.3.2">
          <h4 id="name-verifying-a-subtree-consist">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-verifying-a-subtree-consist" class="section-name selfRef">Verifying a Subtree Consistency Proof</a>
          </h4>
<p id="section-4.3.2-1">The following procedure can be used to verify a subtree consistency proof.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2-2">Given a Merkle Tree over <code>n</code> elements, a subtree defined by <code>[start, end)</code>, a consistency proof <code>proof</code>, a subtree hash <code>node_hash</code>, and a root hash <code>root_hash</code>:<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2-3">
<li id="section-4.3.2-3.1">
              <p id="section-4.3.2-3.1.1">If <code>end</code> is <code>n</code>, run the following:<a href="#section-4.3.2-3.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2-3.1.2">
<li id="section-4.3.2-3.1.2.1">
                  <p id="section-4.3.2-3.1.2.1.1">Set <code>fn</code> to <code>start</code> and <code>sn</code> to <code>end - 1</code>.<a href="#section-4.3.2-3.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-4.3.2-3.1.2.2">
                  <p id="section-4.3.2-3.1.2.2.1">Set <code>r</code> to <code>node_hash</code>.<a href="#section-4.3.2-3.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-4.3.2-3.1.2.3">
                  <p id="section-4.3.2-3.1.2.3.1">Until <code>LSB(fn)</code> is set or <code>sn</code> is <code>0</code>, right-shift <code>fn</code> and <code>sn</code> equally.<a href="#section-4.3.2-3.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-4.3.2-3.1.2.4">
                  <p id="section-4.3.2-3.1.2.4.1">For each value <code>p</code> in the <code>proof</code> array:<a href="#section-4.3.2-3.1.2.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2-3.1.2.4.2">
<li id="section-4.3.2-3.1.2.4.2.1">
                      <p id="section-4.3.2-3.1.2.4.2.1.1">If <code>sn</code> is <code>0</code>, then stop iteration and fail the proof verification.<a href="#section-4.3.2-3.1.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-4.3.2-3.1.2.4.2.2">
                      <p id="section-4.3.2-3.1.2.4.2.2.1">Set <code>r</code> to <code>HASH(0x01 || p || r)</code>.<a href="#section-4.3.2-3.1.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-4.3.2-3.1.2.4.2.3">
                      <p id="section-4.3.2-3.1.2.4.2.3.1">Until <code>LSB(sn)</code> is set, right-shift <code>sn</code>.<a href="#section-4.3.2-3.1.2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-4.3.2-3.1.2.4.2.4">
                      <p id="section-4.3.2-3.1.2.4.2.4.1">Right-shift <code>sn</code> once more.<a href="#section-4.3.2-3.1.2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
                  </ol>
</li>
                <li id="section-4.3.2-3.1.2.5">
                  <p id="section-4.3.2-3.1.2.5.1">Compare <code>sn</code> to <code>0</code> and <code>r</code> to <code>root_hash</code>. If either is not equal, fail the proof verification. If all are equal, accept the proof.<a href="#section-4.3.2-3.1.2.5.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-4.3.2-3.2">
              <p id="section-4.3.2-3.2.1">Otherwise, run the following:<a href="#section-4.3.2-3.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2-3.2.2">
<li id="section-4.3.2-3.2.2.1">
                  <p id="section-4.3.2-3.2.2.1.1">If <code>proof</code> is an empty array, stop and fail verification.<a href="#section-4.3.2-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-4.3.2-3.2.2.2">
                  <p id="section-4.3.2-3.2.2.2.1">If <code>end - start</code> is an exact power of two, prepend <code>node_hash</code> to the <code>proof</code> array.<a href="#section-4.3.2-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-4.3.2-3.2.2.3">
                  <p id="section-4.3.2-3.2.2.3.1">Set <code>fn</code> to <code>start</code>, <code>sn</code> to <code>end - 1</code>, and <code>tn</code> to <code>n - 1</code>.<a href="#section-4.3.2-3.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-4.3.2-3.2.2.4">
                  <p id="section-4.3.2-3.2.2.4.1">Until <code>LSB(sn)</code> is not set or <code>fn</code> is equal to <code>sn</code>, right-shift <code>fn</code>, <code>sn</code>, and <code>tn</code> equally.<a href="#section-4.3.2-3.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-4.3.2-3.2.2.5">
                  <p id="section-4.3.2-3.2.2.5.1">Set both <code>fr</code> and <code>sr</code> to the first value in the <code>proof</code> array.<a href="#section-4.3.2-3.2.2.5.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-4.3.2-3.2.2.6">
                  <p id="section-4.3.2-3.2.2.6.1">For each subsequent value <code>c</code> in the <code>proof</code> array:<a href="#section-4.3.2-3.2.2.6.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2-3.2.2.6.2">
<li id="section-4.3.2-3.2.2.6.2.1">
                      <p id="section-4.3.2-3.2.2.6.2.1.1">If <code>tn</code> is <code>0</code>, then stop the iteration and fail the proof verification.<a href="#section-4.3.2-3.2.2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-4.3.2-3.2.2.6.2.2">
                      <p id="section-4.3.2-3.2.2.6.2.2.1">If <code>LSB(sn)</code> is set, or if <code>sn</code> is equal to <code>tn</code>, then:<a href="#section-4.3.2-3.2.2.6.2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2-3.2.2.6.2.2.2">
<li id="section-4.3.2-3.2.2.6.2.2.2.1">
                          <p id="section-4.3.2-3.2.2.6.2.2.2.1.1">If <code>fn &lt; sn</code>, set <code>fr</code> to <code>HASH(0x01 || c || fr)</code>.<a href="#section-4.3.2-3.2.2.6.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                        <li id="section-4.3.2-3.2.2.6.2.2.2.2">
                          <p id="section-4.3.2-3.2.2.6.2.2.2.2.1">Set <code>sr</code> to <code>HASH(0x01 || c || sr)</code>.<a href="#section-4.3.2-3.2.2.6.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                        <li id="section-4.3.2-3.2.2.6.2.2.2.3">
                          <p id="section-4.3.2-3.2.2.6.2.2.2.3.1">Until <code>LSB(sn)</code> is set, right-shift <code>fn</code>, <code>sn</code>, and <code>tn</code> equally.<a href="#section-4.3.2-3.2.2.6.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                      </ol>
</li>
                    <li id="section-4.3.2-3.2.2.6.2.3">
                      <p id="section-4.3.2-3.2.2.6.2.3.1">Otherwise:<a href="#section-4.3.2-3.2.2.6.2.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.2-3.2.2.6.2.3.2">
<li id="section-4.3.2-3.2.2.6.2.3.2.1">
                          <p id="section-4.3.2-3.2.2.6.2.3.2.1.1">Set <code>sr</code> to <code>HASH(0x01 || sr || c)</code>.<a href="#section-4.3.2-3.2.2.6.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                      </ol>
</li>
                    <li id="section-4.3.2-3.2.2.6.2.4">
                      <p id="section-4.3.2-3.2.2.6.2.4.1">Right-shift <code>fn</code>, <code>sn</code>, and <code>tn</code> once more.<a href="#section-4.3.2-3.2.2.6.2.4.1" class="pilcrow">¶</a></p>
</li>
                  </ol>
</li>
                <li id="section-4.3.2-3.2.2.7">
                  <p id="section-4.3.2-3.2.2.7.1">Compare <code>tn</code> to <code>0</code>, <code>fr</code> to <code>node_hash</code>, and <code>sr</code> to <code>root_hash</code>. If any are not equal, fail the proof verification. If all are equal, accept the proof.<a href="#section-4.3.2-3.2.2.7.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="arbitrary-intervals">
<section id="section-4.4">
        <h3 id="name-arbitrary-intervals">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-arbitrary-intervals" class="section-name selfRef">Arbitrary Intervals</a>
        </h3>
<p id="section-4.4-1">Not all <code>[start, end)</code> intervals of a Merkle tree are valid subtrees. This section describes how, for any <code>start &lt; end</code>, to determine up to two subtrees that efficiently cover the interval. The subtrees are determined by the following procedure:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4-2">
<li id="section-4.4-2.1">
            <p id="section-4.4-2.1.1">If <code>end - start</code> is one, return a single subtree, <code>[start, end)</code>.<a href="#section-4.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.4-2.2">
            <p id="section-4.4-2.2.1">Otherwise, run the following to return a pair of subtrees:<a href="#section-4.4-2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4-2.2.2">
<li id="section-4.4-2.2.2.1">
                <p id="section-4.4-2.2.2.1.1">Let <code>last</code> be <code>end - 1</code>, the last index in <code>[start, end)</code>.<a href="#section-4.4-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.4-2.2.2.2">
                <p id="section-4.4-2.2.2.2.1">Let <code>split</code> be the bit index of the most significant bit where <code>start</code> and <code>last</code> differ. Bits are numbered from the least significant bit, starting at zero. <code>split</code> is the height at which <code>start</code> and <code>last</code>'s paths in the tree diverge.<a href="#section-4.4-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.4-2.2.2.3">
                <p id="section-4.4-2.2.2.3.1">Let <code>mid</code> be <code>last</code> with the least significant <code>split</code> bits set to zero. <code>mid</code> is the leftmost leaf node in the above divergence point's right branch.<a href="#section-4.4-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.4-2.2.2.4">
                <p id="section-4.4-2.2.2.4.1">Within the least significant <code>split</code> bits of <code>left</code>, let <code>b</code> be the bit index of the most significant bit with value zero, if any:<a href="#section-4.4-2.2.2.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4-2.2.2.4.2">
<li id="section-4.4-2.2.2.4.2.1">
                    <p id="section-4.4-2.2.2.4.2.1.1">If there is such a bit, let <code>left_split</code> be <code>b + 1</code>.<a href="#section-4.4-2.2.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li id="section-4.4-2.2.2.4.2.2">
                    <p id="section-4.4-2.2.2.4.2.2.1">Otherwise, let <code>left_split</code> be zero.<a href="#section-4.4-2.2.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ol>
<p id="section-4.4-2.2.2.4.3">
<code>left_split</code> is the height of the lowest common ancestor of the nodes in <code>[start, mid)</code>.<a href="#section-4.4-2.2.2.4.3" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.4-2.2.2.5">
                <p id="section-4.4-2.2.2.5.1">Let <code>left_start</code> be <code>start</code> with the least significant <code>left_split</code> bits set to zero. <code>left_start</code> is the above lowest common ancestor's leftmost leaf node.<a href="#section-4.4-2.2.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.4-2.2.2.6">
                <p id="section-4.4-2.2.2.6.1">Return the subtrees <code>[left_start, mid)</code> and <code>[mid, end)</code>.<a href="#section-4.4-2.2.2.6.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</li>
        </ol>
<p id="section-4.4-3">When the procedure returns a single subtree, the subtree is <code>[start, start+1)</code>. When it returns two subtrees, <code>left</code> and <code>right</code>, the subtrees satisfy the following properties:<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-4.1">
            <p id="section-4.4-4.1.1"><code>left.end = right.start</code>. That is, the two subtrees cover adjacent intervals.<a href="#section-4.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-4.2">
            <p id="section-4.4-4.2.1"><code>left.start &lt;= start</code> and <code>end = right.end</code>. That is, the two subtrees together cover the entire target interval, possibly with some extra entries before <code>start</code> left, but not after <code>end</code>.<a href="#section-4.4-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-4.3">
            <p id="section-4.4-4.3.1"><code>left.end - left.start &lt; 2 * (end - start)</code> and <code>right.end - right.start &lt;= end - start</code>. That is, the two subtrees efficiently cover the interval.<a href="#section-4.4-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.4-4.4">
            <p id="section-4.4-4.4.1"><code>left</code> is full, while <code>right</code> may be partial.<a href="#section-4.4-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.4-5">The following Python code implements this procedure:<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<div class="lang-python sourcecode" id="section-4.4-6">
<pre>
def find_subtrees(start, end):
    """ Returns a list of one or two subtrees that efficiently
    cover [start, end). """
    assert start &lt; end
    if end - start == 1:
        return [(start, end),]
    last = end - 1
    # Find where start and last's tree paths diverge. The two
    # subtrees will be on either side of the split.
    split = (start ^ last).bit_length() - 1
    mask = (1 &lt;&lt; split) - 1
    mid = last &amp; ~mask
    # Maximize the left endpoint. This is just before start's
    # path leaves the right edge of its new subtree.
    left_split = (~start &amp; mask).bit_length()
    left_start = start &amp; ~((1 &lt;&lt; left_split) - 1)
    return [(left_start, mid), (mid, end)]
</pre><a href="#section-4.4-6" class="pilcrow">¶</a>
</div>
<p id="section-4.4-7"><a href="#fig-subtree-example" class="auto internal xref">Figure 3</a> shows the subtrees which cover <code>[5, 13)</code> in a Merkle Tree of 13 elements. The two subtrees selected are <code>[4, 8)</code> and <code>[8, 13)</code>. Note that the subtrees cover a slightly larger interval than <code>[5, 13)</code>.<a href="#section-4.4-7" class="pilcrow">¶</a></p>
<span id="name-an-example-selection-of-sub"></span><div id="fig-subtree-example">
<figure id="figure-3">
          <div id="section-4.4-8.1">
            <div class="alignLeft art-svg artwork" id="section-4.4-8.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="336" width="456" viewBox="0 0 456 336" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,224 L 8,256" fill="none" stroke="black"></path>
                <path d="M 8,288 L 8,320" fill="none" stroke="black"></path>
                <path d="M 24,288 L 24,320" fill="none" stroke="black"></path>
                <path d="M 32,160 L 32,192" fill="none" stroke="black"></path>
                <path d="M 40,288 L 40,320" fill="none" stroke="black"></path>
                <path d="M 56,224 L 56,256" fill="none" stroke="black"></path>
                <path d="M 56,288 L 56,320" fill="none" stroke="black"></path>
                <path d="M 64,96 L 64,128" fill="none" stroke="black"></path>
                <path d="M 72,224 L 72,256" fill="none" stroke="black"></path>
                <path d="M 72,288 L 72,320" fill="none" stroke="black"></path>
                <path d="M 88,288 L 88,320" fill="none" stroke="black"></path>
                <path d="M 104,160 L 104,192" fill="none" stroke="black"></path>
                <path d="M 104,288 L 104,320" fill="none" stroke="black"></path>
                <path d="M 120,224 L 120,256" fill="none" stroke="black"></path>
                <path d="M 120,288 L 120,320" fill="none" stroke="black"></path>
                <path d="M 136,32 L 136,64" fill="none" stroke="black"></path>
                <path d="M 136,224 L 136,256" fill="none" stroke="black"></path>
                <path d="M 136,288 L 136,320" fill="none" stroke="black"></path>
                <path d="M 152,288 L 152,320" fill="none" stroke="black"></path>
                <path d="M 160,160 L 160,192" fill="none" stroke="black"></path>
                <path d="M 168,288 L 168,320" fill="none" stroke="black"></path>
                <path d="M 184,224 L 184,256" fill="none" stroke="black"></path>
                <path d="M 184,288 L 184,320" fill="none" stroke="black"></path>
                <path d="M 200,96 L 200,128" fill="none" stroke="black"></path>
                <path d="M 200,224 L 200,256" fill="none" stroke="black"></path>
                <path d="M 200,288 L 200,320" fill="none" stroke="black"></path>
                <path d="M 216,288 L 216,320" fill="none" stroke="black"></path>
                <path d="M 232,160 L 232,192" fill="none" stroke="black"></path>
                <path d="M 232,288 L 232,320" fill="none" stroke="black"></path>
                <path d="M 248,224 L 248,256" fill="none" stroke="black"></path>
                <path d="M 248,288 L 248,320" fill="none" stroke="black"></path>
                <path d="M 264,224 L 264,256" fill="none" stroke="black"></path>
                <path d="M 264,288 L 264,320" fill="none" stroke="black"></path>
                <path d="M 280,288 L 280,320" fill="none" stroke="black"></path>
                <path d="M 288,160 L 288,192" fill="none" stroke="black"></path>
                <path d="M 296,288 L 296,320" fill="none" stroke="black"></path>
                <path d="M 312,96 L 312,128" fill="none" stroke="black"></path>
                <path d="M 312,288 L 312,320" fill="none" stroke="black"></path>
                <path d="M 320,224 L 320,256" fill="none" stroke="black"></path>
                <path d="M 328,288 L 328,320" fill="none" stroke="black"></path>
                <path d="M 336,224 L 336,256" fill="none" stroke="black"></path>
                <path d="M 352,288 L 352,320" fill="none" stroke="black"></path>
                <path d="M 368,160 L 368,192" fill="none" stroke="black"></path>
                <path d="M 368,288 L 368,320" fill="none" stroke="black"></path>
                <path d="M 376,32 L 376,64" fill="none" stroke="black"></path>
                <path d="M 392,288 L 392,320" fill="none" stroke="black"></path>
                <path d="M 400,224 L 400,256" fill="none" stroke="black"></path>
                <path d="M 408,288 L 408,320" fill="none" stroke="black"></path>
                <path d="M 424,144 L 424,272" fill="none" stroke="black"></path>
                <path d="M 432,288 L 432,320" fill="none" stroke="black"></path>
                <path d="M 448,96 L 448,128" fill="none" stroke="black"></path>
                <path d="M 136,32 L 376,32" fill="none" stroke="black"></path>
                <path d="M 136,64 L 376,64" fill="none" stroke="black"></path>
                <path d="M 64,96 L 200,96" fill="none" stroke="black"></path>
                <path d="M 312,94 L 448,94" fill="none" stroke="black"></path>
                <path d="M 312,98 L 448,98" fill="none" stroke="black"></path>
                <path d="M 64,128 L 200,128" fill="none" stroke="black"></path>
                <path d="M 312,126 L 448,126" fill="none" stroke="black"></path>
                <path d="M 312,130 L 448,130" fill="none" stroke="black"></path>
                <path d="M 32,160 L 104,160" fill="none" stroke="black"></path>
                <path d="M 160,158 L 232,158" fill="none" stroke="black"></path>
                <path d="M 160,162 L 232,162" fill="none" stroke="black"></path>
                <path d="M 288,160 L 368,160" fill="none" stroke="black"></path>
                <path d="M 32,192 L 104,192" fill="none" stroke="black"></path>
                <path d="M 160,190 L 232,190" fill="none" stroke="black"></path>
                <path d="M 160,194 L 232,194" fill="none" stroke="black"></path>
                <path d="M 288,192 L 368,192" fill="none" stroke="black"></path>
                <path d="M 8,224 L 56,224" fill="none" stroke="black"></path>
                <path d="M 72,224 L 120,224" fill="none" stroke="black"></path>
                <path d="M 136,224 L 184,224" fill="none" stroke="black"></path>
                <path d="M 200,224 L 248,224" fill="none" stroke="black"></path>
                <path d="M 264,224 L 320,224" fill="none" stroke="black"></path>
                <path d="M 336,224 L 400,224" fill="none" stroke="black"></path>
                <path d="M 8,256 L 56,256" fill="none" stroke="black"></path>
                <path d="M 72,256 L 120,256" fill="none" stroke="black"></path>
                <path d="M 136,256 L 184,256" fill="none" stroke="black"></path>
                <path d="M 200,256 L 248,256" fill="none" stroke="black"></path>
                <path d="M 264,256 L 320,256" fill="none" stroke="black"></path>
                <path d="M 336,256 L 400,256" fill="none" stroke="black"></path>
                <path d="M 8,288 L 24,288" fill="none" stroke="black"></path>
                <path d="M 40,288 L 56,288" fill="none" stroke="black"></path>
                <path d="M 72,288 L 88,288" fill="none" stroke="black"></path>
                <path d="M 104,288 L 120,288" fill="none" stroke="black"></path>
                <path d="M 136,288 L 152,288" fill="none" stroke="black"></path>
                <path d="M 168,286 L 184,286" fill="none" stroke="black"></path>
                <path d="M 168,290 L 184,290" fill="none" stroke="black"></path>
                <path d="M 200,286 L 216,286" fill="none" stroke="black"></path>
                <path d="M 200,290 L 216,290" fill="none" stroke="black"></path>
                <path d="M 232,286 L 248,286" fill="none" stroke="black"></path>
                <path d="M 232,290 L 248,290" fill="none" stroke="black"></path>
                <path d="M 264,286 L 280,286" fill="none" stroke="black"></path>
                <path d="M 264,290 L 280,290" fill="none" stroke="black"></path>
                <path d="M 296,286 L 312,286" fill="none" stroke="black"></path>
                <path d="M 296,290 L 312,290" fill="none" stroke="black"></path>
                <path d="M 328,286 L 352,286" fill="none" stroke="black"></path>
                <path d="M 328,290 L 352,290" fill="none" stroke="black"></path>
                <path d="M 368,286 L 392,286" fill="none" stroke="black"></path>
                <path d="M 368,290 L 392,290" fill="none" stroke="black"></path>
                <path d="M 408,286 L 432,286" fill="none" stroke="black"></path>
                <path d="M 408,290 L 432,290" fill="none" stroke="black"></path>
                <path d="M 8,320 L 24,320" fill="none" stroke="black"></path>
                <path d="M 40,320 L 56,320" fill="none" stroke="black"></path>
                <path d="M 72,320 L 88,320" fill="none" stroke="black"></path>
                <path d="M 104,320 L 120,320" fill="none" stroke="black"></path>
                <path d="M 136,320 L 152,320" fill="none" stroke="black"></path>
                <path d="M 168,318 L 184,318" fill="none" stroke="black"></path>
                <path d="M 168,322 L 184,322" fill="none" stroke="black"></path>
                <path d="M 200,318 L 216,318" fill="none" stroke="black"></path>
                <path d="M 200,322 L 216,322" fill="none" stroke="black"></path>
                <path d="M 232,318 L 248,318" fill="none" stroke="black"></path>
                <path d="M 232,322 L 248,322" fill="none" stroke="black"></path>
                <path d="M 264,318 L 280,318" fill="none" stroke="black"></path>
                <path d="M 264,322 L 280,322" fill="none" stroke="black"></path>
                <path d="M 296,318 L 312,318" fill="none" stroke="black"></path>
                <path d="M 296,322 L 312,322" fill="none" stroke="black"></path>
                <path d="M 328,318 L 352,318" fill="none" stroke="black"></path>
                <path d="M 328,322 L 352,322" fill="none" stroke="black"></path>
                <path d="M 368,318 L 392,318" fill="none" stroke="black"></path>
                <path d="M 368,322 L 392,322" fill="none" stroke="black"></path>
                <path d="M 408,318 L 432,318" fill="none" stroke="black"></path>
                <path d="M 408,322 L 432,322" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="248" y="52">[0,</text>
                  <text x="280" y="52">13)</text>
                  <text x="160" y="84">/</text>
                  <text x="352" y="84">\</text>
                  <text x="120" y="116">[0,</text>
                  <text x="148" y="116">8)</text>
                  <text x="368" y="116">[8,</text>
                  <text x="400" y="116">13)</text>
                  <text x="72" y="148">/</text>
                  <text x="192" y="148">\</text>
                  <text x="336" y="148">/</text>
                  <text x="56" y="180">[0,</text>
                  <text x="84" y="180">4)</text>
                  <text x="184" y="180">[4,</text>
                  <text x="212" y="180">8)</text>
                  <text x="312" y="180">[8,</text>
                  <text x="344" y="180">12)</text>
                  <text x="40" y="212">/</text>
                  <text x="96" y="212">\</text>
                  <text x="168" y="212">/</text>
                  <text x="224" y="212">\</text>
                  <text x="304" y="212">/</text>
                  <text x="360" y="212">\</text>
                  <text x="32" y="244">[0,2)</text>
                  <text x="96" y="244">[2,4)</text>
                  <text x="160" y="244">[4,6)</text>
                  <text x="224" y="244">[6,8)</text>
                  <text x="292" y="244">[8,10)</text>
                  <text x="368" y="244">[10,12)</text>
                  <text x="24" y="276">/</text>
                  <text x="40" y="276">\</text>
                  <text x="88" y="276">/</text>
                  <text x="104" y="276">\</text>
                  <text x="152" y="276">/</text>
                  <text x="168" y="276">\</text>
                  <text x="216" y="276">/</text>
                  <text x="232" y="276">\</text>
                  <text x="280" y="276">/</text>
                  <text x="296" y="276">\</text>
                  <text x="352" y="276">/</text>
                  <text x="368" y="276">\</text>
                  <text x="16" y="308">0</text>
                  <text x="48" y="308">1</text>
                  <text x="80" y="308">2</text>
                  <text x="112" y="308">3</text>
                  <text x="144" y="308">4</text>
                  <text x="176" y="308">5</text>
                  <text x="208" y="308">6</text>
                  <text x="240" y="308">7</text>
                  <text x="272" y="308">8</text>
                  <text x="304" y="308">9</text>
                  <text x="340" y="308">10</text>
                  <text x="380" y="308">11</text>
                  <text x="420" y="308">12</text>
                </g>
              </svg><a href="#section-4.4-8.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-an-example-selection-of-sub" class="selfRef">An example selection of subtrees to cover an interval</a>
          </figcaption></figure>
</div>
<p id="section-4.4-9">Two subtrees are needed because a single subtree may not be able to efficiently cover an interval. <a href="#fig-subtree-counterexample" class="auto internal xref">Figure 4</a> shows the smallest subtree that contains <code>[7, 9)</code> in a 9-element tree. The smallest single subtree that contains the interval is <code>[0, 9)</code> but this is the entire tree. Using two subtrees, the interval can be described by <code>[7, 8)</code> and <code>[8, 9)</code>.<a href="#section-4.4-9" class="pilcrow">¶</a></p>
<span id="name-an-example-showing-an-ineff"></span><div id="fig-subtree-counterexample">
<figure id="figure-4">
          <div id="section-4.4-10.1">
            <div class="alignLeft art-svg artwork" id="section-4.4-10.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="336" width="304" viewBox="0 0 304 336" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,224 L 8,256" fill="none" stroke="black"></path>
                <path d="M 8,288 L 8,320" fill="none" stroke="black"></path>
                <path d="M 24,288 L 24,320" fill="none" stroke="black"></path>
                <path d="M 32,160 L 32,192" fill="none" stroke="black"></path>
                <path d="M 40,288 L 40,320" fill="none" stroke="black"></path>
                <path d="M 56,224 L 56,256" fill="none" stroke="black"></path>
                <path d="M 56,288 L 56,320" fill="none" stroke="black"></path>
                <path d="M 64,96 L 64,128" fill="none" stroke="black"></path>
                <path d="M 72,224 L 72,256" fill="none" stroke="black"></path>
                <path d="M 72,288 L 72,320" fill="none" stroke="black"></path>
                <path d="M 88,288 L 88,320" fill="none" stroke="black"></path>
                <path d="M 104,160 L 104,192" fill="none" stroke="black"></path>
                <path d="M 104,288 L 104,320" fill="none" stroke="black"></path>
                <path d="M 120,224 L 120,256" fill="none" stroke="black"></path>
                <path d="M 120,288 L 120,320" fill="none" stroke="black"></path>
                <path d="M 136,32 L 136,64" fill="none" stroke="black"></path>
                <path d="M 136,224 L 136,256" fill="none" stroke="black"></path>
                <path d="M 136,288 L 136,320" fill="none" stroke="black"></path>
                <path d="M 152,288 L 152,320" fill="none" stroke="black"></path>
                <path d="M 160,160 L 160,192" fill="none" stroke="black"></path>
                <path d="M 168,288 L 168,320" fill="none" stroke="black"></path>
                <path d="M 184,224 L 184,256" fill="none" stroke="black"></path>
                <path d="M 184,288 L 184,320" fill="none" stroke="black"></path>
                <path d="M 200,96 L 200,128" fill="none" stroke="black"></path>
                <path d="M 200,224 L 200,256" fill="none" stroke="black"></path>
                <path d="M 200,288 L 200,320" fill="none" stroke="black"></path>
                <path d="M 216,288 L 216,320" fill="none" stroke="black"></path>
                <path d="M 232,160 L 232,192" fill="none" stroke="black"></path>
                <path d="M 232,288 L 232,320" fill="none" stroke="black"></path>
                <path d="M 248,224 L 248,256" fill="none" stroke="black"></path>
                <path d="M 248,288 L 248,320" fill="none" stroke="black"></path>
                <path d="M 264,288 L 264,320" fill="none" stroke="black"></path>
                <path d="M 272,80 L 272,272" fill="none" stroke="black"></path>
                <path d="M 280,288 L 280,320" fill="none" stroke="black"></path>
                <path d="M 296,32 L 296,64" fill="none" stroke="black"></path>
                <path d="M 136,30 L 296,30" fill="none" stroke="black"></path>
                <path d="M 136,34 L 296,34" fill="none" stroke="black"></path>
                <path d="M 136,62 L 296,62" fill="none" stroke="black"></path>
                <path d="M 136,66 L 296,66" fill="none" stroke="black"></path>
                <path d="M 64,96 L 200,96" fill="none" stroke="black"></path>
                <path d="M 64,128 L 200,128" fill="none" stroke="black"></path>
                <path d="M 32,160 L 104,160" fill="none" stroke="black"></path>
                <path d="M 160,160 L 232,160" fill="none" stroke="black"></path>
                <path d="M 32,192 L 104,192" fill="none" stroke="black"></path>
                <path d="M 160,192 L 232,192" fill="none" stroke="black"></path>
                <path d="M 8,224 L 56,224" fill="none" stroke="black"></path>
                <path d="M 72,224 L 120,224" fill="none" stroke="black"></path>
                <path d="M 136,224 L 184,224" fill="none" stroke="black"></path>
                <path d="M 200,224 L 248,224" fill="none" stroke="black"></path>
                <path d="M 8,256 L 56,256" fill="none" stroke="black"></path>
                <path d="M 72,256 L 120,256" fill="none" stroke="black"></path>
                <path d="M 136,256 L 184,256" fill="none" stroke="black"></path>
                <path d="M 200,256 L 248,256" fill="none" stroke="black"></path>
                <path d="M 8,288 L 24,288" fill="none" stroke="black"></path>
                <path d="M 40,288 L 56,288" fill="none" stroke="black"></path>
                <path d="M 72,288 L 88,288" fill="none" stroke="black"></path>
                <path d="M 104,288 L 120,288" fill="none" stroke="black"></path>
                <path d="M 136,288 L 152,288" fill="none" stroke="black"></path>
                <path d="M 168,288 L 184,288" fill="none" stroke="black"></path>
                <path d="M 200,288 L 216,288" fill="none" stroke="black"></path>
                <path d="M 232,286 L 248,286" fill="none" stroke="black"></path>
                <path d="M 232,290 L 248,290" fill="none" stroke="black"></path>
                <path d="M 264,286 L 280,286" fill="none" stroke="black"></path>
                <path d="M 264,290 L 280,290" fill="none" stroke="black"></path>
                <path d="M 8,320 L 24,320" fill="none" stroke="black"></path>
                <path d="M 40,320 L 56,320" fill="none" stroke="black"></path>
                <path d="M 72,320 L 88,320" fill="none" stroke="black"></path>
                <path d="M 104,320 L 120,320" fill="none" stroke="black"></path>
                <path d="M 136,320 L 152,320" fill="none" stroke="black"></path>
                <path d="M 168,320 L 184,320" fill="none" stroke="black"></path>
                <path d="M 200,320 L 216,320" fill="none" stroke="black"></path>
                <path d="M 232,318 L 248,318" fill="none" stroke="black"></path>
                <path d="M 232,322 L 248,322" fill="none" stroke="black"></path>
                <path d="M 264,318 L 280,318" fill="none" stroke="black"></path>
                <path d="M 264,322 L 280,322" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="200" y="52">[0,</text>
                  <text x="228" y="52">9)</text>
                  <text x="160" y="84">/</text>
                  <text x="120" y="116">[0,</text>
                  <text x="148" y="116">8)</text>
                  <text x="72" y="148">/</text>
                  <text x="192" y="148">\</text>
                  <text x="56" y="180">[0,</text>
                  <text x="84" y="180">4)</text>
                  <text x="184" y="180">[4,</text>
                  <text x="212" y="180">8)</text>
                  <text x="40" y="212">/</text>
                  <text x="96" y="212">\</text>
                  <text x="168" y="212">/</text>
                  <text x="224" y="212">\</text>
                  <text x="32" y="244">[0,2)</text>
                  <text x="96" y="244">[2,4)</text>
                  <text x="160" y="244">[4,6)</text>
                  <text x="224" y="244">[6,8)</text>
                  <text x="24" y="276">/</text>
                  <text x="40" y="276">\</text>
                  <text x="88" y="276">/</text>
                  <text x="104" y="276">\</text>
                  <text x="152" y="276">/</text>
                  <text x="168" y="276">\</text>
                  <text x="216" y="276">/</text>
                  <text x="232" y="276">\</text>
                  <text x="16" y="308">0</text>
                  <text x="48" y="308">1</text>
                  <text x="80" y="308">2</text>
                  <text x="112" y="308">3</text>
                  <text x="144" y="308">4</text>
                  <text x="176" y="308">4</text>
                  <text x="208" y="308">6</text>
                  <text x="240" y="308">7</text>
                  <text x="272" y="308">8</text>
                </g>
              </svg><a href="#section-4.4-10.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-an-example-showing-an-ineff" class="selfRef">An example showing an inefficient choice of a single subtree</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="issuance-logs">
<section id="section-5">
      <h2 id="name-issuance-logs">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-issuance-logs" class="section-name selfRef">Issuance Logs</a>
      </h2>
<p id="section-5-1">This section defines the structure of an <em>issuance log</em>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">An issuance log describes an append-only sequence of <em>entries</em> (<a href="#log-entries" class="auto internal xref">Section 5.3</a>), identified consecutively by an index value, starting from zero. Each entry is an assertion that the CA has certified. The entries in the issuance log are represented as a Merkle Tree, described in <span><a href="https://rfc-editor.org/rfc/rfc9162#section-2.1" class="relref">Section 2.1</a> of [<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Unlike <span>[<a href="#RFC6962" class="cite xref">RFC6962</a>]</span> and <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>, an issuance log does not have a public submission interface. The log only contains entries which the log operator, i.e. the CA, chose to add. As entries are added, the Merkle Tree is updated to be computed over the new sequence.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">A snapshot of the log is known as a <em>checkpoint</em>. A checkpoint is identified by its <em>tree size</em>, that is the number of elements comitted to the log at the time. Its contents can be described by the Merkle Tree Hash (<span><a href="https://rfc-editor.org/rfc/rfc9162#section-2.1.1" class="relref">Section 2.1.1</a> of [<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>) of entries zero through <code>tree_size - 1</code>.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">Cosigners (<a href="#cosigners" class="auto internal xref">Section 5.4</a>) sign assertions about the state of the issuance log. A Merkle Tree CA operates a combination of an issuance log and one or more CA cosigners (<a href="#certification-authority-cosigners" class="auto internal xref">Section 5.5</a>) that authenticate the log state and certifies the contents. External cosigners may also be deployed to assert correct log operation or provide other services to relying parties (<a href="#trusted-cosigners" class="auto internal xref">Section 7.3</a>).<a href="#section-5-5" class="pilcrow">¶</a></p>
<div id="log-parameters">
<section id="section-5.1">
        <h3 id="name-log-parameters">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-log-parameters" class="section-name selfRef">Log Parameters</a>
        </h3>
<p id="section-5.1-1">An issuance log has the following parameters:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">
            <p id="section-5.1-2.1.1">A log ID, which uniquely identifies the log. See <a href="#log-ids" class="auto internal xref">Section 5.2</a>.<a href="#section-5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.2">
            <p id="section-5.1-2.2.1">A collision-resistant cryptographic hash function. SHA-256 <span>[<a href="#SHS" class="cite xref">SHS</a>]</span> is RECOMMENDED.<a href="#section-5.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-2.3">
            <p id="section-5.1-2.3.1">A minimum index, which is the index of the first log entry which is available. See <a href="#log-pruning" class="auto internal xref">Section 5.6.1</a>. This value changes over the lifetime of the log.<a href="#section-5.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.1-3">Throughout this document, the hash algorithm in use is referred to as HASH, and the size of its output in bytes is referred to as HASH_SIZE.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="log-ids">
<section id="section-5.2">
        <h3 id="name-log-ids">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-log-ids" class="section-name selfRef">Log IDs</a>
        </h3>
<p id="section-5.2-1">Each issuance log is identified by a <em>log ID</em>, which is a trust anchor ID <span>[<a href="#I-D.ietf-tls-trust-anchor-ids" class="cite xref">I-D.ietf-tls-trust-anchor-ids</a>]</span>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">An issuance log's log ID determines an X.509 distinguished name (<span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.1.2.4" class="relref">Section 4.1.2.4</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>). The distinguished name has a single relative distinguished name, which has a single attribute. The attribute has type <code>id-rdna-trustAnchorID</code>, defined below:<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.2-3">
<pre>
id-rdna-trustAnchorID OBJECT IDENTIFIER ::= {
    iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) rdna(25) TBD}
</pre><a href="#section-5.2-3" class="pilcrow">¶</a>
</div>
<p id="section-5.2-4">The attribute's value is a RELATIVE-OID containing the trust anchor ID's ASN.1 representation. For example, the distinguished name for a log named <code>32473.1</code> would be represented in syntax of <span>[<a href="#RFC4514" class="cite xref">RFC4514</a>]</span> as:<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-5">
<pre>
1.3.6.1.5.5.7.25.TBD=#0d0481fd5901
</pre><a href="#section-5.2-5" class="pilcrow">¶</a>
</div>
<p id="section-5.2-6">For initial experimentation, early implementations of this design will:<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2-7">
<li id="section-5.2-7.1">
            <p id="section-5.2-7.1.1">Use UTF8String to represent the attribute's value rather than RELATIVE-OID. The UTF8String contains trust anchor ID's ASCII representation, e.g. <code>324731.1</code>.<a href="#section-5.2-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.2-7.2">
            <p id="section-5.2-7.2.1">Use the OID 1.3.6.1.4.1.44363.47.1 instead of <code>id-rdna-trustAnchorID</code>.<a href="#section-5.2-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-5.2-8">For example, the distinguished name for a log named <code>32473.1</code> would be represented in syntax of <span>[<a href="#RFC4514" class="cite xref">RFC4514</a>]</span> as:<a href="#section-5.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-9">
<pre>
1.3.6.1.4.1.44363.47.1=#0c0733323437332e31
</pre><a href="#section-5.2-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="log-entries">
<section id="section-5.3">
        <h3 id="name-log-entries">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-log-entries" class="section-name selfRef">Log Entries</a>
        </h3>
<p id="section-5.3-1">Each entry in the log is a MerkleTreeCertEntry, defined with the TLS presentation syntax below. A MerkleTreeCertEntry describes certificate information that the CA has validated and certified.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div class="lang-tls-presentation sourcecode" id="section-5.3-2">
<pre>
struct {} Empty;

enum {
    null_entry(0), tbs_cert_entry(1), (2^16-1)
} MerkleTreeCertEntryType;

struct {
    MerkleTreeCertEntryType type;
    select (type) {
       case null_entry: Empty;
       case tbs_cert_entry: opaque tbs_cert_entry_data[N];
       /* May be extended with future types. */
    }
} MerkleTreeCertEntry;
</pre><a href="#section-5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3-3">When <code>type</code> is <code>tbs_cert_entry</code>, <code>N</code> is the number of bytes needed to consume the rest of the input. A MerkleTreeCertEntry is expected to be decoded in contexts where the total length of the entry is known.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3-4"><code>tbs_cert_entry_data</code> contains the DER <span>[<a href="#X.690" class="cite xref">X.690</a>]</span> encoding of a TBSCertificateLogEntry, defined below:<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.3-5">
<pre>
TBSCertificateLogEntry  ::=  SEQUENCE  {
      version             [0]  EXPLICIT Version DEFAULT v1,
      issuer                   Name,
      validity                 Validity,
      subject                  Name,
      subjectPublicKeyInfoHash OCTET STRING,
      issuerUniqueID      [1]  IMPLICIT UniqueIdentifier OPTIONAL,
      subjectUniqueID     [2]  IMPLICIT UniqueIdentifier OPTIONAL,
      extensions          [3]  EXPLICIT Extensions OPTIONAL }
</pre><a href="#section-5.3-5" class="pilcrow">¶</a>
</div>
<p id="section-5.3-6">The <code>version</code>, <code>issuer</code>, <code>validity</code>, <code>subject</code>, <code>issuerUniqueID</code>, <code>subjectUniqueID</code>, and <code>extensions</code> fields have the corresponding semantics as in <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, with the exception of <code>subjectPublicKeyInfoHash</code>. <code>subjectPublicKeyInfoHash</code> contains the hash of subject's public key as a SubjectPublicKeyInfo (<span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.1.2.7" class="relref">Section 4.1.2.7</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>). The hash uses the log's hash function (<a href="#log-parameters" class="auto internal xref">Section 5.1</a>) and is computed over the SubjectPublicKeyInfo's DER <span>[<a href="#X.690" class="cite xref">X.690</a>]</span> encoding. The <code>issuer</code> field MUST be the issuance log's log ID as an X.509 distinguished name, as described in <a href="#log-ids" class="auto internal xref">Section 5.2</a>.<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3-7">When <code>type</code> is <code>null_entry</code>, the entry does not represent any information. The entry at index zero of every issuance log MUST be of type <code>null_entry</code>. Other entries MUST NOT use <code>null_entry</code>. <code>null_entry</code> exists to avoid zero serial numbers in the certificate format (<a href="#certificate-format" class="auto internal xref">Section 6.1</a>).<a href="#section-5.3-7" class="pilcrow">¶</a></p>
<p id="section-5.3-8">MerkleTreeCertEntry is an extensible structure. Future documents may define new values for MerkleTreeCertEntryType, with corresponding semantics. See <a href="#certification-authority-cosigners" class="auto internal xref">Section 5.5</a> and <a href="#new-log-entry-types" class="auto internal xref">Section 12.5</a> for additional discussion.<a href="#section-5.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cosigners">
<section id="section-5.4">
        <h3 id="name-cosigners">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-cosigners" class="section-name selfRef">Cosigners</a>
        </h3>
<p id="section-5.4-1">This section defines a log <em>cosigner</em>. A cosigner follows some append-only view of the log and signs subtrees (<a href="#subtrees" class="auto internal xref">Section 4</a>) consistent with that view. The signatures generated by a cosigner are known as <em>cosignatures</em>. All subtrees signed by a cosigner MUST be consistent with each other. The cosigner may be external to the log, in which case it might ensure consistency by checking consistency proofs. The cosigner may be operated together with the log, in which case it can trust its log state.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">A cosignature MAY implicitly make additional statements about a subtree, determined by the cosigner's role. This document defines one concrete cosigner role, a CA cosigner (<a href="#certification-authority-cosigners" class="auto internal xref">Section 5.5</a>), to authenticate the log and certify entries. Other documents and specific deployments may define other cosigner roles, to perform different functions in a PKI. For example, <span>[<a href="#TLOG-WITNESS" class="cite xref">TLOG-WITNESS</a>]</span> defines a cosigner that only checks the log is append-only, and <span>[<a href="#TLOG-MIRROR" class="cite xref">TLOG-MIRROR</a>]</span> defines a cosigner that mirrors a log.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">Each cosigner has a public key and a <em>cosigner ID</em>, which uniquely identifies the cosigner. The cosigner ID is a trust anchor ID <span>[<a href="#I-D.ietf-tls-trust-anchor-ids" class="cite xref">I-D.ietf-tls-trust-anchor-ids</a>]</span>. By identifying the cosigner, the cosigner ID specifies both the public key and the additional statements made by the cosigner's signatures. If a single operator performs multiple cosigner roles in an ecosystem, each role MUST use a distinct cosigner ID and SHOULD use a distinct key.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">A single cosigner, with a single cosigner ID and public key, MAY generate cosignatures for multiple logs. In this case, signed subtrees only need to be consistent with others for the same log.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<div id="signature-format">
<section id="section-5.4.1">
          <h4 id="name-signature-format">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-signature-format" class="section-name selfRef">Signature Format</a>
          </h4>
<p id="section-5.4.1-1">A cosigner computes a cosignature for a subtree in some log by signing a MTCSubtreeSignatureInput, defined below using the TLS presentation language (<span><a href="https://rfc-editor.org/rfc/rfc8446#section-3" class="relref">Section 3</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>):<a href="#section-5.4.1-1" class="pilcrow">¶</a></p>
<div class="lang-tls-presentation sourcecode" id="section-5.4.1-2">
<pre>
opaque HashValue[HASH_SIZE];

/* From Section 4.1 of draft-ietf-tls-trust-anchor-ids */
opaque TrustAnchorID&lt;1..2^8-1&gt;;

struct {
    TrustAnchorID log_id;
    uint64 start;
    uint64 end;
    HashValue hash;
} MTCSubtree;

struct {
    uint8 label[16] = "mtc-subtree/v1\n\0";
    TrustAnchorID cosigner_id;
    MTCSubtree subtree;
} MTCSubtreeSignatureInput;
</pre><a href="#section-5.4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.4.1-3"><code>log_id</code> MUST be the issuance log's ID (<a href="#log-ids" class="auto internal xref">Section 5.2</a>), in its binary representation (<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-trust-anchor-ids-02#section-3" class="relref">Section 3</a> of [<a href="#I-D.ietf-tls-trust-anchor-ids" class="cite xref">I-D.ietf-tls-trust-anchor-ids</a>]</span>). <code>start</code> and <code>end</code> MUST define a valid subtree of the log, and <code>hash</code> MUST be the subtree's hash value in the cosigner's view of the log. The <code>label</code> is a fixed prefix for domain separation. Its value MUST be the string <code>mtc-subtree/v1</code>, followed by a newline (U+000A), followed by a zero byte (U+0000). <code>cosigner_id</code> MUST be the cosigner ID, in its binary representation.<a href="#section-5.4.1-3" class="pilcrow">¶</a></p>
<p id="section-5.4.1-4">The resulting signature is known as a <em>subtree signature</em>. When <code>start</code> is zero, the resulting signature describes the checkpoint with tree size <code>end</code> and is also known as a <em>checkpoint signature</em>.<a href="#section-5.4.1-4" class="pilcrow">¶</a></p>
<p id="section-5.4.1-5">For each supported log, a cosigner retains its checkpoint signature with the largest <code>end</code>. This is known as the cosigner's <em>current</em> checkpoint. If the cosigner's current checkpoint has tree size <code>tree_size</code>, it MUST NOT generate a signature for a subtree <code>[start, end)</code> if <code>start &gt; 0</code> and <code>end &gt; tree_size</code>. That is, a cosigner can only sign a non-checkpoint subtree if it is contained in its current checkpoint. In a correctly-operated cosigner, every signature made by the cosigner can be proven consistent with its current checkpoint with a subtree consistency proof (<a href="#subtree-consistency-proofs" class="auto internal xref">Section 4.3</a>). As a consequence, a cosigner that signs a subtree is held responsible for all the entries in the tree of size matching the subtree end, even if the corresponding checkpoint is erroneously unavailable.<a href="#section-5.4.1-5" class="pilcrow">¶</a></p>
<p id="section-5.4.1-6">Before signing a subtree, the cosigner MUST ensure that <code>hash</code> is consistent with its log state. Different cosigner roles may obtain this assurance differently. For example, a cosigner may compute the hash from its saved log state (e.g. if it is the log operator or maintains a copy of the log) or by verifying a subtree consistency proof (<a href="#subtree-consistency-proofs" class="auto internal xref">Section 4.3</a>) from its current checkpoint. When a cosigner signs a subtree, it is held responsible <em>both</em> for the subtree being consistent with its other signatures, <em>and</em> for the cosigner-specific additional statements.<a href="#section-5.4.1-6" class="pilcrow">¶</a></p>
<p id="section-5.4.1-7">Cosigners SHOULD publish their current checkpoint, along with the checkpoint signature.<a href="#section-5.4.1-7" class="pilcrow">¶</a></p>
<p id="section-5.4.1-8">[[TODO: CT and tlog put timestamps in checkpoint signatures. Do we want them here? In CT and tlog, the timestamps are monotonically increasing as the log progresses, but we also sign subtrees. We can separate subtree and checkpoint signatures, with timestamps only in the latter, but it's unclear if there is any benefit to this.]]<a href="#section-5.4.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-algorithms">
<section id="section-5.4.2">
          <h4 id="name-signature-algorithms">
<a href="#section-5.4.2" class="section-number selfRef">5.4.2. </a><a href="#name-signature-algorithms" class="section-name selfRef">Signature Algorithms</a>
          </h4>
<p id="section-5.4.2-1">The cosigner's public key specifies both the key material and the signature algorithm to use with the key material. In order to change key or signature parameters, a cosigner operator MUST deploy a new cosigner, with a new cosigner ID. Signature algorithms MUST fully specify the algorithm parameters, such as hash functions used. This document defines the following signature algorithms:<a href="#section-5.4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.2-2.1">
              <p id="section-5.4.2-2.1.1">ECDSA with P-256 and SHA-256 <span>[<a href="#FIPS186-5" class="cite xref">FIPS186-5</a>]</span><a href="#section-5.4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.2-2.2">
              <p id="section-5.4.2-2.2.1">ECDSA with P-384 and SHA-384 <span>[<a href="#FIPS186-5" class="cite xref">FIPS186-5</a>]</span><a href="#section-5.4.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.2-2.3">
              <p id="section-5.4.2-2.3.1">Ed25519 <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span><a href="#section-5.4.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.2-2.4">
              <p id="section-5.4.2-2.4.1">ML-DSA-44 <span>[<a href="#FIPS204" class="cite xref">FIPS204</a>]</span><a href="#section-5.4.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.2-2.5">
              <p id="section-5.4.2-2.5.1">ML-DSA-65 <span>[<a href="#FIPS204" class="cite xref">FIPS204</a>]</span><a href="#section-5.4.2-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.2-2.6">
              <p id="section-5.4.2-2.6.1">ML-DSA-87 <span>[<a href="#FIPS204" class="cite xref">FIPS204</a>]</span><a href="#section-5.4.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.4.2-3">Other documents or deployments MAY define other signature schemes and formats. Log clients that accept cosignatures from some cosigner are assumed to be configured with all parameters necessary to verify that cosigner's signatures, including the signature algorithm and version of the signature format.<a href="#section-5.4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="certification-authority-cosigners">
<section id="section-5.5">
        <h3 id="name-certification-authority-cos">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-certification-authority-cos" class="section-name selfRef">Certification Authority Cosigners</a>
        </h3>
<p id="section-5.5-1">A <em>CA cosigner</em> is a cosigner (<a href="#cosigners" class="auto internal xref">Section 5.4</a>) that certifies the contents of a log.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">When a CA cosigner signs a subtree, it makes the additional statement that it has certified each entry in the subtree. For example, a domain-validating CA states that it has performed domain validation for each entry, at some time consistent with the entry's validity dates. CAs are held responsible for every entry in every subtree they sign. Proving an entry is included (<a href="#subtree-inclusion-proofs" class="auto internal xref">Section 4.2</a>) in a CA-signed subtree is sufficient to prove the CA certified it.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3">What it means to certify an entry depends on the entry type:<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-4.1">
            <p id="section-5.5-4.1.1">To certify an entry of type <code>null_entry</code> is a no-op. A CA MAY freely certify <code>null_entry</code> without being held responsible for any validation.<a href="#section-5.5-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.5-4.2">
            <p id="section-5.5-4.2.1">To certify an entry of type <code>tbs_cert_entry</code> is to certify the TBSCertificateLogEntry, as defined in <a href="#log-entries" class="auto internal xref">Section 5.3</a>.<a href="#section-5.5-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.5-5">Entries are extensible. Future documents MAY define <code>type</code> values and what it means to certify them. A CA MUST NOT sign a subtree if it contains an entry with <code>type</code> that it does not recognize. Doing so would certify that the CA has validated the information in some not-yet-defined entry format. <a href="#new-log-entry-types" class="auto internal xref">Section 12.5</a> further discusses security implications of new formats.<a href="#section-5.5-5" class="pilcrow">¶</a></p>
<p id="section-5.5-6">A CA operator MAY operate multiple CA cosigners that all certify the same log in parallel. This may be useful when, e.g., rotating CA keys. In this case, each CA instance MUST have a distinct name. The CA operator's ACME server can return all CA cosignatures together in a single certificate, with the application protocol selecting the cosignatures to use. <a href="#use-in-tls" class="auto internal xref">Section 8</a> describes how this is done in TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.<a href="#section-5.5-6" class="pilcrow">¶</a></p>
<p id="section-5.5-7">If the CA operator additionally operates a traditional X.509 CA, that CA key MUST be distinct from any Merkle Tree CA cosigner keys.<a href="#section-5.5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="publishing-logs">
<section id="section-5.6">
        <h3 id="name-publishing-logs">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-publishing-logs" class="section-name selfRef">Publishing Logs</a>
        </h3>
<p id="section-5.6-1"><em>[[NOTE: This section is written to avoid depending on a specific serving protocol. The current expectation is that a Web PKI deployment would derive from <span>[<a href="#TLOG-TILES" class="cite xref">TLOG-TILES</a>]</span>, to match the direction of Certificate Transparency and pick up improvements made there.</em><a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2"><em>For now, we avoid a normative reference on <span>[<a href="#TLOG-TILES" class="cite xref">TLOG-TILES</a>]</span> and also capture the fact that the certificate construction is independent of the choice of protocol. Similar to how the CT ecosystem is migrating to a tiled interface, were someone to improve on <span>[<a href="#TLOG-TILES" class="cite xref">TLOG-TILES</a>]</span>, a PKI could migrate to that new protocol without impacting certificate verification.</em><a href="#section-5.6-2" class="pilcrow">¶</a></p>
<p id="section-5.6-3"><em>That said, this is purely a starting point for describing the design. We expect the scope of this document, and other related documents to adapt as the work evolves across the IETF, C2SP, Certificate Transparency, and other communities.]]</em><a href="#section-5.6-3" class="pilcrow">¶</a></p>
<p id="section-5.6-4">Issuance logs are intended to be publicly accessible in some form, to allow monitors to detect misissued certificates.<a href="#section-5.6-4" class="pilcrow">¶</a></p>
<p id="section-5.6-5">The access method does not affect certificate interoperability, so this document does not prescribe a specific protocol. An individual issuance log MAY be published in any form, provided other parties in the PKI are able to consume it. Relying parties SHOULD define log serving requirements, including the allowed protocols and expected availability, as part of their policies on which CAs to support. See also <a href="#log-availability" class="auto internal xref">Section 10.3</a>.<a href="#section-5.6-5" class="pilcrow">¶</a></p>
<p id="section-5.6-6">For example, a log ecosystem could use <span>[<a href="#TLOG-TILES" class="cite xref">TLOG-TILES</a>]</span> to serve logs. <span>[<a href="#TLOG-TILES" class="cite xref">TLOG-TILES</a>]</span> improves on <span>[<a href="#RFC6962" class="cite xref">RFC6962</a>]</span> and <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span> by exposing the log as a collection of cacheable, immutable "tiles". This works well with a variety of common HTTP <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span> serving architectures. It also allows log clients to request arbitrary tree nodes, so log clients can fetch the structures described in <a href="#subtrees" class="auto internal xref">Section 4</a>.<a href="#section-5.6-6" class="pilcrow">¶</a></p>
<div id="log-pruning">
<section id="section-5.6.1">
          <h4 id="name-log-pruning">
<a href="#section-5.6.1" class="section-number selfRef">5.6.1. </a><a href="#name-log-pruning" class="section-name selfRef">Log Pruning</a>
          </h4>
<p id="section-5.6.1-1">Over time, an issuance log's entries will expire and likely be replaced with certificate renewals. As this happens, the total size of the log grows, even if the unexpired subset remains fixed. To mitigate this, issuance logs MAY be <em>pruned</em>, as described in this section.<a href="#section-5.6.1-1" class="pilcrow">¶</a></p>
<p id="section-5.6.1-2">Pruning makes some prefix of the log unavailable, without changing the tree structure. It may be used to reduce the serving cost of long-lived logs, where any entries have long expired. <a href="#log-availability" class="auto internal xref">Section 10.3</a> discusses policies on when pruning may be permitted. This section discusses how it is done and the impact on log structure.<a href="#section-5.6.1-2" class="pilcrow">¶</a></p>
<p id="section-5.6.1-3">An issuance log is pruned by updating its <em>minimum index</em> parameter (<a href="#log-parameters" class="auto internal xref">Section 5.1</a>). The minimum index is the index of the first log entry that the log publishes. (See <a href="#publishing-logs" class="auto internal xref">Section 5.6</a>.) It MUST be less than or equal to the tree size of the log's current checkpoint, and also satisfy any availability policies set by relying parties who trust the CA.<a href="#section-5.6.1-3" class="pilcrow">¶</a></p>
<p id="section-5.6.1-4">An entry is said to be <em>available</em> if its index is greater than or equal to the minimum index. A checkpoint is said to be available if its tree size is greater than the minimum index. A subtree <code>[start, end)</code> is said to be available if <code>end</code> is greater than the minimum index.<a href="#section-5.6.1-4" class="pilcrow">¶</a></p>
<p id="section-5.6.1-5">Log protocols MUST serve enough information to allow a log client to efficiently obtain the following:<a href="#section-5.6.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.1-6.1">
              <p id="section-5.6.1-6.1.1">Signatures over the latest checkpoint by the CA's cosigners (<a href="#certification-authority-cosigners" class="auto internal xref">Section 5.5</a>)<a href="#section-5.6.1-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.6.1-6.2">
              <p id="section-5.6.1-6.2.1">Any individual available log entry (<a href="#log-entries" class="auto internal xref">Section 5.3</a>)<a href="#section-5.6.1-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.6.1-6.3">
              <p id="section-5.6.1-6.3.1">The hash value of any available checkpoint<a href="#section-5.6.1-6.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.6.1-6.4">
              <p id="section-5.6.1-6.4.1">An inclusion proof (<span><a href="https://rfc-editor.org/rfc/rfc9162#section-2.1.3" class="relref">Section 2.1.3</a> of [<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>) for any available entry to any containing checkpoint<a href="#section-5.6.1-6.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.6.1-6.5">
              <p id="section-5.6.1-6.5.1">A consistency proof (<span><a href="https://rfc-editor.org/rfc/rfc9162#section-2.1.4" class="relref">Section 2.1.4</a> of [<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>) between any two available checkpoints<a href="#section-5.6.1-6.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.6.1-6.6">
              <p id="section-5.6.1-6.6.1">The hash value of any available subtree (<a href="#subtrees" class="auto internal xref">Section 4</a>)<a href="#section-5.6.1-6.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.6.1-6.7">
              <p id="section-5.6.1-6.7.1">A subtree inclusion proof (<a href="#subtree-inclusion-proofs" class="auto internal xref">Section 4.2</a>) for any available entry in any containing subtree<a href="#section-5.6.1-6.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.6.1-6.8">
              <p id="section-5.6.1-6.8.1">A subtree consistency proof (<a href="#subtree-consistency-proofs" class="auto internal xref">Section 4.3</a>) between any available subtree to any containing checkpoint<a href="#section-5.6.1-6.8.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.6.1-7">Meeting these requirements requires a log to retain some information about pruned entries. Given a node <code>[start, end)</code> in the Merkle Tree, if <code>end</code> is less than or equal to the minimum index, the node's children MAY be discarded in favor of the node's hash.<a href="#section-5.6.1-7" class="pilcrow">¶</a></p>
<p id="section-5.6.1-8"><a href="#fig-prune-tree" class="auto internal xref">Figure 5</a> shows an example pruned tree with 13 elements, where the minimum index is 7. It shows the original tree, followed by the pruned tree. The pruned tree depicts the nodes that MUST be available or computable. Note that entry 6 MAY be discarded, only the hash of entry 6 must be available.<a href="#section-5.6.1-8" class="pilcrow">¶</a></p>
<span id="name-an-example-showing-the-mini"></span><div id="fig-prune-tree">
<figure id="figure-5">
            <div id="section-5.6.1-9.1">
              <div class="alignLeft art-svg artwork" id="section-5.6.1-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="672" width="456" viewBox="0 0 456 672" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,224 L 8,256" fill="none" stroke="black"></path>
                  <path d="M 8,288 L 8,320" fill="none" stroke="black"></path>
                  <path d="M 24,288 L 24,320" fill="none" stroke="black"></path>
                  <path d="M 32,160 L 32,192" fill="none" stroke="black"></path>
                  <path d="M 32,496 L 32,528" fill="none" stroke="black"></path>
                  <path d="M 40,288 L 40,320" fill="none" stroke="black"></path>
                  <path d="M 56,224 L 56,256" fill="none" stroke="black"></path>
                  <path d="M 56,288 L 56,320" fill="none" stroke="black"></path>
                  <path d="M 64,96 L 64,128" fill="none" stroke="black"></path>
                  <path d="M 64,432 L 64,464" fill="none" stroke="black"></path>
                  <path d="M 72,224 L 72,256" fill="none" stroke="black"></path>
                  <path d="M 72,288 L 72,320" fill="none" stroke="black"></path>
                  <path d="M 88,288 L 88,320" fill="none" stroke="black"></path>
                  <path d="M 104,160 L 104,192" fill="none" stroke="black"></path>
                  <path d="M 104,288 L 104,320" fill="none" stroke="black"></path>
                  <path d="M 104,496 L 104,528" fill="none" stroke="black"></path>
                  <path d="M 120,224 L 120,256" fill="none" stroke="black"></path>
                  <path d="M 120,288 L 120,320" fill="none" stroke="black"></path>
                  <path d="M 136,32 L 136,64" fill="none" stroke="black"></path>
                  <path d="M 136,224 L 136,256" fill="none" stroke="black"></path>
                  <path d="M 136,288 L 136,320" fill="none" stroke="black"></path>
                  <path d="M 136,368 L 136,400" fill="none" stroke="black"></path>
                  <path d="M 136,560 L 136,592" fill="none" stroke="black"></path>
                  <path d="M 152,288 L 152,320" fill="none" stroke="black"></path>
                  <path d="M 160,160 L 160,192" fill="none" stroke="black"></path>
                  <path d="M 160,496 L 160,528" fill="none" stroke="black"></path>
                  <path d="M 168,288 L 168,320" fill="none" stroke="black"></path>
                  <path d="M 184,224 L 184,256" fill="none" stroke="black"></path>
                  <path d="M 184,288 L 184,320" fill="none" stroke="black"></path>
                  <path d="M 184,560 L 184,592" fill="none" stroke="black"></path>
                  <path d="M 200,96 L 200,128" fill="none" stroke="black"></path>
                  <path d="M 200,224 L 200,256" fill="none" stroke="black"></path>
                  <path d="M 200,288 L 200,320" fill="none" stroke="black"></path>
                  <path d="M 200,432 L 200,464" fill="none" stroke="black"></path>
                  <path d="M 200,560 L 200,592" fill="none" stroke="black"></path>
                  <path d="M 200,624 L 200,656" fill="none" stroke="black"></path>
                  <path d="M 216,288 L 216,320" fill="none" stroke="black"></path>
                  <path d="M 216,624 L 216,656" fill="none" stroke="black"></path>
                  <path d="M 232,160 L 232,192" fill="none" stroke="black"></path>
                  <path d="M 232,288 L 232,320" fill="none" stroke="black"></path>
                  <path d="M 232,496 L 232,528" fill="none" stroke="black"></path>
                  <path d="M 232,624 L 232,656" fill="none" stroke="black"></path>
                  <path d="M 248,224 L 248,256" fill="none" stroke="black"></path>
                  <path d="M 248,288 L 248,320" fill="none" stroke="black"></path>
                  <path d="M 248,560 L 248,592" fill="none" stroke="black"></path>
                  <path d="M 248,624 L 248,656" fill="none" stroke="black"></path>
                  <path d="M 264,224 L 264,256" fill="none" stroke="black"></path>
                  <path d="M 264,288 L 264,320" fill="none" stroke="black"></path>
                  <path d="M 264,560 L 264,592" fill="none" stroke="black"></path>
                  <path d="M 264,624 L 264,656" fill="none" stroke="black"></path>
                  <path d="M 280,288 L 280,320" fill="none" stroke="black"></path>
                  <path d="M 280,624 L 280,656" fill="none" stroke="black"></path>
                  <path d="M 288,160 L 288,192" fill="none" stroke="black"></path>
                  <path d="M 288,496 L 288,528" fill="none" stroke="black"></path>
                  <path d="M 296,288 L 296,320" fill="none" stroke="black"></path>
                  <path d="M 296,624 L 296,656" fill="none" stroke="black"></path>
                  <path d="M 312,96 L 312,128" fill="none" stroke="black"></path>
                  <path d="M 312,288 L 312,320" fill="none" stroke="black"></path>
                  <path d="M 312,432 L 312,464" fill="none" stroke="black"></path>
                  <path d="M 312,624 L 312,656" fill="none" stroke="black"></path>
                  <path d="M 320,224 L 320,256" fill="none" stroke="black"></path>
                  <path d="M 320,560 L 320,592" fill="none" stroke="black"></path>
                  <path d="M 328,288 L 328,320" fill="none" stroke="black"></path>
                  <path d="M 328,624 L 328,656" fill="none" stroke="black"></path>
                  <path d="M 336,224 L 336,256" fill="none" stroke="black"></path>
                  <path d="M 336,560 L 336,592" fill="none" stroke="black"></path>
                  <path d="M 352,288 L 352,320" fill="none" stroke="black"></path>
                  <path d="M 352,624 L 352,656" fill="none" stroke="black"></path>
                  <path d="M 368,160 L 368,192" fill="none" stroke="black"></path>
                  <path d="M 368,288 L 368,320" fill="none" stroke="black"></path>
                  <path d="M 368,496 L 368,528" fill="none" stroke="black"></path>
                  <path d="M 368,624 L 368,656" fill="none" stroke="black"></path>
                  <path d="M 376,32 L 376,64" fill="none" stroke="black"></path>
                  <path d="M 376,368 L 376,400" fill="none" stroke="black"></path>
                  <path d="M 392,288 L 392,320" fill="none" stroke="black"></path>
                  <path d="M 392,624 L 392,656" fill="none" stroke="black"></path>
                  <path d="M 400,224 L 400,256" fill="none" stroke="black"></path>
                  <path d="M 400,560 L 400,592" fill="none" stroke="black"></path>
                  <path d="M 408,288 L 408,320" fill="none" stroke="black"></path>
                  <path d="M 408,624 L 408,656" fill="none" stroke="black"></path>
                  <path d="M 424,136 L 424,272" fill="none" stroke="black"></path>
                  <path d="M 424,472 L 424,608" fill="none" stroke="black"></path>
                  <path d="M 432,288 L 432,320" fill="none" stroke="black"></path>
                  <path d="M 432,624 L 432,656" fill="none" stroke="black"></path>
                  <path d="M 448,96 L 448,128" fill="none" stroke="black"></path>
                  <path d="M 448,432 L 448,464" fill="none" stroke="black"></path>
                  <path d="M 136,32 L 376,32" fill="none" stroke="black"></path>
                  <path d="M 136,64 L 376,64" fill="none" stroke="black"></path>
                  <path d="M 64,96 L 200,96" fill="none" stroke="black"></path>
                  <path d="M 312,96 L 448,96" fill="none" stroke="black"></path>
                  <path d="M 64,128 L 200,128" fill="none" stroke="black"></path>
                  <path d="M 312,128 L 448,128" fill="none" stroke="black"></path>
                  <path d="M 32,160 L 104,160" fill="none" stroke="black"></path>
                  <path d="M 160,160 L 232,160" fill="none" stroke="black"></path>
                  <path d="M 288,160 L 368,160" fill="none" stroke="black"></path>
                  <path d="M 32,192 L 104,192" fill="none" stroke="black"></path>
                  <path d="M 160,192 L 232,192" fill="none" stroke="black"></path>
                  <path d="M 288,192 L 368,192" fill="none" stroke="black"></path>
                  <path d="M 8,224 L 56,224" fill="none" stroke="black"></path>
                  <path d="M 72,224 L 120,224" fill="none" stroke="black"></path>
                  <path d="M 136,224 L 184,224" fill="none" stroke="black"></path>
                  <path d="M 200,224 L 248,224" fill="none" stroke="black"></path>
                  <path d="M 264,224 L 320,224" fill="none" stroke="black"></path>
                  <path d="M 336,224 L 400,224" fill="none" stroke="black"></path>
                  <path d="M 8,256 L 56,256" fill="none" stroke="black"></path>
                  <path d="M 72,256 L 120,256" fill="none" stroke="black"></path>
                  <path d="M 136,256 L 184,256" fill="none" stroke="black"></path>
                  <path d="M 200,256 L 248,256" fill="none" stroke="black"></path>
                  <path d="M 264,256 L 320,256" fill="none" stroke="black"></path>
                  <path d="M 336,256 L 400,256" fill="none" stroke="black"></path>
                  <path d="M 8,286 L 24,286" fill="none" stroke="black"></path>
                  <path d="M 8,290 L 24,290" fill="none" stroke="black"></path>
                  <path d="M 40,286 L 56,286" fill="none" stroke="black"></path>
                  <path d="M 40,290 L 56,290" fill="none" stroke="black"></path>
                  <path d="M 72,286 L 88,286" fill="none" stroke="black"></path>
                  <path d="M 72,290 L 88,290" fill="none" stroke="black"></path>
                  <path d="M 104,286 L 120,286" fill="none" stroke="black"></path>
                  <path d="M 104,290 L 120,290" fill="none" stroke="black"></path>
                  <path d="M 136,286 L 152,286" fill="none" stroke="black"></path>
                  <path d="M 136,290 L 152,290" fill="none" stroke="black"></path>
                  <path d="M 168,286 L 184,286" fill="none" stroke="black"></path>
                  <path d="M 168,290 L 184,290" fill="none" stroke="black"></path>
                  <path d="M 200,286 L 216,286" fill="none" stroke="black"></path>
                  <path d="M 200,290 L 216,290" fill="none" stroke="black"></path>
                  <path d="M 232,286 L 248,286" fill="none" stroke="black"></path>
                  <path d="M 232,290 L 248,290" fill="none" stroke="black"></path>
                  <path d="M 264,286 L 280,286" fill="none" stroke="black"></path>
                  <path d="M 264,290 L 280,290" fill="none" stroke="black"></path>
                  <path d="M 296,286 L 312,286" fill="none" stroke="black"></path>
                  <path d="M 296,290 L 312,290" fill="none" stroke="black"></path>
                  <path d="M 328,286 L 352,286" fill="none" stroke="black"></path>
                  <path d="M 328,290 L 352,290" fill="none" stroke="black"></path>
                  <path d="M 368,286 L 392,286" fill="none" stroke="black"></path>
                  <path d="M 368,290 L 392,290" fill="none" stroke="black"></path>
                  <path d="M 408,286 L 432,286" fill="none" stroke="black"></path>
                  <path d="M 408,290 L 432,290" fill="none" stroke="black"></path>
                  <path d="M 8,318 L 24,318" fill="none" stroke="black"></path>
                  <path d="M 8,322 L 24,322" fill="none" stroke="black"></path>
                  <path d="M 40,318 L 56,318" fill="none" stroke="black"></path>
                  <path d="M 40,322 L 56,322" fill="none" stroke="black"></path>
                  <path d="M 72,318 L 88,318" fill="none" stroke="black"></path>
                  <path d="M 72,322 L 88,322" fill="none" stroke="black"></path>
                  <path d="M 104,318 L 120,318" fill="none" stroke="black"></path>
                  <path d="M 104,322 L 120,322" fill="none" stroke="black"></path>
                  <path d="M 136,318 L 152,318" fill="none" stroke="black"></path>
                  <path d="M 136,322 L 152,322" fill="none" stroke="black"></path>
                  <path d="M 168,318 L 184,318" fill="none" stroke="black"></path>
                  <path d="M 168,322 L 184,322" fill="none" stroke="black"></path>
                  <path d="M 200,318 L 216,318" fill="none" stroke="black"></path>
                  <path d="M 200,322 L 216,322" fill="none" stroke="black"></path>
                  <path d="M 232,318 L 248,318" fill="none" stroke="black"></path>
                  <path d="M 232,322 L 248,322" fill="none" stroke="black"></path>
                  <path d="M 264,318 L 280,318" fill="none" stroke="black"></path>
                  <path d="M 264,322 L 280,322" fill="none" stroke="black"></path>
                  <path d="M 296,318 L 312,318" fill="none" stroke="black"></path>
                  <path d="M 296,322 L 312,322" fill="none" stroke="black"></path>
                  <path d="M 328,318 L 352,318" fill="none" stroke="black"></path>
                  <path d="M 328,322 L 352,322" fill="none" stroke="black"></path>
                  <path d="M 368,318 L 392,318" fill="none" stroke="black"></path>
                  <path d="M 368,322 L 392,322" fill="none" stroke="black"></path>
                  <path d="M 408,318 L 432,318" fill="none" stroke="black"></path>
                  <path d="M 408,322 L 432,322" fill="none" stroke="black"></path>
                  <path d="M 136,368 L 376,368" fill="none" stroke="black"></path>
                  <path d="M 136,400 L 376,400" fill="none" stroke="black"></path>
                  <path d="M 64,432 L 200,432" fill="none" stroke="black"></path>
                  <path d="M 312,432 L 448,432" fill="none" stroke="black"></path>
                  <path d="M 64,464 L 200,464" fill="none" stroke="black"></path>
                  <path d="M 312,464 L 448,464" fill="none" stroke="black"></path>
                  <path d="M 32,496 L 104,496" fill="none" stroke="black"></path>
                  <path d="M 160,496 L 232,496" fill="none" stroke="black"></path>
                  <path d="M 288,496 L 368,496" fill="none" stroke="black"></path>
                  <path d="M 32,528 L 104,528" fill="none" stroke="black"></path>
                  <path d="M 160,528 L 232,528" fill="none" stroke="black"></path>
                  <path d="M 288,528 L 368,528" fill="none" stroke="black"></path>
                  <path d="M 136,560 L 184,560" fill="none" stroke="black"></path>
                  <path d="M 200,560 L 248,560" fill="none" stroke="black"></path>
                  <path d="M 264,560 L 320,560" fill="none" stroke="black"></path>
                  <path d="M 336,560 L 400,560" fill="none" stroke="black"></path>
                  <path d="M 136,592 L 184,592" fill="none" stroke="black"></path>
                  <path d="M 200,592 L 248,592" fill="none" stroke="black"></path>
                  <path d="M 264,592 L 320,592" fill="none" stroke="black"></path>
                  <path d="M 336,592 L 400,592" fill="none" stroke="black"></path>
                  <path d="M 200,624 L 216,624" fill="none" stroke="black"></path>
                  <path d="M 232,622 L 248,622" fill="none" stroke="black"></path>
                  <path d="M 232,626 L 248,626" fill="none" stroke="black"></path>
                  <path d="M 264,622 L 280,622" fill="none" stroke="black"></path>
                  <path d="M 264,626 L 280,626" fill="none" stroke="black"></path>
                  <path d="M 296,622 L 312,622" fill="none" stroke="black"></path>
                  <path d="M 296,626 L 312,626" fill="none" stroke="black"></path>
                  <path d="M 328,622 L 352,622" fill="none" stroke="black"></path>
                  <path d="M 328,626 L 352,626" fill="none" stroke="black"></path>
                  <path d="M 368,622 L 392,622" fill="none" stroke="black"></path>
                  <path d="M 368,626 L 392,626" fill="none" stroke="black"></path>
                  <path d="M 408,622 L 432,622" fill="none" stroke="black"></path>
                  <path d="M 408,626 L 432,626" fill="none" stroke="black"></path>
                  <path d="M 200,656 L 216,656" fill="none" stroke="black"></path>
                  <path d="M 232,654 L 248,654" fill="none" stroke="black"></path>
                  <path d="M 232,658 L 248,658" fill="none" stroke="black"></path>
                  <path d="M 264,654 L 280,654" fill="none" stroke="black"></path>
                  <path d="M 264,658 L 280,658" fill="none" stroke="black"></path>
                  <path d="M 296,654 L 312,654" fill="none" stroke="black"></path>
                  <path d="M 296,658 L 312,658" fill="none" stroke="black"></path>
                  <path d="M 328,654 L 352,654" fill="none" stroke="black"></path>
                  <path d="M 328,658 L 352,658" fill="none" stroke="black"></path>
                  <path d="M 368,654 L 392,654" fill="none" stroke="black"></path>
                  <path d="M 368,658 L 392,658" fill="none" stroke="black"></path>
                  <path d="M 408,654 L 432,654" fill="none" stroke="black"></path>
                  <path d="M 408,658 L 432,658" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="248" y="52">[0,</text>
                    <text x="280" y="52">13)</text>
                    <text x="160" y="84">/</text>
                    <text x="352" y="84">\</text>
                    <text x="120" y="116">[0,</text>
                    <text x="148" y="116">8)</text>
                    <text x="368" y="116">[8,</text>
                    <text x="400" y="116">13)</text>
                    <text x="72" y="148">/</text>
                    <text x="192" y="148">\</text>
                    <text x="336" y="148">/</text>
                    <text x="56" y="180">[0,</text>
                    <text x="84" y="180">4)</text>
                    <text x="184" y="180">[4,</text>
                    <text x="212" y="180">8)</text>
                    <text x="312" y="180">[8,</text>
                    <text x="344" y="180">12)</text>
                    <text x="40" y="212">/</text>
                    <text x="96" y="212">\</text>
                    <text x="168" y="212">/</text>
                    <text x="224" y="212">\</text>
                    <text x="304" y="212">/</text>
                    <text x="360" y="212">\</text>
                    <text x="32" y="244">[0,2)</text>
                    <text x="96" y="244">[2,4)</text>
                    <text x="160" y="244">[4,6)</text>
                    <text x="224" y="244">[6,8)</text>
                    <text x="292" y="244">[8,10)</text>
                    <text x="368" y="244">[10,12)</text>
                    <text x="24" y="276">/</text>
                    <text x="40" y="276">\</text>
                    <text x="88" y="276">/</text>
                    <text x="104" y="276">\</text>
                    <text x="152" y="276">/</text>
                    <text x="168" y="276">\</text>
                    <text x="216" y="276">/</text>
                    <text x="232" y="276">\</text>
                    <text x="280" y="276">/</text>
                    <text x="296" y="276">\</text>
                    <text x="352" y="276">/</text>
                    <text x="368" y="276">\</text>
                    <text x="16" y="308">0</text>
                    <text x="48" y="308">1</text>
                    <text x="80" y="308">2</text>
                    <text x="112" y="308">3</text>
                    <text x="144" y="308">4</text>
                    <text x="176" y="308">5</text>
                    <text x="208" y="308">6</text>
                    <text x="240" y="308">7</text>
                    <text x="272" y="308">8</text>
                    <text x="304" y="308">9</text>
                    <text x="340" y="308">10</text>
                    <text x="380" y="308">11</text>
                    <text x="420" y="308">12</text>
                    <text x="248" y="388">[0,</text>
                    <text x="280" y="388">13)</text>
                    <text x="160" y="420">/</text>
                    <text x="352" y="420">\</text>
                    <text x="120" y="452">[0,</text>
                    <text x="148" y="452">8)</text>
                    <text x="368" y="452">[8,</text>
                    <text x="400" y="452">13)</text>
                    <text x="72" y="484">/</text>
                    <text x="192" y="484">\</text>
                    <text x="336" y="484">/</text>
                    <text x="56" y="516">[0,</text>
                    <text x="84" y="516">4)</text>
                    <text x="184" y="516">[4,</text>
                    <text x="212" y="516">8)</text>
                    <text x="312" y="516">[8,</text>
                    <text x="344" y="516">12)</text>
                    <text x="168" y="548">/</text>
                    <text x="224" y="548">\</text>
                    <text x="304" y="548">/</text>
                    <text x="360" y="548">\</text>
                    <text x="160" y="580">[4,6)</text>
                    <text x="224" y="580">[6,8)</text>
                    <text x="292" y="580">[8,10)</text>
                    <text x="368" y="580">[10,12)</text>
                    <text x="216" y="612">/</text>
                    <text x="232" y="612">\</text>
                    <text x="280" y="612">/</text>
                    <text x="296" y="612">\</text>
                    <text x="352" y="612">/</text>
                    <text x="368" y="612">\</text>
                    <text x="208" y="644">6</text>
                    <text x="240" y="644">7</text>
                    <text x="272" y="644">8</text>
                    <text x="304" y="644">9</text>
                    <text x="340" y="644">10</text>
                    <text x="380" y="644">11</text>
                    <text x="420" y="644">12</text>
                  </g>
                </svg><a href="#section-5.6.1-9.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-an-example-showing-the-mini" class="selfRef">An example showing the minimum nodes that must be available after pruning</a>
            </figcaption></figure>
</div>
<p id="section-5.6.1-10">Logs MAY retain additional nodes, or expect log clients to compute required nodes from other nodes. For example, in <a href="#fig-prune-tree" class="auto internal xref">Figure 5</a>, the log's serving protocol MAY instead serve <code>[0, 2)</code> and <code>[2, 4)</code>, with the log client computing <code>[0, 4)</code> from those values.<a href="#section-5.6.1-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="certificates">
<section id="section-6">
      <h2 id="name-certificates">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-certificates" class="section-name selfRef">Certificates</a>
      </h2>
<p id="section-6-1">This section defines how to construct Merkle Tree Certificates, which are X.509 Certificates <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> that assert the information in an issuance log entry. A Merkle Tree Certificate is constructed from the following:<a href="#section-6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-2.1">
          <p id="section-6-2.1.1">A TBSCertificateLogEntry (<a href="#log-entries" class="auto internal xref">Section 5.3</a>) contained in the issuance log (<a href="#issuance-logs" class="auto internal xref">Section 5</a>)<a href="#section-6-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-2.2">
          <p id="section-6-2.2.1">A subject public key whose hash matches the TBSCertificateLogEntry<a href="#section-6-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-2.3">
          <p id="section-6-2.3.1">A subtree (<a href="#subtrees" class="auto internal xref">Section 4</a>) that contains the log entry<a href="#section-6-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-2.4">
          <p id="section-6-2.4.1">Zero or more signatures (<a href="#cosigners" class="auto internal xref">Section 5.4</a>) over the subtree, which together satisfy relying party requirements (<a href="#trusted-cosigners" class="auto internal xref">Section 7.3</a>)<a href="#section-6-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-6-3">For any given TBSCertificateLogEntry, there are multiple possible certificates that may prove the entry is certified by the CA and publicly logged, varying by choice of subtree and signatures. <a href="#certificate-format" class="auto internal xref">Section 6.1</a> defines how the certificate is constructed based on those choices. <a href="#full-certificates" class="auto internal xref">Section 6.2</a> and <a href="#signatureless-certificates" class="auto internal xref">Section 6.3</a> define two profiles of Merkle Tree Certificates, full certificates and signatureless certificates, and how to select the subtree and signatures for them.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="certificate-format">
<section id="section-6.1">
        <h3 id="name-certificate-format">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-certificate-format" class="section-name selfRef">Certificate Format</a>
        </h3>
<p id="section-6.1-1">The information is encoded in an X.509 Certificate <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> as follows:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The TBSCertificate's <code>version</code>, <code>issuer</code>, <code>validity</code>, <code>subject</code>, <code>issuerUniqueID</code>, <code>subjectUniqueID</code>, and <code>extensions</code> MUST match the corresponding fields of the TBSCertificateLogEntry. Per <a href="#log-entries" class="auto internal xref">Section 5.3</a>, this means <code>issuer</code> MUST be the issuance log's log ID as an X.509 distinguished name, as described in <a href="#log-ids" class="auto internal xref">Section 5.2</a>.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">The TBSCertificate's <code>serialNumber</code> MUST contain the zero-based index of the TBSCertificateLogEntry in the log. <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.1.2.2" class="relref">Section 4.1.2.2</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> forbids zero as a serial number, but <a href="#log-entries" class="auto internal xref">Section 5.3</a> defines a <code>null_entry</code> type for use in entry zero, so the index will be positive. This encoding is intended to avoid implementation errors by having the serial numbers and indices off by one.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">The TBSCertificate's <code>subjectPublicKeyInfo</code> contains the specified public key. Its hash MUST match the TBSCertificateLogEntry's <code>subjectPublicKeyInfoHash</code>.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">The TBSCertificate's <code>signature</code> and the Certificate's <code>signatureAlgorithm</code> MUST contain an AlgorithmIdentifier whose <code>algorithm</code> is id-alg-mtcProof, defined below, and whose <code>parameters</code> is omitted.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-6.1-6">
<pre>
id-alg-mtcProof OBJECT IDENTIFIER ::= {
    iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) algorithms(6) TBD}
</pre><a href="#section-6.1-6" class="pilcrow">¶</a>
</div>
<p id="section-6.1-7">For initial experimentation, early implementations of this design will use the OID 1.3.6.1.4.1.44363.47.0 instead of <code>id-alg-mtcProof</code>.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<p id="section-6.1-8">The <code>signatureValue</code> contains an MTCProof structure, defined below using the TLS presentation language (<span><a href="https://rfc-editor.org/rfc/rfc8446#section-3" class="relref">Section 3</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>):<a href="#section-6.1-8" class="pilcrow">¶</a></p>
<div class="lang-tls-presentation sourcecode" id="section-6.1-9">
<pre>
opaque HashValue[HASH_SIZE];

struct {
    TrustAnchorID cosigner_id;
    opaque signature&lt;0..2^16-1&gt;;
} MTCSignature;

struct {
    uint64 start;
    uint64 end;
    HashValue inclusion_proof&lt;0..2^16-1&gt;;
    MTCSignature signatures&lt;0..2^16-1&gt;;
} MTCProof;
</pre><a href="#section-6.1-9" class="pilcrow">¶</a>
</div>
<p id="section-6.1-10"><code>start</code> and <code>end</code> MUST contain the corresponding parameters of the chosen subtree. <code>inclusion_proof</code> MUST contain a subtree inclusion proof (<a href="#subtree-inclusion-proofs" class="auto internal xref">Section 4.2</a>) for the log entry and the subtree. <code>signatures</code> contains the chosen subtree signatures. In each signature, <code>cosigner_id</code> contains the cosigner ID (<a href="#cosigners" class="auto internal xref">Section 5.4</a>) in its binary representation (<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-trust-anchor-ids-02#section-3" class="relref">Section 3</a> of [<a href="#I-D.ietf-tls-trust-anchor-ids" class="cite xref">I-D.ietf-tls-trust-anchor-ids</a>]</span>), and <code>signature</code> contains the signature value as described in <a href="#signature-format" class="auto internal xref">Section 5.4.1</a>.<a href="#section-6.1-10" class="pilcrow">¶</a></p>
<p id="section-6.1-11">The MTCProof is encoded into the <code>signatureValue</code> with no additional ASN.1 wrapping. The most significant bit of the first octet of the signature value SHALL become the first bit of the bit string, and so on through the least significant bit of the last octet of the signature value, which SHALL become the last bit of the bit string.<a href="#section-6.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="full-certificates">
<section id="section-6.2">
        <h3 id="name-full-certificates">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-full-certificates" class="section-name selfRef">Full Certificates</a>
        </h3>
<p id="section-6.2-1">A <em>full certificate</em> is a Merkle Tree certificate which contains sufficient signatures to allow a relying party to trust the choice of subtree, without any predistributed information beyond the cosigner(s) parameters. Full certificates can be issued without significant processing delay.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">When issuing a certificate, the CA first adds the TBSCertificateLogEntry to its issuance log. It then schedules a job to construct a checkpoint and collect cosignatures. The job proceeds as follows:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-3">
<li id="section-6.2-3.1">
            <p id="section-6.2-3.1.1">The CA signs the checkpoint with its key(s) (<a href="#certification-authority-cosigners" class="auto internal xref">Section 5.5</a>).<a href="#section-6.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-3.2">
            <p id="section-6.2-3.2.1">Using the procedure in <a href="#arbitrary-intervals" class="auto internal xref">Section 4.4</a>, the CA determines the two subtrees that cover the entries added between this checkpoint and the most recent checkpoint.<a href="#section-6.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-3.3">
            <p id="section-6.2-3.3.1">The CA signs each subtree with its key(s) (<a href="#cosigners" class="auto internal xref">Section 5.4</a>).<a href="#section-6.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-3.4">
            <p id="section-6.2-3.4.1">The CA requests sufficient checkpoint cosignatures (<a href="#cosigners" class="auto internal xref">Section 5.4</a>) from external cosigners to meet relying party requirements (<a href="#trusted-cosigners" class="auto internal xref">Section 7.3</a>).<a href="#section-6.2-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-3.5">
            <p id="section-6.2-3.5.1">The CA requests subtree cosignatures (<a href="#requesting-subtree-signatures" class="auto internal xref">Appendix B.2</a>) from the cosigners above.<a href="#section-6.2-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-3.6">
            <p id="section-6.2-3.6.1">For each certificate in the interval, the CA constructs certificates (<a href="#certificate-format" class="auto internal xref">Section 6.1</a>) using the covering subtree.<a href="#section-6.2-3.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-6.2-4">Steps 4 and 5 are analogous to requesting SCTs from CT logs in Certificate Transparency, except that a single run of this job collects signatures for many certificates at once. The CA MAY request signatures from a redundant set of cosigners and select the ones that complete first.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">This document does not prescribe the specific cosigner roles, or a particular protocol for requesting cosignatures. Protocols for cosigners MAY vary depending on the needs for that cosigner. A consistency-only cosigner, such as <span>[<a href="#TLOG-WITNESS" class="cite xref">TLOG-WITNESS</a>]</span>, might only require a checkpoint signature and consistency proof, while a mirroring cosigner, such as <span>[<a href="#TLOG-MIRROR" class="cite xref">TLOG-MIRROR</a>]</span> might require the full log contents.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">A cosigner MAY expose a private interface for the CA, to reduce denial-of-service risk, or a cosigner MAY expose a public interface for other parties to request additional cosignatures. The latter may be useful if a relying party requires a cosigner that the CA does not communicate with. In this case, an authenticating party MAY request cosignatures and add them to the certificate. However, it is RECOMMENDED that the CA collect cosignatures for the authenticating party. This simplifies deployment, as relying party policies change over time.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<p id="section-6.2-7">This document does not place any requirements on how frequently this job runs. More frequent runs results in lower issuance delay, but higher signing overhead. It is RECOMMENDED that CAs run at most one instance of this job at a time, starting the next instance after the previous one completes. A single run collects signatures for all entries since the most recent checkpoint, so there is little benefit to overlapping them. Less frequent runs may also aid relying parties that wish to directly audit signatures, as described in Section 5.2 of <span>[<a href="#AuditingRevisited" class="cite xref">AuditingRevisited</a>]</span>, though this document does not define such a system.<a href="#section-6.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signatureless-certificates">
<section id="section-6.3">
        <h3 id="name-signatureless-certificates">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-signatureless-certificates" class="section-name selfRef">Signatureless Certificates</a>
        </h3>
<p id="section-6.3-1">A <em>signatureless certificate</em> is a Merkle Tree certificate which contains no signatures and instead assumes the relying party had predistributed information about which subtrees were trusted. Signatureless certificates are an optional size optimization. They require a processing delay to construct, and only work in a sufficiently up-to-date relying party. Authenticating parties thus SHOULD deploy a corresponding full certificate alongside any signatureless certificate, and use some application-protocol-specific mechanism to select between the two. <a href="#use-in-tls" class="auto internal xref">Section 8</a> discusses such a mechanism for TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<div id="landmarks">
<section id="section-6.3.1">
          <h4 id="name-landmarks">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-landmarks" class="section-name selfRef">Landmarks</a>
          </h4>
<p id="section-6.3.1-1">A signatureless certificate is constructed based on a <em>landmark sequence</em>, which is a sequence of <em>landmarks</em>. Landmarks are agreed-upon tree sizes across the ecosystem for optimizing certificates. Landmarks SHOULD be allocated by the CA, but they can also be allocated by some other coordinating party. It is possible, but NOT RECOMMENDED, for multiple landmark sequences to exist per CA. Landmarks are allocated to balance minimizing the delay in obtaining a signatureless certificate with minimizing the size of the relying party's predistributed state.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
<p id="section-6.3.1-2">A landmark sequence has the following fixed parameters:<a href="#section-6.3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3.1-3.1">
              <p id="section-6.3.1-3.1.1"><code>base_id</code>: An OID arc for trust anchor IDs of individual landmarks<a href="#section-6.3.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.3.1-3.2">
              <p id="section-6.3.1-3.2.1"><code>max_landmarks</code>: A positive integer, describing the maximum number of landmarks that may contain unexpired certificates at any time<a href="#section-6.3.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.3.1-3.3">
              <p id="section-6.3.1-3.3.1"><code>landmark_url</code>: Some URL to fetch the current list of landmarks<a href="#section-6.3.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.3.1-4">Landmarks are numbered consecutively from zero. Each landmark has a trust anchor ID, determined by appending the landmark number to <code>base_id</code>. For example, the trust anchor ID for landmark 42 of a sequence with <code>base_id</code> of <code>32473.1</code> would be <code>32473.1.42</code>.<a href="#section-6.3.1-4" class="pilcrow">¶</a></p>
<p id="section-6.3.1-5">Each landmark specifies a tree size. The first landmark, numbered zero, is always a tree size of zero. The sequence of tree sizes MUST be append-only and monotonically increasing.<a href="#section-6.3.1-5" class="pilcrow">¶</a></p>
<p id="section-6.3.1-6">Landmarks determine <em>landmark subtrees</em>: for each landmark, other than number zero, let <code>tree_size</code> be the landmark's tree size and <code>prev_tree_size</code> be that of the previous landmark. As described in <a href="#arbitrary-intervals" class="auto internal xref">Section 4.4</a>, select the one or two subtrees that cover <code>[prev_tree_size, tree_size)</code>. Each of those subtrees is a landmark subtree. Landmark zero has no landmark subtrees.<a href="#section-6.3.1-6" class="pilcrow">¶</a></p>
<p id="section-6.3.1-7">The most recent <code>max_landmarks</code> landmarks are said to be <em>active</em>. Landmarks MUST be allocated such that, at any given time, only active landmarks contain unexpired certificates. The active landmark subtrees are those determined by the active landmarks. There are at most <code>2 * max_landmarks</code> active landmark subtrees at any time. Every unexpired entry will be contained in one or more landmark subtree, or between the last landmark subtree and the latest checkpoint. Active landmark subtrees are predistributed to the relying party as trusted subtrees, as described in <a href="#trusted-subtrees" class="auto internal xref">Section 7.4</a>.<a href="#section-6.3.1-7" class="pilcrow">¶</a></p>
<p id="section-6.3.1-8">It is RECOMMENDED that landmarks be allocated following the procedure described in <a href="#allocating-landmarks" class="auto internal xref">Section 6.3.2</a>. If landmarks are allocated incorrectly (e.g. past landmarks change, or <code>max_landmarks</code> is inaccurate), there are no security consequences, but some older certificates may fail to validate.<a href="#section-6.3.1-8" class="pilcrow">¶</a></p>
<p id="section-6.3.1-9">Relying parties will locally retain up to <code>2 * max_landmarks</code> hashes (<a href="#trusted-subtrees" class="auto internal xref">Section 7.4</a>) per CA, so <code>max_landmarks</code> should be set to balance the delay between landmarks and the amount of state the relying party must maintain. Using the recommended procedure above, a CA with a maximum certificate lifetime of 7 days, allocating a landmark every hour, will have a <code>max_landmarks</code> of 168. The client state is then 336 hashes, or 10,752 bytes with SHA-256.<a href="#section-6.3.1-9" class="pilcrow">¶</a></p>
<p id="section-6.3.1-10"><code>landmark_url</code> MUST serve a resource with <code>Content-Type: text/plain; charset=utf-8</code> and the following lines. Each line MUST be terminated by a newline character (U+000A):<a href="#section-6.3.1-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3.1-11.1">
              <p id="section-6.3.1-11.1.1">Two space-separated non-negative decimal integers: <code>&lt;last_landmark&gt; &lt;num_active_landmarks&gt;</code>.
This line MUST satisfy the following, otherwise it is invalid:<a href="#section-6.3.1-11.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3.1-11.1.2.1">
                  <p id="section-6.3.1-11.1.2.1.1"><code>num_active_landmarks &lt;= max_landmarks</code><a href="#section-6.3.1-11.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-6.3.1-11.1.2.2">
                  <p id="section-6.3.1-11.1.2.2.1"><code>num_active_landmarks &lt;= last_landmark</code><a href="#section-6.3.1-11.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-6.3.1-11.2">
              <p id="section-6.3.1-11.2.1"><code>num_active_landmarks + 1</code> lines each containing a single non-negative decimal integer, containing a tree size. Numbered from zero to <code>num_active_landmarks</code>, line <code>i</code> contains the tree size for landmark <code>last_landmark - i</code>. The integers MUST be monotonically decreasing and lower or equal to the log's latest tree size.<a href="#section-6.3.1-11.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="allocating-landmarks">
<section id="section-6.3.2">
          <h4 id="name-allocating-landmarks">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-allocating-landmarks" class="section-name selfRef">Allocating Landmarks</a>
          </h4>
<p id="section-6.3.2-1">It is RECOMMENDED that landmarks be allocated using the following procedure:<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3.2-2">
<li id="section-6.3.2-2.1">
              <p id="section-6.3.2-2.1.1">Select some <code>time_between_landmarks</code> duration. Define a series of consecutive, non-overlapping time intervals, each of duration <code>time_between_landmarks</code>.<a href="#section-6.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.3.2-2.2">
              <p id="section-6.3.2-2.2.1">At most once per time interval, append the latest checkpoint tree size to the landmark sequence if it is greater than the last landmark's tree size.<a href="#section-6.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-6.3.2-3">To ensure that only active landmarks contain unexpired certificates, set <code>max_landmarks</code> to <code>ceil(max_cert_lifetime / time_between_landmarks) + 1</code>, where <code>max_cert_lifetime</code> is the CA's maximum certificate lifetime.<a href="#section-6.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="constructing-signatureless-certificates">
<section id="section-6.3.3">
          <h4 id="name-constructing-signatureless-">
<a href="#section-6.3.3" class="section-number selfRef">6.3.3. </a><a href="#name-constructing-signatureless-" class="section-name selfRef">Constructing Signatureless Certificates</a>
          </h4>
<p id="section-6.3.3-1">Given a TBSCertificateLogEntry in the issuance log and a landmark sequence, a signatureless certificate is constructed as follows:<a href="#section-6.3.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3.3-2">
<li id="section-6.3.3-2.1">
              <p id="section-6.3.3-2.1.1">Wait for the first landmark to be allocated that contains the entry.<a href="#section-6.3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.3.3-2.2">
              <p id="section-6.3.3-2.2.1">Determine the landmark's subtrees and select the one that contains the entry.<a href="#section-6.3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.3.3-2.3">
              <p id="section-6.3.3-2.3.1">Construct a certificate (<a href="#certificate-format" class="auto internal xref">Section 6.1</a>) using the selected subtree and no signatures.<a href="#section-6.3.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-6.3.3-3">Before sending this certificate, the authenticating party SHOULD obtain some application-protocol-specific signal that implies the relying party has been configured with the corresponding landmark. (<a href="#trusted-subtrees" class="auto internal xref">Section 7.4</a> defines how relying parties are configured.) The trust anchor ID of the landmark may be used as an efficient identifier in the application protocol. <a href="#use-in-tls" class="auto internal xref">Section 8</a> discusses how to do this in TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.<a href="#section-6.3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="size-estimates">
<section id="section-6.4">
        <h3 id="name-size-estimates">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-size-estimates" class="section-name selfRef">Size Estimates</a>
        </h3>
<p id="section-6.4-1">The inclusion proofs in full and signatureless certificates scale logarithmically with the size of the subtree. These sizes can be estimated with the CA's issuance rate. The byte counts below assume the issuance log's hash function is SHA-256.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">Some organizations have published statistics which can be used to estimate this rate for the Web PKI. As of June 9th, 2025:<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-3.1">
            <p id="section-6.4-3.1.1"><span>[<a href="#LetsEncrypt" class="cite xref">LetsEncrypt</a>]</span> reported around 558,000,000 active certificates for a single CA<a href="#section-6.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-3.2">
            <p id="section-6.4-3.2.1"><span>[<a href="#MerkleTown" class="cite xref">MerkleTown</a>]</span> reported around 2,100,000,000 unexpired certificates in CT logs, across all CAs<a href="#section-6.4-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-3.3">
            <p id="section-6.4-3.3.1"><span>[<a href="#MerkleTown" class="cite xref">MerkleTown</a>]</span> reported an issuance rate of around 444,000 certificates per hour, across all CAs<a href="#section-6.4-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.4-4">The current issuance rate across the Web PKI may not necessarily be representative of the Web PKI after a transition to short-lived certificates. Assuming a certificate lifetime of 7 days, and that subscribers will update their certificates 75% of the way through their lifetime (see <a href="#certificate-renewal" class="auto internal xref">Section 10.4</a>), every certificate will be reissued every 126 hours. This gives issuance rate estimates of around 4,400,000 certificates per hour and 17,000,000 certificates per hour, for the first two values above. Note the larger estimate is across all CAs, while subtrees would only span one CA.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<p id="section-6.4-5">Using the per-CA short lifetime estimate, if the CA mints a checkpoint every 2 seconds, full certificate subtrees will span around 2,500 certificates, leading to 12 hashes in the inclusion proof, or 384 bytes. Full certificates additionally must carry a sufficient set of signatures to meet relying party requirements.<a href="#section-6.4-5" class="pilcrow">¶</a></p>
<p id="section-6.4-6">If a new landmark is allocated every hour, signatureless certificate subtrees will span around 4,400,000 certificates, leading to 23 hashes in the inclusion proof, giving an inclusion proof size of 736 bytes, with no signatures. This is significantly smaller than a single ML-DSA-44 signature, 2,420 bytes, and almost ten times smaller than the three ML-DSA-44 signatures necessary to include post-quantum SCTs.<a href="#section-6.4-6" class="pilcrow">¶</a></p>
<p id="section-6.4-7">The proof sizes grow logarithmically, so 32 hashes, or 1024 bytes, is sufficient for subtrees of up to 2^32 (4,294,967,296) certificates.<a href="#section-6.4-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="relying-parties">
<section id="section-7">
      <h2 id="name-relying-parties">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-relying-parties" class="section-name selfRef">Relying Parties</a>
      </h2>
<p id="section-7-1">This section discusses how relying parties verify Merkle Tree Certificates.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="trust-anchors">
<section id="section-7.1">
        <h3 id="name-trust-anchors">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-trust-anchors" class="section-name selfRef">Trust Anchors</a>
        </h3>
<p id="section-7.1-1">In order to accept certificates from a Merkle Tree CA, a relying party MUST be configured with:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.1">
            <p id="section-7.1-2.1.1">The log ID (<a href="#log-ids" class="auto internal xref">Section 5.2</a>)<a href="#section-7.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.2">
            <p id="section-7.1-2.2.1">A set of supported cosigners, as pairs of cosigner ID and public key<a href="#section-7.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.3">
            <p id="section-7.1-2.3.1">A policy on which combinations of cosigners to accept in a certificate (<a href="#trusted-cosigners" class="auto internal xref">Section 7.3</a>)<a href="#section-7.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.4">
            <p id="section-7.1-2.4.1">An optional list of trusted subtrees, with their hashes, that are known to be consistent with the relying party's cosigner requirements (<a href="#trusted-subtrees" class="auto internal xref">Section 7.4</a>)<a href="#section-7.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.5">
            <p id="section-7.1-2.5.1">A list of revoked ranges of indices (<a href="#revocation-by-index" class="auto internal xref">Section 7.5</a>)<a href="#section-7.1-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.1-3">[[TODO: Define some representation for this. In a trust anchor, there's a lot of room for flexibility in what the client stores. In principle, we could even encode some of this information in an X.509 intermediate certificate, if an application wishes to use this with a delegation model with intermediates, though the security story becomes more complex. Decide how/whether to do that.]]<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verifying-certificate-signatures">
<section id="section-7.2">
        <h3 id="name-verifying-certificate-signa">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-verifying-certificate-signa" class="section-name selfRef">Verifying Certificate Signatures</a>
        </h3>
<p id="section-7.2-1">When verifying the signature on an X.509 certificate (Step (a)(1) of <span><a href="https://rfc-editor.org/rfc/rfc5280#section-6.1.3" class="relref">Section 6.1.3</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>) whose issuer is a Merkle Tree CA, the relying party performs the following procedure:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.2-2">
<li id="section-7.2-2.1">
            <p id="section-7.2-2.1.1">Check that the TBSCertificate's <code>signature</code> field is <code>id-alg-mtcProof</code> with omitted parameters. If either check fails, abort this process and fail verification.<a href="#section-7.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-2.2">
            <p id="section-7.2-2.2.1">Decode the <code>signatureValue</code> as an MTCProof, as described in <a href="#certificate-format" class="auto internal xref">Section 6.1</a>.<a href="#section-7.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-2.3">
            <p id="section-7.2-2.3.1">Let <code>index</code> be the certificate's serial number. If <code>index</code> is contained in one of the relying party's revoked ranges (<a href="#revocation-by-index" class="auto internal xref">Section 7.5</a>), abort this process and fail verification.<a href="#section-7.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-2.4">
            <p id="section-7.2-2.4.1">Construct a TBSCertificateLogEntry as follows:<a href="#section-7.2-2.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.2-2.4.2">
<li id="section-7.2-2.4.2.1">
                <p id="section-7.2-2.4.2.1.1">Copy the <code>version</code>, <code>issuer</code>, <code>validity</code>, <code>subject</code>, <code>issuerUniqueID</code>, <code>subjectUniqueID</code>, and <code>extensions</code> fields from the TBSCertificate.<a href="#section-7.2-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-7.2-2.4.2.2">
                <p id="section-7.2-2.4.2.2.1">Set <code>subjectPublicKeyInfoHash</code> to the hash of the DER encoding of <code>subjectPublicKeyInfo</code>.<a href="#section-7.2-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</li>
          <li id="section-7.2-2.5">
            <p id="section-7.2-2.5.1">Construct a MerkleTreeCertEntry of type <code>tbs_cert_entry</code> with contents the TBSCertificateLogEntry. Let <code>entry_hash</code> be the hash of the entry, <code>MTH({entry}) = HASH(0x00 || entry)</code>, as defined in <span><a href="https://rfc-editor.org/rfc/rfc9162#section-2.1.1" class="relref">Section 2.1.1</a> of [<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>.<a href="#section-7.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-2.6">
            <p id="section-7.2-2.6.1">Let <code>expected_subtree_hash</code> be the result of evaluating the MTCProof's <code>inclusion_proof</code> for entry <code>index</code>, with hash <code>entry_hash</code>, of the subtree described by the MTCProof's <code>start</code> and <code>end</code>, following the procedure in <a href="#evaluating-a-subtree-inclusion-proof" class="auto internal xref">Section 4.2.1</a>. If evaluation fails, abort this process and fail verification.<a href="#section-7.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-2.7">
            <p id="section-7.2-2.7.1">If <code>[start, end)</code> matches a trusted subtree (<a href="#trusted-subtrees" class="auto internal xref">Section 7.4</a>), check that <code>expected_subtree_hash</code> is equal to the trusted subtree's hash. Return success if it matches and failure if it does not.<a href="#section-7.2-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-7.2-2.8">
            <p id="section-7.2-2.8.1">Otherwise, check that the MTCProof's <code>signatures</code> contain a sufficient set of valid signatures from cosigners to satisfy the relying party's cosigner requirements (<a href="#trusted-cosigners" class="auto internal xref">Section 7.3</a>). Unrecognized cosigners MUST be ignored. Signatures are verified as described in <a href="#signature-format" class="auto internal xref">Section 5.4.1</a>. The <code>hash</code> field of the MTCSubtree is set to <code>expected_subtree_hash</code>.<a href="#section-7.2-2.8.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-7.2-3">This procedure only replaces the signature verification portion of X.509 path validation. The relying party MUST continue to perform other checks, such as checking expiry.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trusted-cosigners">
<section id="section-7.3">
        <h3 id="name-trusted-cosigners">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-trusted-cosigners" class="section-name selfRef">Trusted Cosigners</a>
        </h3>
<p id="section-7.3-1">A relying party's cosigner policy determines the sets of cosigners that must sign a view of the issuance log before it is trusted.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">This document does not prescribe a particular policy, but gives general guidance. Relying parties MAY implement policies other than those described below, and MAY incorporate cosigners acting in roles not described in this document.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">In picking trusted cosigners, the relying party SHOULD ensure the following security properties:<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-7.3-4">
          <dt id="section-7.3-4.1">Authenticity:</dt>
          <dd style="margin-left: 1.5em" id="section-7.3-4.2">
            <p id="section-7.3-4.2.1">The relying party only accepts entries certified by the CA<a href="#section-7.3-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-7.3-4.3">Transparency:</dt>
          <dd style="margin-left: 1.5em" id="section-7.3-4.4">
            <p id="section-7.3-4.4.1">The relying party only accepts entries that are publicly accessible, so that monitors, particularly the subject of the certificate, can notice any unauthorized certificates<a href="#section-7.3-4.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-7.3-5">Relying parties SHOULD ensure authenticity by requiring a signature from the most recent CA cosigner key. If the CA is transitioning from an old to new key, the relying party SHOULD accept both until certificates that predate the new key expire. This is analogous to the signature in a traditional X.509 certificate.<a href="#section-7.3-5" class="pilcrow">¶</a></p>
<p id="section-7.3-6">While a CA signature is sufficient to prove a subtree came from the CA, this is not enough to ensure the certificate is visible to monitors. A misbehaving CA might not operate the log correctly, either presenting inconsistent versions of the log to relying parties and monitors, or refuse to publish some entries.<a href="#section-7.3-6" class="pilcrow">¶</a></p>
<p id="section-7.3-7">To mitigate this, relying parties SHOULD ensure transparency by requiring a quorum of signatures from additional cosigners. At minimum, these cosigners SHOULD enforce a consistent view of the log. For example, <span>[<a href="#TLOG-WITNESS" class="cite xref">TLOG-WITNESS</a>]</span> describes a lightweight "witness" cosigner role that checks this with consistency proofs. This is not sufficient to ensure durable logging. <a href="#revocation-by-index" class="auto internal xref">Section 7.5</a> discusses mitigations for this. Alternatively, a relying party MAY require cosigners that serve a copy of the log, in addition to enforcing a consistent view. For example, <span>[<a href="#TLOG-MIRROR" class="cite xref">TLOG-MIRROR</a>]</span> describes a "mirror" cosigner role.<a href="#section-7.3-7" class="pilcrow">¶</a></p>
<p id="section-7.3-8">Relying parties MAY accept the same set of additional cosigners across issuance logs.<a href="#section-7.3-8" class="pilcrow">¶</a></p>
<p id="section-7.3-9">Cosigner roles are extensible without changes to certificate verification itself. Future specifications and individual deployments MAY define other cosigner roles to incorporate into relying party policies.<a href="#section-7.3-9" class="pilcrow">¶</a></p>
<p id="section-7.3-10"><a href="#choosing-cosigners" class="auto internal xref">Section 10.2</a> discusses additional deployment considerations in cosigner selection.<a href="#section-7.3-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trusted-subtrees">
<section id="section-7.4">
        <h3 id="name-trusted-subtrees">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-trusted-subtrees" class="section-name selfRef">Trusted Subtrees</a>
        </h3>
<p id="section-7.4-1">As an optional optimization, a relying party MAY incorporate a periodically updated, predistributed list of active landmark subtrees, determined as described in <a href="#landmarks" class="auto internal xref">Section 6.3.1</a>. The relying party configures these as trusted subtrees, allowing it to accept signatureless certificates (<a href="#signatureless-certificates" class="auto internal xref">Section 6.3</a>) constructed against those subtrees.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">Before configuring the subtrees as trusted, the relying party MUST obtain assurance that each subtree is consistent with checkpoints observed by a sufficient set of cosigners (see <a href="#cosigners" class="auto internal xref">Section 5.4</a>) to meet its cosigner requirements. It is not necessary that the cosigners have generated signatures over the specific subtrees, only that they are consistent.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3">This criteria can be checked given:<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-4.1">
            <p id="section-7.4-4.1.1">Some <em>reference checkpoint</em> that contains the latest landmark<a href="#section-7.4-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.4-4.2">
            <p id="section-7.4-4.2.1">For each cosigner, either:<a href="#section-7.4-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.4-4.2.2.1">
                <p id="section-7.4-4.2.2.1.1">A cosignature on the reference checkpoint<a href="#section-7.4-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-7.4-4.2.2.2">
                <p id="section-7.4-4.2.2.2.1">A cosigned checkpoint containing the referenced checkpoint and a valid Merkle consistency proof (<span><a href="https://rfc-editor.org/rfc/rfc9162#section-2.1.4" class="relref">Section 2.1.4</a> of [<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>) between the two<a href="#section-7.4-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-7.4-4.3">
            <p id="section-7.4-4.3.1">For each subtree, a valid subtree consistency proof (<a href="#subtree-consistency-proofs" class="auto internal xref">Section 4.3</a>) between the subtree and the reference checkpoint<a href="#section-7.4-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.4-5">[[TODO: The subtree consistency proofs have many nodes in common. It is possible to define a single "bulk consistency proof" that verifies all the hashes at once, but it's a lot more complex.]]<a href="#section-7.4-5" class="pilcrow">¶</a></p>
<p id="section-7.4-6">This document does not prescribe how relying parties obtain this information. A relying party MAY, for example, use an application-specific update service, such as the services described in <span>[<a href="#CHROMIUM" class="cite xref">CHROMIUM</a>]</span> and <span>[<a href="#FIREFOX" class="cite xref">FIREFOX</a>]</span>. If the relying party considers the service sufficiently trusted (e.g. if the service provides the trust anchor list or certificate validation software), it MAY trust the update service to perform these checks.<a href="#section-7.4-6" class="pilcrow">¶</a></p>
<p id="section-7.4-7">The relying party SHOULD incorporate its trusted subtree configuration in application-protocol-specific certificate selection mechanisms, to allow an authenticating party to select a signatureless certificate. The trust anchor IDs of the landmarks may be used as efficient identifiers in the application protocol. <a href="#use-in-tls" class="auto internal xref">Section 8</a> discusses how to do this in TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.<a href="#section-7.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="revocation-by-index">
<section id="section-7.5">
        <h3 id="name-revocation-by-index">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-revocation-by-index" class="section-name selfRef">Revocation by Index</a>
        </h3>
<p id="section-7.5-1">For each supported Merkle Tree CA, the relying party maintains a list of revoked ranges of indices. This allows a relying party to efficiently revoke entries of an issuance log, even if the contents are not necessarily known. This may be used to mitigate the security consequences of misbehavior by a CA, or other parties in the ecosystem.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">When a relying party is first configured to trust a CA, it SHOULD be configured to revoke all entries from zero up to but not including the first available unexpired certificate at the time. This revocation SHOULD be periodically updated as entries expire and logs are pruned (<a href="#log-pruning" class="auto internal xref">Section 5.6.1</a>). In particular, when CAs prune entries, relying parties SHOULD be updated to revoke all newly unavailable entries. This gives assurance that, even if some unavailable entry had not yet expired, the relying party will not trust it. It also allows monitors to start monitoring a log without processing expired entries.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<p id="section-7.5-3">A misbehaving CA might correctly construct a globally consistent log, but refuse to make some entries or intermediate nodes available. Consistency proofs between checkpoints and subtrees would pass, but monitors cannot observe the entries themselves. Relying parties whose cosigner policies (<a href="#trusted-cosigners" class="auto internal xref">Section 7.3</a>) do not require durable logging (e.g. via <span>[<a href="#TLOG-MIRROR" class="cite xref">TLOG-MIRROR</a>]</span>) are particularly vulnerable to this. In this case, the indices of the missing entries will still be known, so relying parties can use this mechanism to revoke the unknown entries, possibly as an initial, targeted mitigation before a complete CA removal.<a href="#section-7.5-3" class="pilcrow">¶</a></p>
<p id="section-7.5-4">When a CA is found to be untrustworthy, relying parties SHOULD remove trust in that CA. To minimize the compatibility impact of this mitigation, index-based revocation can be used to only distrust entries after some index, while leaving existing entries accepted. This is analogous to the <span>[<a href="#SCTNotAfter" class="cite xref">SCTNotAfter</a>]</span> mechanism used in some PKIs.<a href="#section-7.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="use-in-tls">
<section id="section-8">
      <h2 id="name-use-in-tls">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-use-in-tls" class="section-name selfRef">Use in TLS</a>
      </h2>
<p id="section-8-1">TLS implementations that authenticate with or accept Merkle Tree certificates SHOULD support trust anchor IDs (<span>[<a href="#I-D.ietf-tls-trust-anchor-ids" class="cite xref">I-D.ietf-tls-trust-anchor-ids</a>]</span>) for certificate selection.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">A full certificate has a trust anchor ID of the corresponding log ID (<a href="#log-ids" class="auto internal xref">Section 5.2</a>). The authenticating party can obtain this information either by parsing the certificate's issuer field or via out-of-band information as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-trust-anchor-ids-02#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-tls-trust-anchor-ids" class="cite xref">I-D.ietf-tls-trust-anchor-ids</a>]</span>.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">[[TODO: Ideally we would negotiate cosigners. https://github.com/tlswg/tls-trust-anchor-ids/issues/54 has a sketch of how one might do this, though other designs are possible. Negotiating cosigners allows the ecosystem to manage cosigners efficiently, without needing to collect every possible cosignature and send them all at once. This is wasteful, particularly with post-quantum algorithms.]]<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">A full certificate MAY be used without signals about what the relying party trusts. As with other choices of default certificates, an authenticating party that does so assumes that the relying party trusts the issuing CA, e.g. because the CA is relatively ubiquitous among the relying parties that it supports.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">A signatureless certificate has a trust anchor ID of the corresponding landmark, as described in <a href="#landmarks" class="auto internal xref">Section 6.3.1</a>. This can be configured in the authenticating party via out-of-band information, as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-trust-anchor-ids-02#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-tls-trust-anchor-ids" class="cite xref">I-D.ietf-tls-trust-anchor-ids</a>]</span>. A relying party that has been configured with trusted subtrees (<a href="#trusted-subtrees" class="auto internal xref">Section 7.4</a>) derived from a set of landmarks SHOULD be configured to support those landmarks' trust anchor IDs. TLS certificate selection will then correctly determine whether the signatureless certificate is compatible with the relying party.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">[[TODO: We can do slightly better. If the relying party supports landmark 42, it can be assumed to also support landmark 41, 40, 39, etc. https://github.com/tlswg/tls-trust-anchor-ids/issues/62 discusses how to fit this into the trust anchor IDs framework. This allows the client to summarize its state with one ID per CA.]]<a href="#section-8-6" class="pilcrow">¶</a></p>
<p id="section-8-7">Authenticating parties SHOULD preferentially use signatureless certificates over full certificates, when both are supported by the relying party. A signatureless certificate asserts the same information as its full counterpart, but is expected to be smaller. A signatureless certificate SHOULD NOT be used without a signal that the relying party trusts the corresponding landmark subtree. Even if the relying party is assumed to trust the issuing CA, the relying party may not have sufficiently up-to-date trusted subtrees predistributed.<a href="#section-8-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acme-extensions">
<section id="section-9">
      <h2 id="name-acme-extensions">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acme-extensions" class="section-name selfRef">ACME Extensions</a>
      </h2>
<p id="section-9-1">This section describes how to issue Merkle Tree certificates using ACME <span>[<a href="#RFC8555" class="cite xref">RFC8555</a>]</span>.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">When downloading the certificate (<span><a href="https://rfc-editor.org/rfc/rfc8555#section-7.4.2" class="relref">Section 7.4.2</a> of [<a href="#RFC8555" class="cite xref">RFC8555</a>]</span>), ACME clients supporting Merkle Tree certificates SHOULD send "application/pem-certificate-chain-with-properties" in their Accept header (<span><a href="https://rfc-editor.org/rfc/rfc9110#section-12.5.1" class="relref">Section 12.5.1</a> of [<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>). ACME servers issuing Merkle Tree certificates SHOULD then respond with that content type and include trust anchor ID information as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-trust-anchor-ids-02#section-6" class="relref">Section 6</a> of [<a href="#I-D.ietf-tls-trust-anchor-ids" class="cite xref">I-D.ietf-tls-trust-anchor-ids</a>]</span>. <a href="#use-in-tls" class="auto internal xref">Section 8</a> decribes the trust anchor ID assignments for full and signatureless certificates.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">When processing an order for a Merkle Tree certificate, the ACME server moves the order to the "valid" state once the corresponding entry is sequenced in the issuance log. The order's certificate URL then serves the full certificate, constructed as described in <a href="#full-certificates" class="auto internal xref">Section 6.2</a>.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">The full certificate response SHOULD additionally carry a alternate URL for the signatureless certificate, as described <span><a href="https://rfc-editor.org/rfc/rfc8555#section-7.4.2" class="relref">Section 7.4.2</a> of [<a href="#RFC8555" class="cite xref">RFC8555</a>]</span>. Before the signatureless certificate is available, the alternate URL SHOULD return a HTTP 503 (Service Unavailable) response, with a Retry-After header (<span><a href="https://rfc-editor.org/rfc/rfc9110#section-10.2.3" class="relref">Section 10.2.3</a> of [<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>) estimating when the certificate will become available. Once the next landmark is allocated, the ACME server constructs a signatureless certificate, as described in <a href="#signatureless-certificates" class="auto internal xref">Section 6.3</a> and serves it from the alternate URL.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">ACME clients supporting Merkle Tree certificates SHOULD support fetching alternate chains. If an alternate chain returns an HTTP 503 with a Retry-After header, as described above, the client SHOULD retry the request at the specified time.<a href="#section-9-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deployment-considerations">
<section id="section-10">
      <h2 id="name-deployment-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-deployment-considerations" class="section-name selfRef">Deployment Considerations</a>
      </h2>
<div id="operational-costs">
<section id="section-10.1">
        <h3 id="name-operational-costs">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-operational-costs" class="section-name selfRef">Operational Costs</a>
        </h3>
<div id="certification-authority-costs">
<section id="section-10.1.1">
          <h4 id="name-certification-authority-cost">
<a href="#section-10.1.1" class="section-number selfRef">10.1.1. </a><a href="#name-certification-authority-cost" class="section-name selfRef">Certification Authority Costs</a>
          </h4>
<p id="section-10.1.1-1">While Merkle Tree certificates expects CAs to operate logs, the costs of these logs are expected to be much lower than a CT log from <span>[<a href="#RFC6962" class="cite xref">RFC6962</a>]</span> or <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>:<a href="#section-10.1.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1.1-2"><a href="#publishing-logs" class="auto internal xref">Section 5.6</a> does not constrain the API to the one defined in <span>[<a href="#RFC6962" class="cite xref">RFC6962</a>]</span> or <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>. If the PKI uses a tile-based protocol, such as <span>[<a href="#TLOG-TILES" class="cite xref">TLOG-TILES</a>]</span>, the issuance log benefits from the improved caching properties of such designs.<a href="#section-10.1.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1.1-3">Unlike a CT log, an issuance log does not have public submission APIs. Log entries are only added by the CA directly. The costs are thus expected to scale with the CA's own operations.<a href="#section-10.1.1-3" class="pilcrow">¶</a></p>
<p id="section-10.1.1-4">A CA only needs to produce a digital signature for every checkpoint, rather than for every certificate. The lower signature rate requirements could allow more secure and/or economical key storage choices.<a href="#section-10.1.1-4" class="pilcrow">¶</a></p>
<p id="section-10.1.1-5">Individual entries are kept small and do not scale with public key or signature sizes. This mitigates growth from post-quantum algorithms. Public keys in entries are replaced with fixed-sized hashes. There are no signatures in entries themselves, and only signatures on the very latest checkpoint are retained. Every new checkpoint completely subsumes the old checkpoint, so there is no need to retain older signatures. Likewise, a subtree is only signed if contained in another signed checkpoint.<a href="#section-10.1.1-5" class="pilcrow">¶</a></p>
<p id="section-10.1.1-6">Log pruning (<a href="#log-pruning" class="auto internal xref">Section 5.6.1</a>) allows a long-lived log to serve only the more recent entries, scaling with the size of the retention window, rather than the log's total lifetime.<a href="#section-10.1.1-6" class="pilcrow">¶</a></p>
<p id="section-10.1.1-7">Mirrors of the log can also reduce CA bandwidth costs, because monitors can fetch data from mirrors instead of CAs directly. In PKIs that deploy mirrors as part of cosigner policies, relying parties could set few availability requirements on CAs, as described in <a href="#log-availability" class="auto internal xref">Section 10.3</a>.<a href="#section-10.1.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cosigner-costs">
<section id="section-10.1.2">
          <h4 id="name-cosigner-costs">
<a href="#section-10.1.2" class="section-number selfRef">10.1.2. </a><a href="#name-cosigner-costs" class="section-name selfRef">Cosigner Costs</a>
          </h4>
<p id="section-10.1.2-1">The costs of cosigners vary by cosigner role. A consistency-checking cosigner, such as <span>[<a href="#TLOG-WITNESS" class="cite xref">TLOG-WITNESS</a>]</span>, requires very little state and can be run with low cost.<a href="#section-10.1.2-1" class="pilcrow">¶</a></p>
<p id="section-10.1.2-2">A mirroring cosigner, such as <span>[<a href="#TLOG-MIRROR" class="cite xref">TLOG-MIRROR</a>]</span>, performs comparable roles as CT logs, but several of the cost-saving properties in <a href="#certification-authority-costs" class="auto internal xref">Section 10.1.1</a> also apply: improved protocols, smaller entries, less frequent signatures, and log pruning. While a mirror does need to accommodate another party's (the CA's) growth rate, it grows only from new issuances from that one CA. If one CA's issuance rate exceeds the mirror's capacity, that does not impact the mirror's copies of other CAs. Mirrors also do not need to defend against a client uploading a large number of existing certificates all at once. Submissions are also naturally batched and serialized.<a href="#section-10.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="monitor-costs">
<section id="section-10.1.3">
          <h4 id="name-monitor-costs">
<a href="#section-10.1.3" class="section-number selfRef">10.1.3. </a><a href="#name-monitor-costs" class="section-name selfRef">Monitor Costs</a>
          </h4>
<p id="section-10.1.3-1">In a CT-based PKI, every log carries a potentially distinct subset of active certificates, so monitors must check the contents of every CT log. At the same time, certificates are commonly synchronized between CT logs. As a result, a monitor will typically download each certificate multiple times, once for every log. In Merkle Tree Certificates, each entry appears in exactly one log. A relying party might require a log to be covered by a quorum of mirrors, but each mirror is cryptographically verified to serve the same contents. Once a monitor has obtained some entry from one mirror, it does not need to download it from the others.<a href="#section-10.1.3-1" class="pilcrow">¶</a></p>
<p id="section-10.1.3-2">In addition to downloading each entry only once, the entries themselves are smaller, as discussed in <a href="#certification-authority-costs" class="auto internal xref">Section 10.1.1</a>.<a href="#section-10.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="choosing-cosigners">
<section id="section-10.2">
        <h3 id="name-choosing-cosigners">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-choosing-cosigners" class="section-name selfRef">Choosing Cosigners</a>
        </h3>
<p id="section-10.2-1">In selecting trusted cosigners and cosigner requirements (<a href="#trusted-cosigners" class="auto internal xref">Section 7.3</a>), relying parties navigate a number of trade-offs:<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">A consistency-checking cosigner, such as <span>[<a href="#TLOG-WITNESS" class="cite xref">TLOG-WITNESS</a>]</span>, is very cheap to run, but does not guarantee durable logging, while a mirroring cosigner is more expensive and may take longer to cosign structures. Requiring a mirror signature provides stronger guarantees to the relying party, which in turn can reduce the requirements on CAs (see <a href="#log-availability" class="auto internal xref">Section 10.3</a>), however it may cause certificate issuance to take longer. That said, mirrors are comparable to CT logs, if not cheaper (see <a href="#operational-costs" class="auto internal xref">Section 10.1</a>), so they may be appropriate in PKIs where running CT logs is already viable.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
<p id="section-10.2-3">Relying parties that require larger quorums of trusted cosigners can reduce the trust placed in any individual cosigner. However, these larger quorums result in larger, more expensive full certificates. The cost of this will depend on how frequently the signatureless optimization occurs in a given PKI. Conversely, relying parties that require smaller quorums have smaller full certificates, but place more trust in their cosigners.<a href="#section-10.2-3" class="pilcrow">¶</a></p>
<p id="section-10.2-4">Relying party policies also impact monitor operation. If a relying party accepts any one of three cosigners, monitors SHOULD check the checkpoints of all three. Otherwise, a malicious CA may send different split views to different cosigners. More generally, monitors SHOULD check the checkpoints in the union of all cosigners trusted by all supported relying parties. This is an efficient check because, if the CA is operating correctly, all cosigners will observe the same tree. Thus the monitor only needs to check consistency proofs between the checkpoints, and check the log contents themselves once. Monitors MAY also rely on other parties in the transparency ecosystem to perform this check.<a href="#section-10.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="log-availability">
<section id="section-10.3">
        <h3 id="name-log-availability">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-log-availability" class="section-name selfRef">Log Availability</a>
        </h3>
<p id="section-10.3-1">CAs and mirrors are expected to serve their log contents over HTTP. It is possible for the contents to be unavailable, either due to temporary service outage or because the log has been pruned (<a href="#log-pruning" class="auto internal xref">Section 5.6.1</a>). If some resources are unavailable, they may not be visible to monitors.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3-2">As in CT, PKIs which deploy Merkle Tree certificates SHOULD establish availability policies, adhered to by trusted CAs and mirrors, and enforced by relying party vendors as a condition of trust. Exact availability policies for these services are out of scope for this document, but this section provides some general guidance.<a href="#section-10.3-2" class="pilcrow">¶</a></p>
<p id="section-10.3-3">Availability policies SHOULD specify how long an entry must be made available, before a CA or mirror is permitted to prune the entry. It is RECOMMENDED to define this using a <em>retention period</em>, which is some time after the entry has expired. In such a policy, an entry could only be pruned if it, and all preceding entries, have already expired for the retention period. Policies MAY opt to set different retention periods between CAs and mirrors. Permitting limited log retention is analogous to the CT practice of temporal sharding <span>[<a href="#CHROME-CT" class="cite xref">CHROME-CT</a>]</span>, except that a pruned issuance log remains compatible with older, unupdated relying parties.<a href="#section-10.3-3" class="pilcrow">¶</a></p>
<p id="section-10.3-4">Such policies impact monitors. If the retention period is, e.g. 6 months, this means that monitors are expected to check entries of interest within 6 months. It also means that a new monitor may only be aware of a 6 month history of entries issued for a particular domain.<a href="#section-10.3-4" class="pilcrow">¶</a></p>
<p id="section-10.3-5">If historical data is not available to verify the retention period, such as information in another mirror or a trusted summary of expiration dates of entries, it may not be possible to confirm correct behavior. This is mitigated by the revocation process described in <a href="#revocation-by-index" class="auto internal xref">Section 7.5</a>: if a CA were to prune a forward-dated entry and, in the 6 months when the entry was available, no monitor noticed the unusual expiry, an updated relying party would not accept it anyway.<a href="#section-10.3-5" class="pilcrow">¶</a></p>
<p id="section-10.3-6">The log pruning process simply makes some resources unavailable, so availability policies SHOULD constrain log pruning in the same way as general resource availability. That is, if it would be a policy violation for the log to fail to serve a resource, it should also be a policy violation for the log to prune such that the resource is removed, and vice versa.<a href="#section-10.3-6" class="pilcrow">¶</a></p>
<p id="section-10.3-7">PKIs that require mirror cosignatures (<a href="#trusted-cosigners" class="auto internal xref">Section 7.3</a>) can impose minimal to no availability requirements on CAs, all without compromising transparency goals. If a CA never makes some entry available, mirrors will be unable to update. This will prevent relying parties from accepting the undisclosed entries. However, a CA which is persistently unavailable may not offer sufficient benefit to be used by authenticating parties or trusted by relying parties.<a href="#section-10.3-7" class="pilcrow">¶</a></p>
<p id="section-10.3-8">However, if a mirror's interface becomes unavailable, monitors may be unable to check for unauthorized issuance, if the entries are not available in another mirror. This does compromise transparency goals. As such, availability policies SHOULD set availability expectations on mirrors. This can also be mitigated by using multiple mirrors, either directly enforced in cosigner requirements, or by keeping mirrors up-to-date with each other.<a href="#section-10.3-8" class="pilcrow">¶</a></p>
<p id="section-10.3-9">In PKIs that do not require mirroring cosigners, the CA's serving endpoint is more crucial for monitors. Such PKIs thus SHOULD set availability requirements on CAs.<a href="#section-10.3-9" class="pilcrow">¶</a></p>
<p id="section-10.3-10">In each of these cases, availability failures can be mitigated by revoking the unavailable entries by index, as described in <a href="#revocation-by-index" class="auto internal xref">Section 7.5</a>, likely as a first step in a broader distrust.<a href="#section-10.3-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="certificate-renewal">
<section id="section-10.4">
        <h3 id="name-certificate-renewal">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-certificate-renewal" class="section-name selfRef">Certificate Renewal</a>
        </h3>
<p id="section-10.4-1">When an authenticating party requests a certificate, the signatureless certificate will not be available until the next landmark is ready. From there, the signatureless certificate will not be available until relying parties receive new trusted subtrees.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<p id="section-10.4-2">To maximize coverage of the signatureless certificate optimization, authenticating parties performing routine renewal SHOULD request a new Merkle Tree certificate some time before the previous Merkle Tree certificate expires. Renewing around 75% into the previous certificate's lifetime is RECOMMENDED. Authenticating parties additionally SHOULD retain both the new and old certificates in the certificate set until the old certificate expires. As the new subtrees are delivered to relying parties, certificate negotiation will transition relying parties to the new certificate, while retaining the old certificate for relying parties that are not yet updated.<a href="#section-10.4-2" class="pilcrow">¶</a></p>
<p id="section-10.4-3">The above also applies if the authenticating party is performing a routine key rotation alongside the routine renewal. In this case, certificate negotiation would pick the key as part of the certificate selection. This slightly increases the lifetime of the old key but maintains the size optimization continuously.<a href="#section-10.4-3" class="pilcrow">¶</a></p>
<p id="section-10.4-4">If the service is rotating keys in response to a key compromise, this option is not appropriate. Instead, the service SHOULD immediately discard the old key and request a full certificate and the revocation of the previous certificate. This will interrupt the size optimization until the new signatureless certificate is available and relying parties are updated.<a href="#section-10.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multiple-ca-keys">
<section id="section-10.5">
        <h3 id="name-multiple-ca-keys">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-multiple-ca-keys" class="section-name selfRef">Multiple CA Keys</a>
        </h3>
<p id="section-10.5-1">The separation between issuance logs and CA cosigners gives CAs additional flexibility in managing keys. A CA operator wishing to rotate keys, e.g. to guard against compromise of older key material, or upgrade to newer algorithms, could retain the same issuance log and sign its checkpoints and subtrees with both keys in parallel, until relying parties are all updated. Older relying parties would verify the older signatures, while newer relying parties would verify the newer signatures. A cosignature negotiation mechanism in the application protocol (see <a href="#use-in-tls" class="auto internal xref">Section 8</a>) would avoid using extra bandwidth for the two signatures.<a href="#section-10.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-11">
      <h2 id="name-privacy-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-11-1">The Privacy Considerations described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-trust-anchor-ids-02#section-9" class="relref">Section 9</a> of [<a href="#I-D.ietf-tls-trust-anchor-ids" class="cite xref">I-D.ietf-tls-trust-anchor-ids</a>]</span> apply to its use with Merkle Tree Certificates.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">In particular, relying parties that share an update process for trusted subtrees (<a href="#trusted-subtrees" class="auto internal xref">Section 7.4</a>) will fetch the same stream of updates. However, updates may reach different users at different times, resulting in some variation across users. This variation may contribute to a fingerprinting attack <span>[<a href="#RFC6973" class="cite xref">RFC6973</a>]</span>. If the Merkle Tree CA trust anchors are sent unconditionally in <code>trust_anchors</code>, this variation will be passively observable. If they are sent conditionally, e.g. with the DNS mechanism, the trust anchor list will require active probing.<a href="#section-11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-12">
      <h2 id="name-security-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="authenticity">
<section id="section-12.1">
        <h3 id="name-authenticity">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-authenticity" class="section-name selfRef">Authenticity</a>
        </h3>
<p id="section-12.1-1">A key security requirement of any PKI scheme is that relying parties only accept assertions that were certified by a trusted certification authority. Merkle Tree certificates achieve this by ensuring the relying party only accepts authentic subtree hashes:<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.1-2.1">
            <p id="section-12.1-2.1.1">In full certificates, the relying party's cosigner requirements (<a href="#trusted-cosigners" class="auto internal xref">Section 7.3</a>) are expected to include some signature by the CA's cosigner. The CA's cosigner (<a href="#certification-authority-cosigners" class="auto internal xref">Section 5.5</a>) is defined to certify the contents of every checkpoint and subtree that it signs.<a href="#section-12.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.1-2.2">
            <p id="section-12.1-2.2.1">In signatureless certificates, the cosigner requirements are checked ahead of time, when the trusted subtrees are predistributed (<a href="#trusted-subtrees" class="auto internal xref">Section 7.4</a>).<a href="#section-12.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-12.1-3">Given such a subtree hash, computed over entries that the CA certified, it then must be computationally infeasible to construct an entry not on this list, and some inclusion proof, such that inclusion proof verification succeeds. This requires using a collision-resistant hash in the Merkle Tree construction.<a href="#section-12.1-3" class="pilcrow">¶</a></p>
<p id="section-12.1-4">Log entries contain public key hashes, so it must additionally be computationally infeasible to compute a public key whose hash matches the entry, other than the intended public key. This also requires a collision-resistant hash.<a href="#section-12.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transparency">
<section id="section-12.2">
        <h3 id="name-transparency">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-transparency" class="section-name selfRef">Transparency</a>
        </h3>
<p id="section-12.2-1">The transparency mechanisms in this document do not prevent a CA from issuing an unauthorized certificate. Rather, they provide comparable security properties as Certificate Transparency <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span> in ensuring that all certificates are either rejected by relying parties, or visible to monitors and, in particular, the subject of the certificate.<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<p id="section-12.2-2">Compared to Certificate Transparency, some of the responsibilities of a log have moved to the CA. All signatures generated by the CA in this system are assertions about some view of the CA's issuance log. However, a CA does not need to function correctly to ensure transparency properties. Relying parties are expected to require a quorum of additional cosigners, which together enforce properties of the log (<a href="#trusted-cosigners" class="auto internal xref">Section 7.3</a>) and prevent or detect CA misbehavior:<a href="#section-12.2-2" class="pilcrow">¶</a></p>
<p id="section-12.2-3">A CA might violate the append-only property of its log and present different views to different parties. However, each individual cosigner will only follow a single append-only view of the log history. Provided the cosigners are correctly operated, relying parties and monitors will observe consistent views between each other. Views that were not cosigned at all may not be detected, but they also will not be accepted by relying parties.<a href="#section-12.2-3" class="pilcrow">¶</a></p>
<p id="section-12.2-4">If the CA sends one view to some cosigners and another view to other cosigners, it is possible that multiple views will be accepted by relying parties. However, in that case monitors will observe that cosigners do not match each other. Relying parties can then react by revoking the inconsistent indices (<a href="#revocation-by-index" class="auto internal xref">Section 7.5</a>), and likely removing the CA. If the cosigners are mirrors, the underlying entries in both views will also be visible.<a href="#section-12.2-4" class="pilcrow">¶</a></p>
<p id="section-12.2-5">A CA might correctly construct its log, but refuse to serve some unauthorized entry, e.g. by feigning an outage or pruning the log outside the retention policy (<a href="#log-availability" class="auto internal xref">Section 10.3</a>). If the relying party requires cosignatures from trusted mirrors, the entry will either be visible to monitors in the mirrors, or have never reached a mirror. In the latter case, the entry will not have been cosigned, so the relying party would not accept it. If the relying party accepts log views without a trusted mirror, the unauthorized entry may not be available. However, the existence of <em>some</em> entry at that index will be visible, so monitors will know the CA is failing to present an entry. Relying parties can then react by revoking the undisclosed entries by index (<a href="#revocation-by-index" class="auto internal xref">Section 7.5</a>), and likely removing the CA.<a href="#section-12.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="public-key-hashes">
<section id="section-12.3">
        <h3 id="name-public-key-hashes">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-public-key-hashes" class="section-name selfRef">Public Key Hashes</a>
        </h3>
<p id="section-12.3-1">Unlike Certificate Transparency, the mechanisms in this document do not provide the subject public keys, only the hashed values. This is intended to reduce log serving costs, particularly with large post-quantum keys. As a result, monitors look for unrecognized hashes instead of unrecognized keys. Any unrecognized hash, even if the preimage is unknown, indicates an unauthorized certificate.<a href="#section-12.3-1" class="pilcrow">¶</a></p>
<p id="section-12.3-2">This optimization complicates studies of weak public keys, e.g. <span>[<a href="#SharedFactors" class="cite xref">SharedFactors</a>]</span>. Such studies will have to retrieve the public keys separately, such as by connecting to the TLS servers, or fetching from the CA if it retains the unhashed key. This document does not define a mechanism for doing this, or require that CAs or mirrors retain unhashed keys. The transparency mechanisms in this protocol are primarily intended to allow monitors to observe certificate issuance.<a href="#section-12.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="non-repudiation">
<section id="section-12.4">
        <h3 id="name-non-repudiation">
<a href="#section-12.4" class="section-number selfRef">12.4. </a><a href="#name-non-repudiation" class="section-name selfRef">Non-Repudiation</a>
        </h3>
<p id="section-12.4-1">When a monitor finds an unauthorized certificate issuance in a log or mirror, it must be possible to prove the CA indeed certified the information in the entry. However, only the latest checkpoint signature is retained by the transparency ecosystem, so it may not be possible to reconstruct the exact certificate seen by relying parties.<a href="#section-12.4-1" class="pilcrow">¶</a></p>
<p id="section-12.4-2">However, per <a href="#certification-authority-cosigners" class="auto internal xref">Section 5.5</a>, any checkpoint signature is a binding assertion by the CA that it has certified every entry in the checkpoint. Thus, given <em>any</em> signed checkpoint that contains the unauthorized entry, a Merkle inclusion proof (<span><a href="https://rfc-editor.org/rfc/rfc9162#section-2.1.3" class="relref">Section 2.1.3</a> of [<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>) is sufficient to prove the CA issued the entry. This is analogous to how, in <span><a href="https://rfc-editor.org/rfc/rfc9162#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>, CAs are held accountable for signed CT precertificates.<a href="#section-12.4-2" class="pilcrow">¶</a></p>
<p id="section-12.4-3">The transparency ecosystem does not retain unhashed public keys, so it also may not be possible to construct a complete certificate from the checkpoint signature and inclusion proof. However, if the log entry's <code>subjectPublicKeyInfoHash</code> does not correspond to an authorized key for the subject of the certificate, the entry is still unauthorized. A Merkle Tree CA is held responsible for all log entries it certifies, whether or not the preimage of the hash is known.<a href="#section-12.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="new-log-entry-types">
<section id="section-12.5">
        <h3 id="name-new-log-entry-types">
<a href="#section-12.5" class="section-number selfRef">12.5. </a><a href="#name-new-log-entry-types" class="section-name selfRef">New Log Entry Types</a>
        </h3>
<p id="section-12.5-1">MerkleTreeCertEntry (<a href="#log-entries" class="auto internal xref">Section 5.3</a>) is extensible and permits protocol extensions to define new formats for the CA to certify. This means older CAs, cosigners, relying parties, and monitors might interact with new entries:<a href="#section-12.5-1" class="pilcrow">¶</a></p>
<p id="section-12.5-2"><a href="#log-entries" class="auto internal xref">Section 5.3</a> and <a href="#certification-authority-cosigners" class="auto internal xref">Section 5.5</a> forbid a CA from logging or signing entries that it does not recognize. A CA cannot faithfully claim to certify information if it does not understand it. This is analogous to how a correctly-operated X.509 can never sign an unrecognized X.509 extension.<a href="#section-12.5-2" class="pilcrow">¶</a></p>
<p id="section-12.5-3">External cosigners may or may not interact with the unrecognized entries. <span>[<a href="#TLOG-MIRROR" class="cite xref">TLOG-MIRROR</a>]</span> and <span>[<a href="#TLOG-WITNESS" class="cite xref">TLOG-WITNESS</a>]</span> describe cosigners whose roles do not interpret the contents of log entries. New entry types MAY be added without updating them. If a cosigner role does interpret a log entry, it MUST define how it interacts with unknown ones.<a href="#section-12.5-3" class="pilcrow">¶</a></p>
<p id="section-12.5-4">If a relying party trusts an issuance log, but the issuance log contains an unrecognized entry, the entry will not cause it to accept an unexpected certificate. In <a href="#verifying-certificate-signatures" class="auto internal xref">Section 7.2</a>, the relying party constructs the MerkleTreeCertEntry that it expects. The unrecognized entry will have a different <code>type</code> value, so the proof will never succeed, assuming the underlying hash function remains collision-resistant.<a href="#section-12.5-4" class="pilcrow">¶</a></p>
<p id="section-12.5-5">If a monitor observes an entry with unknown type, it may not be able to determine if it is of interest. For example, it may be unable to tell whether it covers some relevant DNS name. Until the monitor is updated to reflect the current state of the PKI, the monitor may be unable to detect all misissued certificates.<a href="#section-12.5-5" class="pilcrow">¶</a></p>
<p id="section-12.5-6">This situation is analogous to the addition of a new X.509 extension. When relying parties add support for log entry types or new X.509 extensions, they SHOULD coordinate with monitors to ensure the transparency ecosystem is able to monitor the new formats.<a href="#section-12.5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="certificate-malleability">
<section id="section-12.6">
        <h3 id="name-certificate-malleability">
<a href="#section-12.6" class="section-number selfRef">12.6. </a><a href="#name-certificate-malleability" class="section-name selfRef">Certificate Malleability</a>
        </h3>
<p id="section-12.6-1">An ASN.1 structure like X.509’s Certificate is an abstract data type that is independent of its serialization. There are multiple encoding rules for ASN.1. Commonly, protocols use DER <span>[<a href="#X.690" class="cite xref">X.690</a>]</span>, such as <span><a href="https://rfc-editor.org/rfc/rfc8446#section-4.4.2" class="relref">Section 4.4.2</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>. This aligns with <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.1.1.3" class="relref">Section 4.1.1.3</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, which says X.509 signatures are computed over the DER-encoded TBSCertificate. After signature verification, applications can assume the DER-encoded TBSCertificate is not malleable.<a href="#section-12.6-1" class="pilcrow">¶</a></p>
<p id="section-12.6-2">While the signature verification process in <a href="#verifying-certificate-signatures" class="auto internal xref">Section 7.2</a> first transforms the TBSCertificate into a TBSCertificateLogEntry, it preserves this non-malleability. There is a unique valid DER encoding for every abstract TBSCertificate structure, so malleability of the DER-encoded TBSCertificate reduces to malleability of the TBSCertificate value:<a href="#section-12.6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.6-3.1">
            <p id="section-12.6-3.1.1">The <code>version</code>, <code>issuer</code>, <code>validity</code>, <code>subject</code>, <code>issuerUniqueID</code>, <code>subjectUniqueID</code>, and <code>extensions</code> fields are copied from the TBSCertificate to the TBSCertificateLogEntry unmodified, so they are directly authenticated by the inclusion proof.<a href="#section-12.6-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.6-3.2">
            <p id="section-12.6-3.2.1"><code>serialNumber</code> is omitted from TBSCertificateLogEntry, but its value determines the inclusion proof index, which authenticates it.<a href="#section-12.6-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.6-3.3">
            <p id="section-12.6-3.3.1">The redundant <code>signature</code> field in TBSCertificate is omitted from TBSCertificateLogEntry, but <a href="#verifying-certificate-signatures" class="auto internal xref">Section 7.2</a> checks for an exact value, so no other values are possible.<a href="#section-12.6-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.6-3.4">
            <p id="section-12.6-3.4.1"><code>subjectPublicKeyInfo</code> is hashed as <code>subjectPublicKeyInfoHash</code> in TBSCertificateLogEntry. Provided the underlying hash function is collision-resistant, no other values are possible for a given log entry.<a href="#section-12.6-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-12.6-4">Some non-conforming X.509 implementations use a BER <span>[<a href="#X.690" class="cite xref">X.690</a>]</span> parser instead of DER and then, instead of computing the canonical DER encoding per <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.1.1.3" class="relref">Section 4.1.1.3</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, verify the signature over the particular BER encoding received. Those implementations may still assume the received BER-encoded TBSCertificate is not malleable. However, as BER encoding is not unique, this breaks the above assumptions in Merkle Tree Certificates. To preserve non-malleability, these non-conforming implementations MUST do the following when verifying a Merkle Tree Certificate:<a href="#section-12.6-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.6-5.1">
            <p id="section-12.6-5.1.1">When parsing the outermost TBSCertificate SEQUENCE tag and length, reparse with a conforming DER parser.<a href="#section-12.6-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.6-5.2">
            <p id="section-12.6-5.2.1">When copying the <code>version</code>, <code>issuer</code>, <code>validity</code>, <code>subject</code>, <code>issuerUniqueID</code>, <code>subjectUniqueID</code>, and <code>extensions</code> fields, either reparse with a conforming DER parser, or copy over the observed BER encodings.<a href="#section-12.6-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.6-5.3">
            <p id="section-12.6-5.3.1">Reparse the <code>serialNumber</code> field with a conforming DER parser.<a href="#section-12.6-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.6-5.4">
            <p id="section-12.6-5.4.1">Reparse the <code>signature</code> field with a conforming DER parser. Equivalently, check for an exact match for the expected, DER-encoded value.<a href="#section-12.6-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-12.6-5.5">
            <p id="section-12.6-5.5.1">When hashing <code>subjectPublicKeyInfo</code>, either reparse with a conforming DER parser, or hash the observed BER encoding.<a href="#section-12.6-5.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-12.6-6"><a href="#log-entries" class="auto internal xref">Section 5.3</a> requires that the TBSCertificateLogEntry in a MerkleTreeCertEntry be DER-encoded, so applying a stricter parser will be compatible with conforming CAs. While these existing non-conforming implementations may be unable to switch to a DER parser due to compatibility concerns, Merkle Tree Certificates is new, so there is no existing deployment of malformed BER-encoded TBSCertificateLogEntry structures.<a href="#section-12.6-6" class="pilcrow">¶</a></p>
<p id="section-12.6-7">The above only ensures the TBSCertificate portion is non-malleable. In Merkle Tree Certificates, similar to ECDSA X.509 signature, the signature value is malleable. Multiple MTCProof structures may prove a single TBSCertificate structure. Additionally, in all X.509-based protocols, a BER-based parser for the outer, unsigned Certificate structure will admit malleability in those portions of the encoding. Applications that derive a unique identifier from the Certificate MUST instead use the TBSCertificate, or some portion of it, for Merkle Tree Certificates.<a href="#section-12.6-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-13">
      <h2 id="name-iana-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="module-identifier">
<section id="section-13.1">
        <h3 id="name-module-identifier">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-module-identifier" class="section-name selfRef">Module Identifier</a>
        </h3>
<p id="section-13.1-1">IANA is requested to add the following entry in the "SMI Security for PKIX Module Identifier" registry <span>[<a href="#RFC7299" class="cite xref">RFC7299</a>]</span>:<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Decimal</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">References</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">id-mod-mtc-2025</td>
              <td class="text-left" rowspan="1" colspan="1">[this-RFC]</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="algorithm">
<section id="section-13.2">
        <h3 id="name-algorithm">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-algorithm" class="section-name selfRef">Algorithm</a>
        </h3>
<p id="section-13.2-1">IANA is requested to add the following entry to the "SMI Security for PKIX Algorithms" registry <span>[<a href="#RFC7299" class="cite xref">RFC7299</a>]</span>:<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Decimal</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">References</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">id-alg-mtcProof</td>
              <td class="text-left" rowspan="1" colspan="1">[this-RFC]</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="relative-distinguished-name-attribute">
<section id="section-13.3">
        <h3 id="name-relative-distinguished-name">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-relative-distinguished-name" class="section-name selfRef">Relative Distinguished Name Attribute</a>
        </h3>
<p id="section-13.3-1">IANA is requested to add the following entry to the "SMI Security for PKIX Relative Distinguished Name Attribute" registry <span>[<a href="#I-D.ietf-lamps-x509-alg-none" class="cite xref">I-D.ietf-lamps-x509-alg-none</a>]</span>:<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
          <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Decimal</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">References</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD</td>
              <td class="text-left" rowspan="1" colspan="1">id-rdna-trustAnchorID</td>
              <td class="text-left" rowspan="1" colspan="1">[this-RFC]</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-14">
      <h2 id="name-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-14.1">
        <h3 id="name-normative-references">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="FIPS186-5">[FIPS186-5]</dt>
        <dd>
<span class="refTitle">"Digital Signature Standard (DSS)"</span>, <span class="refContent">National Institute of Standards and Technology (U.S.)</span>, <span class="seriesInfo">DOI 10.6028/nist.fips.186-5</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.fips.186-5">https://doi.org/10.6028/nist.fips.186-5</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS204">[FIPS204]</dt>
        <dd>
<span class="refTitle">"Module-lattice-based digital signature standard"</span>, <span class="refContent">National Institute of Standards and Technology (U.S.)</span>, <span class="seriesInfo">DOI 10.6028/nist.fips.204</span>, <time datetime="2024-08" class="refDate">August 2024</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.fips.204">https://doi.org/10.6028/nist.fips.204</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-trust-anchor-ids">[I-D.ietf-tls-trust-anchor-ids]</dt>
        <dd>
<span class="refAuthor">Beck, B.</span>, <span class="refAuthor">Benjamin, D.</span>, <span class="refAuthor">O'Brien, D.</span>, and <span class="refAuthor">K. Nekritz</span>, <span class="refTitle">"TLS Trust Anchor Identifiers"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-trust-anchor-ids-02</span>, <time datetime="2025-09-15" class="refDate">15 September 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-trust-anchor-ids-02">https://datatracker.ietf.org/doc/html/draft-ietf-tls-trust-anchor-ids-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3629">https://www.rfc-editor.org/rfc/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5912">[RFC5912]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 5912</span>, <span class="seriesInfo">DOI 10.17487/RFC5912</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5912">https://www.rfc-editor.org/rfc/rfc5912</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8032">https://www.rfc-editor.org/rfc/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8555">[RFC8555]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Hoffman-Andrews, J.</span>, <span class="refAuthor">McCarney, D.</span>, and <span class="refAuthor">J. Kasten</span>, <span class="refTitle">"Automatic Certificate Management Environment (ACME)"</span>, <span class="seriesInfo">RFC 8555</span>, <span class="seriesInfo">DOI 10.17487/RFC8555</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8555">https://www.rfc-editor.org/rfc/rfc8555</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9110">https://www.rfc-editor.org/rfc/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9162">[RFC9162]</dt>
        <dd>
<span class="refAuthor">Laurie, B.</span>, <span class="refAuthor">Messeri, E.</span>, and <span class="refAuthor">R. Stradling</span>, <span class="refTitle">"Certificate Transparency Version 2.0"</span>, <span class="seriesInfo">RFC 9162</span>, <span class="seriesInfo">DOI 10.17487/RFC9162</span>, <time datetime="2021-12" class="refDate">December 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9162">https://www.rfc-editor.org/rfc/rfc9162</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHS">[SHS]</dt>
        <dd>
<span class="refTitle">"Secure hash standard"</span>, <span class="refContent">National Institute of Standards and Technology (U.S.)</span>, <span class="seriesInfo">DOI 10.6028/nist.fips.180-4</span>, <time datetime="2015" class="refDate">2015</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.fips.180-4">https://doi.org/10.6028/nist.fips.180-4</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X.690">[X.690]</dt>
      <dd>
<span class="refAuthor">ITU-T</span>, <span class="refTitle">"Information technology - ASN.1 encoding Rules: Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER) and Distinguished Encoding Rules (DER)"</span>, <span class="seriesInfo">ISO/IEC 8824-1:2021 </span>, <time datetime="2021-02" class="refDate">February 2021</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-14.2">
        <h3 id="name-informative-references">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="APPLE-CT">[APPLE-CT]</dt>
        <dd>
<span class="refAuthor">Apple</span>, <span class="refTitle">"Apple's Certificate Transparency policy"</span>, <time datetime="2021-03-05" class="refDate">5 March 2021</time>, <span>&lt;<a href="https://support.apple.com/en-us/HT205280">https://support.apple.com/en-us/HT205280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="AuditingRevisited">[AuditingRevisited]</dt>
        <dd>
<span class="refAuthor">Heimberger, L.</span>, <span class="refAuthor">Patton, C.</span>, and <span class="refAuthor">B. Westerbaan</span>, <span class="refTitle">"Private SCT Auditing, Revisited"</span>, <time datetime="2025-04-25" class="refDate">25 April 2025</time>, <span>&lt;<a href="https://eprint.iacr.org/2025/556.pdf">https://eprint.iacr.org/2025/556.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CABF-153">[CABF-153]</dt>
        <dd>
<span class="refAuthor">CA/Browser Forum</span>, <span class="refTitle">"Ballot 153 – Short-Lived Certificates"</span>, <time datetime="2015-11-11" class="refDate">11 November 2015</time>, <span>&lt;<a href="https://cabforum.org/2015/11/11/ballot-153-short-lived-certificates/">https://cabforum.org/2015/11/11/ballot-153-short-lived-certificates/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CABF-SC081">[CABF-SC081]</dt>
        <dd>
<span class="refAuthor">CA/Browser Forum</span>, <span class="refTitle">"Ballot SC081v3: Introduce Schedule of Reducing Validity and Data Reuse Periods"</span>, <time datetime="2025-04-11" class="refDate">11 April 2025</time>, <span>&lt;<a href="https://cabforum.org/2025/04/11/ballot-sc081v3-introduce-schedule-of-reducing-validity-and-data-reuse-periods/">https://cabforum.org/2025/04/11/ballot-sc081v3-introduce-schedule-of-reducing-validity-and-data-reuse-periods/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CHROME-CT">[CHROME-CT]</dt>
        <dd>
<span class="refAuthor">Google Chrome</span>, <span class="refTitle">"Chrome Certificate Transparency Policy"</span>, <time datetime="2022-03-17" class="refDate">17 March 2022</time>, <span>&lt;<a href="https://googlechrome.github.io/CertificateTransparency/ct_policy.html">https://googlechrome.github.io/CertificateTransparency/ct_policy.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CHROMIUM">[CHROMIUM]</dt>
        <dd>
<span class="refAuthor">Chromium</span>, <span class="refTitle">"Component Updater"</span>, <time datetime="2022-03-03" class="refDate">3 March 2022</time>, <span>&lt;<a href="https://chromium.googlesource.com/chromium/src/+/main/components/component_updater/README.md">https://chromium.googlesource.com/chromium/src/+/main/components/component_updater/README.md</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIREFOX">[FIREFOX]</dt>
        <dd>
<span class="refAuthor">Mozilla</span>, <span class="refTitle">"Firefox Remote Settings"</span>, <time datetime="2022-08-20" class="refDate">20 August 2022</time>, <span>&lt;<a href="https://wiki.mozilla.org/Firefox/RemoteSettings">https://wiki.mozilla.org/Firefox/RemoteSettings</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-x509-alg-none">[I-D.ietf-lamps-x509-alg-none]</dt>
        <dd>
<span class="refAuthor">Benjamin, D.</span>, <span class="refTitle">"Unsigned X.509 Certificates"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-x509-alg-none-10</span>, <time datetime="2025-09-05" class="refDate">5 September 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-x509-alg-none-10">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-x509-alg-none-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="LetsEncrypt">[LetsEncrypt]</dt>
        <dd>
<span class="refAuthor">Let's Encrypt</span>, <span class="refTitle">"Let's Encrypt Stats"</span>, <time datetime="2023-03-07" class="refDate">7 March 2023</time>, <span>&lt;<a href="https://letsencrypt.org/stats/">https://letsencrypt.org/stats/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MerkleTown">[MerkleTown]</dt>
        <dd>
<span class="refAuthor">Cloudflare, Inc.</span>, <span class="refTitle">"Merkle Town"</span>, <time datetime="2023-03-07" class="refDate">7 March 2023</time>, <span>&lt;<a href="https://ct.cloudflare.com/">https://ct.cloudflare.com/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4514">[RFC4514]</dt>
        <dd>
<span class="refAuthor">Zeilenga, K., Ed.</span>, <span class="refTitle">"Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names"</span>, <span class="seriesInfo">RFC 4514</span>, <span class="seriesInfo">DOI 10.17487/RFC4514</span>, <time datetime="2006-06" class="refDate">June 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4514">https://www.rfc-editor.org/rfc/rfc4514</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6962">[RFC6962]</dt>
        <dd>
<span class="refAuthor">Laurie, B.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">E. Kasper</span>, <span class="refTitle">"Certificate Transparency"</span>, <span class="seriesInfo">RFC 6962</span>, <span class="seriesInfo">DOI 10.17487/RFC6962</span>, <time datetime="2013-06" class="refDate">June 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6962">https://www.rfc-editor.org/rfc/rfc6962</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6973">[RFC6973]</dt>
        <dd>
<span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Peterson, J.</span>, <span class="refAuthor">Morris, J.</span>, <span class="refAuthor">Hansen, M.</span>, and <span class="refAuthor">R. Smith</span>, <span class="refTitle">"Privacy Considerations for Internet Protocols"</span>, <span class="seriesInfo">RFC 6973</span>, <span class="seriesInfo">DOI 10.17487/RFC6973</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6973">https://www.rfc-editor.org/rfc/rfc6973</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7299">[RFC7299]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Object Identifier Registry for the PKIX Working Group"</span>, <span class="seriesInfo">RFC 7299</span>, <span class="seriesInfo">DOI 10.17487/RFC7299</span>, <time datetime="2014-07" class="refDate">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7299">https://www.rfc-editor.org/rfc/rfc7299</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SCTNotAfter">[SCTNotAfter]</dt>
        <dd>
<span class="refAuthor">Adrian, D.</span>, <span class="refTitle">"How to distrust a CA without any certificate errors"</span>, <time datetime="2025-03" class="refDate">March 2025</time>, <span>&lt;<a href="https://dadrian.io/blog/posts/sct-not-after/">https://dadrian.io/blog/posts/sct-not-after/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SharedFactors">[SharedFactors]</dt>
        <dd>
<span class="refAuthor">Våge, H. F.</span> and <span class="refAuthor">University of Bergen</span>, <span class="refTitle">"Finding shared RSA factors in the Certificate Transparency logs"</span>, <time datetime="2022-05-13" class="refDate">13 May 2022</time>, <span>&lt;<a href="https://bora.uib.no/bora-xmlui/bitstream/handle/11250/3001128/Masters_thesis__for_University_of_Bergen.pdf">https://bora.uib.no/bora-xmlui/bitstream/handle/11250/3001128/Masters_thesis__for_University_of_Bergen.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIGNED-NOTE">[SIGNED-NOTE]</dt>
        <dd>
<span class="refAuthor">C2SP</span>, <span class="refTitle">"Note"</span>, <time datetime="2025-04" class="refDate">April 2025</time>, <span>&lt;<a href="https://c2sp.org/signed-note">https://c2sp.org/signed-note</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="STH-Discipline">[STH-Discipline]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refTitle">"STH Discipline &amp; Security Considerations"</span>, <time datetime="2017-03-03" class="refDate">3 March 2017</time>, <span>&lt;<a href="https://mailarchive.ietf.org/arch/msg/trans/Zm4NqyRc7LDsOtV56EchBIT9r4c/">https://mailarchive.ietf.org/arch/msg/trans/Zm4NqyRc7LDsOtV56EchBIT9r4c/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLOG-CHECKPOINT">[TLOG-CHECKPOINT]</dt>
        <dd>
<span class="refAuthor">C2SP</span>, <span class="refTitle">"Transparency Log Checkpoints"</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://c2sp.org/tlog-checkpoint">https://c2sp.org/tlog-checkpoint</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLOG-MIRROR">[TLOG-MIRROR]</dt>
        <dd>
<span class="refAuthor">C2SP</span>, <span class="refTitle">"Transparency Log Mirrors"</span>, <time datetime="2025-07" class="refDate">July 2025</time>, <span>&lt;<a href="https://c2sp.org/tlog-mirror">https://c2sp.org/tlog-mirror</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLOG-TILES">[TLOG-TILES]</dt>
        <dd>
<span class="refAuthor">C2SP</span>, <span class="refTitle">"Tiled Transparency Logs"</span>, <time datetime="2025-06" class="refDate">June 2025</time>, <span>&lt;<a href="https://c2sp.org/tlog-tiles">https://c2sp.org/tlog-tiles</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLOG-WITNESS">[TLOG-WITNESS]</dt>
      <dd>
<span class="refAuthor">C2SP</span>, <span class="refTitle">"Transparency Log Witness Protocol"</span>, <time datetime="2025-06" class="refDate">June 2025</time>, <span>&lt;<a href="https://c2sp.org/tlog-witness">https://c2sp.org/tlog-witness</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="asn1-module">
<section id="appendix-A">
      <h2 id="name-asn1-module">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-asn1-module" class="section-name selfRef">ASN.1 Module</a>
      </h2>
<div class="breakable lang-asn.1 sourcecode" id="appendix-A-1">
<pre>
MerkleTreeCertificates
  { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-mtc-2025(TBD) }

DEFINITIONS IMPLICIT TAGS ::=
BEGIN

IMPORTS
  SIGNATURE-ALGORITHM
  FROM AlgorithmInformation-2009  -- in [RFC5912]
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-algorithmInformation-02(58) }
  ATTRIBUTE
  FROM PKIX-CommonTypes-2009 -- in [RFC5912]
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-pkixCommon-02(57) } ;
  TrustAnchorID
  FROM TrustAnchorIDs-2025 -- in [I-D.ietf-tls-trust-ancohor-ids]
    { iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-trustAnchorIDs-2025(TBD) }

TBSCertificateLogEntry  ::=  SEQUENCE  {
      version             [0]  EXPLICIT Version DEFAULT v1,
      issuer                   Name,
      validity                 Validity,
      subject                  Name,
      subjectPublicKeyInfoHash OCTET STRING,
      issuerUniqueID      [1]  IMPLICIT UniqueIdentifier OPTIONAL,
      subjectUniqueID     [2]  IMPLICIT UniqueIdentifier OPTIONAL,
      extensions          [3]  EXPLICIT Extensions OPTIONAL }

id-alg-mtcProof OBJECT IDENTIFIER ::= {
    iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) algorithms(6) TBD}

sa-mtcProof SIGNATURE-ALGORITHM ::= {
   IDENTIFIER id-alg-mtcProof
   PARAMS ARE absent
}

id-rdna-trustAnchorID OBJECT IDENTIFIER ::= {
    iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) rdna(25) TBD}

at-trustAnchorID ATTRIBUTE ::= {
   TYPE TrustAnchorID
   IDENTIFIED BY id-rdna-trustAnchorID
}

END
</pre><a href="#appendix-A-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="extensions-to-tiled-transparency-logs-to-be-removed">
<section id="appendix-B">
      <h2 id="name-extensions-to-tiled-transpa">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-extensions-to-tiled-transpa" class="section-name selfRef">Extensions to Tiled Transparency Logs (To Be Removed)</a>
      </h2>
<p id="appendix-B-1">[[TODO: This section is expected to be removed. It is sketched here purely for illustrative purposes, until the features are defined somewhere else, e.g. in the upstream tlog documents.]]<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="subtree-signed-note-format">
<section id="appendix-B.1">
        <h3 id="name-subtree-signed-note-format">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-subtree-signed-note-format" class="section-name selfRef">Subtree Signed Note Format</a>
        </h3>
<p id="appendix-B.1-1">A subtree, with signatures, can be represented as a signed note <span>[<a href="#SIGNED-NOTE" class="cite xref">SIGNED-NOTE</a>]</span>. Trust anchor IDs can be converted into log origins and cosigner names by concatenating the ASCII string <code>oid/1.3.6.1.4.1.</code> and the ASCII representation of the trust anchor ID. For example, the checkpoint origin for a log named <code>32473.1</code> would be <code>oid/1.3.6.1.4.1.32473.1</code>.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">The note body is a sequence of the following lines, each terminated by a newline character (U+000A):<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.1-3.1">
            <p id="appendix-B.1-3.1.1">The log origin<a href="#appendix-B.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-3.2">
            <p id="appendix-B.1-3.2.1">Two space-separated, non-negative decimal integers, <code>&lt;start&gt; &lt;end&gt;</code><a href="#appendix-B.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-3.3">
            <p id="appendix-B.1-3.3.1">The subtree hash, as single hash encoded in base64<a href="#appendix-B.1-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.1-4">Each note signature has a key name of the cosigner name. The signature's key ID is computed using the reserved signature type in <span>[<a href="#SIGNED-NOTE" class="cite xref">SIGNED-NOTE</a>]</span>, and a fixed string, as follows:<a href="#appendix-B.1-4" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-B.1-5">
<pre>
key ID = SHA-256(key name || 0x0A || 0xFF || "mtc-subtree/v1")[:4]
</pre><a href="#appendix-B.1-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-6">A subtree whose <code>start</code> is zero can also be represented as a checkpoint <span>[<a href="#TLOG-CHECKPOINT" class="cite xref">TLOG-CHECKPOINT</a>]</span>. A corresponding subtree signature can be represented as a note signature using a key ID computed as follows:<a href="#appendix-B.1-6" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="appendix-B.1-7">
<pre>
key ID = SHA-256(key name || 0x0A || 0xFF || "mtc-checkpoint/v1")[:4]
</pre><a href="#appendix-B.1-7" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-8">The only difference between the two forms is the implicit transformation from the signed note text to the MTCSubtree structure.<a href="#appendix-B.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="requesting-subtree-signatures">
<section id="appendix-B.2">
        <h3 id="name-requesting-subtree-signatur">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-requesting-subtree-signatur" class="section-name selfRef">Requesting Subtree Signatures</a>
        </h3>
<p id="appendix-B.2-1">This section defines the <code>sign-subtree</code> cosigner HTTP endpoint for clients to obtain subtree signatures from non-CA cosigners, such as mirrors and witnesses. It may be used by the CA when assembling a certificate, or by an authenticating party to add a cosignature to a certificate that the CA did not themselves obtain.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">The cosigner MAY expose this endpoint publicly to general authenticating parties, or privately to the CA. The latter is sufficient if the CA is known to automatically request cosignatures from this cosigner when constructing certificates. If private, authenticating the CA is out of scope for this document.<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<p id="appendix-B.2-3">Clients call this endpoint as <code>POST &lt;prefix&gt;/sign-subtree</code>, where <code>prefix</code> is some URL prefix. For a mirror or witness, the URL prefix is the submission prefix. The client's request body MUST be a sequence of:<a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-4.1">
            <p id="appendix-B.2-4.1.1">The requested subtree as a signed note (<a href="#subtree-signed-note-format" class="auto internal xref">Appendix B.1</a>), with zero or more signatures. The endpoint MAY require signatures from the CA as a DoS mitigation, as described below.<a href="#appendix-B.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-4.2">
            <p id="appendix-B.2-4.2.1">A blank line<a href="#appendix-B.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-4.3">
            <p id="appendix-B.2-4.3.1">A checkpoint, signed by the requested cosigner. The checkpoint's tree size must be at least <code>end</code>.<a href="#appendix-B.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-4.4">
            <p id="appendix-B.2-4.4.1">A blank line<a href="#appendix-B.2-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-4.5">
            <p id="appendix-B.2-4.5.1">Zero or more subtree consistency proof (<a href="#subtree-consistency-proofs" class="auto internal xref">Section 4.3</a>) lines. Each line MUST encode a single hash in base64 <span>[<a href="#RFC4648" class="cite xref">RFC4648</a>]</span>. The client MUST NOT send more than 63 consistency proof lines.<a href="#appendix-B.2-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.2-5">Each line MUST terminate in a newline character (U+000A).<a href="#appendix-B.2-5" class="pilcrow">¶</a></p>
<p id="appendix-B.2-6">The cosigner performs the following steps:<a href="#appendix-B.2-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-B.2-7">
<li id="appendix-B.2-7.1">
            <p id="appendix-B.2-7.1.1">Check that the checkpoint contains signatures from itself<a href="#appendix-B.2-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-B.2-7.2">
            <p id="appendix-B.2-7.2.1">Check that the subtree consistency proof proves consistency between the subtree hash and the checkpoint<a href="#appendix-B.2-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-B.2-7.3">
            <p id="appendix-B.2-7.3.1">If all checks pass, cosign the subtree, as described in <a href="#cosigners" class="auto internal xref">Section 5.4</a><a href="#appendix-B.2-7.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="appendix-B.2-8">On success, the response body MUST be a sequence of one or more note signature lines <span>[<a href="#SIGNED-NOTE" class="cite xref">SIGNED-NOTE</a>]</span>, each starting with an em dash character (U+2014) and ending with a newline character (U+000A). The signatures MUST be cosignatures from the cosigner key(s) on the subtree.<a href="#appendix-B.2-8" class="pilcrow">¶</a></p>
<p id="appendix-B.2-9">Instead of statelessly validating checkpoints by signature, the cosigner MAY statefully check the requested checkpoint against internal witness or mirror state. In this case, if the cosigner needs a newer checkpoint, it responds with a "409 Conflict" with its latest signed checkpoint. In this case, the subtree cosigning SHOULD remember and accept the last few signed checkpoints, to minimize conflicts.<a href="#appendix-B.2-9" class="pilcrow">¶</a></p>
<p id="appendix-B.2-10">If operating statefully, the subtree cosigner process only needs read access to the mirror or witness state and can freely operate on stale state without violating any invariants.<a href="#appendix-B.2-10" class="pilcrow">¶</a></p>
<p id="appendix-B.2-11">Mirrors MAY choose to check subtree hashes by querying their log state, instead of evaluating proofs.<a href="#appendix-B.2-11" class="pilcrow">¶</a></p>
<p id="appendix-B.2-12">Publicly-exposed subtree cosigning endpoints MAY mitigate DoS in a variety of techniques:<a href="#appendix-B.2-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-13.1">
            <p id="appendix-B.2-13.1.1">Only cosigning recent subtrees, as old subtrees do not need to be co-signed<a href="#appendix-B.2-13.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-13.2">
            <p id="appendix-B.2-13.2.1">Caching subtree signatures<a href="#appendix-B.2-13.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-13.3">
            <p id="appendix-B.2-13.3.1">Requiring a CA signature on the subtree; CAs are only expected to sign two subtrees (<a href="#arbitrary-intervals" class="auto internal xref">Section 4.4</a>) for each checkpoint<a href="#appendix-B.2-13.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-13.4">
            <p id="appendix-B.2-13.4.1">Rate-limiting requests<a href="#appendix-B.2-13.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-C">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-C-1">This document stands on the shoulders of giants and builds upon decades of work in TLS authentication, X.509, and Certificate Transparency. The authors would like to thank all those who have contributed over the history of these protocols.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">The authors additionally thank Bob Beck, Ryan Dickson, Aaron Gable, Nick Harper, Dennis Jackson, Matt Mueller, Chris Patton, Ryan Sleevi, and Emily Stark for many valuable discussions and insights which led to this document. We wish to thank Mia Celeste in particular, whose implementation of an earlier draft revealed several pitfalls.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">The idea to mint tree heads infrequently was originally described by Richard Barnes in <span>[<a href="#STH-Discipline" class="cite xref">STH-Discipline</a>]</span>. The size optimization in Merkle Tree Certificates is an application of this idea to the certificate itself.<a href="#appendix-C-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="change-log">
<section id="appendix-D">
      <h2 id="name-change-log">
<a href="#name-change-log" class="section-name selfRef">Change log</a>
      </h2>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-D-1.1">
          <p id="appendix-D-1.1.1"><strong>RFC Editor's Note:</strong> Please remove this section prior to publication of a
final version of this document.<a href="#appendix-D-1.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="since-draft-davidben-tls-merkle-tree-certs-00">
<section id="appendix-D.1">
        <h3 id="name-since-draft-davidben-tls-me">
<a href="#name-since-draft-davidben-tls-me" class="section-name selfRef">Since draft-davidben-tls-merkle-tree-certs-00</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.1-1.1">
            <p id="appendix-D.1-1.1.1">Simplify hashing by removing the internal padding to align with block size. #72<a href="#appendix-D.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.2">
            <p id="appendix-D.1-1.2.1">Avoid the temptation of floating points. #66<a href="#appendix-D.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.3">
            <p id="appendix-D.1-1.3.1">Require <code>lifetime</code> to be a multiple of <code>batch_duration</code>. #65<a href="#appendix-D.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.4">
            <p id="appendix-D.1-1.4.1">Rename window to validity window. #21<a href="#appendix-D.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.5">
            <p id="appendix-D.1-1.5.1">Split Assertion into Assertion and AbridgedAssertion. The latter is used in the Merkle Tree and HTTP interface. It replaces <code>subject_info</code> by a hash, to save space by not serving large post-quantum public keys. The original Assertion is used everywhere else, including BikeshedCertificate. #6<a href="#appendix-D.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.6">
            <p id="appendix-D.1-1.6.1">Add proper context to every node in the Merkle tree. #32<a href="#appendix-D.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.7">
            <p id="appendix-D.1-1.7.1">Clarify we use a single <code>CertificateEntry</code>. #11<a href="#appendix-D.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.8">
            <p id="appendix-D.1-1.8.1">Clarify we use POSIX time. #1<a href="#appendix-D.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.9">
            <p id="appendix-D.1-1.9.1">Elaborate on CA public key and signature format. #27<a href="#appendix-D.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.1-1.10">
            <p id="appendix-D.1-1.10.1">Miscellaneous changes.<a href="#appendix-D.1-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-davidben-tls-merkle-tree-certs-01">
<section id="appendix-D.2">
        <h3 id="name-since-draft-davidben-tls-mer">
<a href="#name-since-draft-davidben-tls-mer" class="section-name selfRef">Since draft-davidben-tls-merkle-tree-certs-01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.2-1.1">
            <p id="appendix-D.2-1.1.1">Minor editorial changes<a href="#appendix-D.2-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-davidben-tls-merkle-tree-certs-02">
<section id="appendix-D.3">
        <h3 id="name-since-draft-davidben-tls-merk">
<a href="#name-since-draft-davidben-tls-merk" class="section-name selfRef">Since draft-davidben-tls-merkle-tree-certs-02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.3-1.1">
            <p id="appendix-D.3-1.1.1">Replace the negotiation mechanism with TLS Trust Anchor Identifiers.<a href="#appendix-D.3-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-davidben-tls-merkle-tree-certs-03">
<section id="appendix-D.4">
        <h3 id="name-since-draft-davidben-tls-merkl">
<a href="#name-since-draft-davidben-tls-merkl" class="section-name selfRef">Since draft-davidben-tls-merkle-tree-certs-03</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.4-1.1">
            <p id="appendix-D.4-1.1.1">Switch terminology from "subscriber" to "authenticating party".<a href="#appendix-D.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.2">
            <p id="appendix-D.4-1.2.1">Use &lt;1..2^24-1&gt; encoding for all certificate types in the CertificateEntry TLS message<a href="#appendix-D.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.3">
            <p id="appendix-D.4-1.3.1">Clarify discussion and roles in transparency ecosystem<a href="#appendix-D.4-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.4-1.4">
            <p id="appendix-D.4-1.4.1">Update references<a href="#appendix-D.4-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-davidben-tls-merkle-tree-certs-04">
<section id="appendix-D.5">
        <h3 id="name-since-draft-davidben-tls-merkle">
<a href="#name-since-draft-davidben-tls-merkle" class="section-name selfRef">Since draft-davidben-tls-merkle-tree-certs-04</a>
        </h3>
<p id="appendix-D.5-1">Substantially reworked the design. The old design was essentially the landmark checkpoint and CA-built logs ideas, but targeting only the optimized and slow issuance path, and with a more bespoke tree structure:<a href="#appendix-D.5-1" class="pilcrow">¶</a></p>
<p id="appendix-D.5-2">In both draft-04 and draft-05, a CA looks like today’s CAs except that they run some software to publish what they issue and sign tree heads to certify certificates in bulk.<a href="#appendix-D.5-2" class="pilcrow">¶</a></p>
<p id="appendix-D.5-3">In draft-04, the CA software publishes certificates in a bunch of independent Merkle trees. This is very easy to do as a collection of highly cacheable, immutable static files because each tree is constructed independently, and never appended to after being built. In draft-05, the certificates are published in a single Merkle tree. The <span>[<a href="#TLOG-TILES" class="cite xref">TLOG-TILES</a>]</span> interface allows such trees to also use highly cacheable, immutable static files.<a href="#appendix-D.5-3" class="pilcrow">¶</a></p>
<p id="appendix-D.5-4">In draft-04, there only are hourly tree heads. Clients are provisioned with tree heads ahead of time so we can make small, inclusion-proof-only certificates. In draft-05, the ecosystem must coordinate on defining "landmark" checkpoints. Clients are provisioned with subtrees describing landmark checkpoints ahead of time so we can make small, inclusion-proof-only certificates.<a href="#appendix-D.5-4" class="pilcrow">¶</a></p>
<p id="appendix-D.5-5">In draft-04, each tree head is independent. In draft-05, each landmark checkpoint contains all the previous checkpoints.<a href="#appendix-D.5-5" class="pilcrow">¶</a></p>
<p id="appendix-D.5-6">In draft-04, the independent tree heads were easily prunable. In draft-05, we define how to prune a Merkle tree.<a href="#appendix-D.5-6" class="pilcrow">¶</a></p>
<p id="appendix-D.5-7">In draft-04, there is no fast issuance mode. In draft-05, frequent, non-landmark checkpoints can be combined with inclusion proofs and witness signatures for fast issuance. This is essentially an STH and inclusion proof in CT.<a href="#appendix-D.5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="since-draft-davidben-tls-merkle-tree-certs-05">
<section id="appendix-D.6">
        <h3 id="name-since-draft-davidben-tls-merkle-">
<a href="#name-since-draft-davidben-tls-merkle-" class="section-name selfRef">Since draft-davidben-tls-merkle-tree-certs-05</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.6-1.1">
            <p id="appendix-D.6-1.1.1">Add some discussion on malleability<a href="#appendix-D.6-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.2">
            <p id="appendix-D.6-1.2.1">Discuss the monitoring impacts of the responsibility shift from CA with log quorum to CA+log with mirror quorum<a href="#appendix-D.6-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.6-1.3">
            <p id="appendix-D.6-1.3.1">Sketch out a more concrete initial ACME extension<a href="#appendix-D.6-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-davidben-tls-merkle-tree-certs-06">
<section id="appendix-D.7">
        <h3 id="name-since-draft-davidben-tls-merkle-t">
<a href="#name-since-draft-davidben-tls-merkle-t" class="section-name selfRef">Since draft-davidben-tls-merkle-tree-certs-06</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.7-1.1">
            <p id="appendix-D.7-1.1.1">Fix mistyped reference<a href="#appendix-D.7-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.2">
            <p id="appendix-D.7-1.2.1">Removed now unnecessary placeholder text<a href="#appendix-D.7-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.3">
            <p id="appendix-D.7-1.3.1">First draft at IANA registration and ASN.1 module<a href="#appendix-D.7-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.4">
            <p id="appendix-D.7-1.4.1">Added a prose version of the procedure to select subtrees<a href="#appendix-D.7-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.5">
            <p id="appendix-D.7-1.5.1">Rename 'landmarks checkpoint' to 'landmarks'<a href="#appendix-D.7-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.6">
            <p id="appendix-D.7-1.6.1">Clarify and fix an off-by-one error in recommended landmark allocation scheme<a href="#appendix-D.7-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-1.7">
            <p id="appendix-D.7-1.7.1">Add some diagrams to the Overview section<a href="#appendix-D.7-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-davidben-tls-merkle-tree-certs-07">
<section id="appendix-D.8">
        <h3 id="name-since-draft-davidben-tls-merkle-tr">
<a href="#name-since-draft-davidben-tls-merkle-tr" class="section-name selfRef">Since draft-davidben-tls-merkle-tree-certs-07</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-D.8-1.1">
            <p id="appendix-D.8-1.1.1">Clarify landmark zero<a href="#appendix-D.8-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.8-1.2">
            <p id="appendix-D.8-1.2.1">Clarify signature verification process<a href="#appendix-D.8-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Benjamin</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:davidben@google.com" class="email">davidben@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Devon O'Brien</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:devon.obrien@gmail.com" class="email">devon.obrien@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Bas Westerbaan</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:bas@cloudflare.com" class="email">bas@cloudflare.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Luke Valenta</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:lvalenta@cloudflare.com" class="email">lvalenta@cloudflare.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Filippo Valsorda</span></div>
<div dir="auto" class="left"><span class="org">Geomys</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@filippo.io" class="email">ietf@filippo.io</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
